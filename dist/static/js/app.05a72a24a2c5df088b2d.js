webpackJsonp([1],{"+LGA":function(e,t){},"1vLB":function(e,t){},"26mL":function(e,t){},"2yY2":function(e,t){},"3U/A":function(e,t){},"43FW":function(e,t){throw new Error("Module parse failed: Unexpected character '�' (1:0)\nYou may need an appropriate loader to handle this file type.\n(Source code omitted for this binary file)")},"4Ogv":function(e,t){},"4Uwr":function(e,t,a){e.exports=a.p+"static/img/logo.2400e5c.jpg"},"4pru":function(e,t){},"4q6C":function(e,t){},"4utg":function(e,t,a){e.exports=a.p+"static/img/13.390ccf4.png"},"5neq":function(e,t){},"8IKi":function(e,t){},"9QGR":function(e,t,a){e.exports=a.p+"static/img/21.ed2aaa3.png"},"9RPW":function(e,t){},A1tS:function(e,t,a){e.exports=a.p+"static/img/1.c595a12.png"},BS75:function(e,t){},CrTx:function(e,t){},DT1y:function(e,t){},E0Mh:function(e,t){},GEJk:function(e,t){},GJv3:function(e,t){},GR5o:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("7+uW"),o={name:"App",data:()=>({includedComponents:[]})},i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("keep-alive",{attrs:{include:this.includedComponents,include:""}},[t("router-view")],1)],1)},staticRenderFns:[]};var l=a("VU/8")(o,i,!1,function(e){a("auiY")},null,null).exports,n=a("/ocq"),r={name:"login",data:()=>({loginForm:{username:"",password:""}}),methods:{login(){""===this.loginForm.username||""===this.loginForm.password?alert("Username or password cannot be blank! "):this.$axios({method:"post",url:"/user/login",data:{login_name:this.loginForm.username,password:this.loginForm.password},headers:{"Content-Type":"application/json"}}).then(e=>{this.$store.commit("saveUserInfo",e.data.info),this.$store.commit("saveToken",e.headers.token),this.$notify({title:"Success",message:"Welcome! ",type:"success"}),this.$router.push("/deepLearning")}).catch(e=>{console.log(e),this.$notify.error({title:"Error",message:"Username or password is incorrect. "})})},signUp(){this.$router.push("/signUp")},clearForm(){this.$refs.loginForm.resetFields()}},beforeRouteEnter(e,t,a){a(e=>{e.clearForm()})}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"log-in"}},[a("div",{attrs:{id:"log-in-div"}},[a("el-form",{ref:"loginForm",attrs:{model:e.loginForm}},[a("p",{attrs:{id:"form-head"}},[e._v("Welcome")]),e._v(" "),a("el-form-item",{attrs:{prop:"username"}},[a("el-input",{attrs:{name:"username",placeholder:"Username","auto-complete":"on"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{name:"password",placeholder:"Password","auto-complete":"on","show-password":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v("Log in")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.signUp}},[e._v("Sign up")])],1)],1)],1)])},staticRenderFns:[]};var c=a("VU/8")(r,d,!1,function(e){a("3U/A")},"data-v-e516429a",null).exports,p={name:"signUp",data:()=>({signUpForm:{loginName:"",password:"",name:"",gender:"",age:0,nation:"",identityID:"",birthday:"",marriage:"",phone:"",email:"",birthplace:"",workplace:"",type:1,state:0},rules:{loginName:[{required:!0,message:"Please input login name",trigger:"blur"},{min:1,max:10,message:"Login name length is between 1 and 10",trigger:"blur"}],password:[{required:!0,message:"Please input password",trigger:"blur"}],name:[{required:!0,message:"Please input your name",trigger:"blur"}],gender:[{required:!0,message:"Please input your name",trigger:"blur"}],age:[{required:!0,message:"Please input your name",trigger:"blur"}],nation:[{required:!0,message:"Please input your name",trigger:"blur"}],identityID:[{required:!0,message:"Please input your name",trigger:"blur"}],birthday:[{required:!0,message:"Please input your name",trigger:"blur"}],marriage:[{required:!0,message:"Please input your name",trigger:"blur"}],phone:[{required:!0,message:"Please input your name",trigger:"blur"}],email:[{required:!0,message:"Please input your name",trigger:"blur"}],birthplace:[{required:!0,message:"Please input your name",trigger:"blur"}],workplace:[{required:!0,message:"Please input your name",trigger:"blur"}]}}),methods:{signUp(){this.$axios({method:"put",url:"/user/register",data:{login_name:this.signUpForm.loginName,password:this.signUpForm.password,username:this.signUpForm.name,gender:this.signUpForm.gender,age:this.signUpForm.age,nation:this.signUpForm.nation,identityId:this.signUpForm.identityID,birthday:this.signUpForm.birthday,marriage:this.signUpForm.marriage,phone:this.signUpForm.phone,email:this.signUpForm.email,birth_place:this.signUpForm.birthplace,work_place:this.signUpForm.workplace,type:this.signUpForm.type,state:this.signUpForm.state}}).then(e=>{console.log(e.data),alert("Sign up successfully! Now go to LOG IN! "),this.$router.push("/login")}).catch(e=>{console.log(e),alert("Sign up ERROR! ")})},logIn(){this.$router.push("/login")}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"sign-up"}},[a("div",{attrs:{id:"sign-up-div"}},[a("el-form",{attrs:{model:e.signUpForm,rules:e.rules,"label-position":"left","label-width":"100px"}},[a("p",{attrs:{id:"form-head"}},[e._v("Sign Up")]),e._v(" "),a("el-form-item",{attrs:{label:"Login Name",prop:"loginName"}},[a("el-input",{attrs:{name:"loginName","auto-complete":"on"},model:{value:e.signUpForm.loginName,callback:function(t){e.$set(e.signUpForm,"loginName",t)},expression:"signUpForm.loginName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Password",prop:"password"}},[a("el-input",{attrs:{name:"password"},model:{value:e.signUpForm.password,callback:function(t){e.$set(e.signUpForm,"password",t)},expression:"signUpForm.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Name",prop:"name"}},[a("el-input",{attrs:{name:"name","auto-complete":"on"},model:{value:e.signUpForm.name,callback:function(t){e.$set(e.signUpForm,"name",t)},expression:"signUpForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Gender",prop:"gender"}},[a("el-input",{attrs:{name:"gender","auto-complete":"on"},model:{value:e.signUpForm.gender,callback:function(t){e.$set(e.signUpForm,"gender",t)},expression:"signUpForm.gender"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Age",prop:"age"}},[a("el-input",{attrs:{name:"age","auto-complete":"on"},model:{value:e.signUpForm.age,callback:function(t){e.$set(e.signUpForm,"age",t)},expression:"signUpForm.age"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Nation",prop:"nation"}},[a("el-input",{attrs:{name:"nation","auto-complete":"on"},model:{value:e.signUpForm.nation,callback:function(t){e.$set(e.signUpForm,"nation",t)},expression:"signUpForm.nation"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"IdentityID",prop:"identityID"}},[a("el-input",{attrs:{name:"identityID","auto-complete":"on"},model:{value:e.signUpForm.identityID,callback:function(t){e.$set(e.signUpForm,"identityID",t)},expression:"signUpForm.identityID"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Birthday",prop:"birthday"}},[a("el-input",{attrs:{name:"birthday","auto-complete":"on"},model:{value:e.signUpForm.birthday,callback:function(t){e.$set(e.signUpForm,"birthday",t)},expression:"signUpForm.birthday"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Marriage",prop:"marriage"}},[a("el-input",{attrs:{name:"marriage","auto-complete":"on"},model:{value:e.signUpForm.marriage,callback:function(t){e.$set(e.signUpForm,"marriage",t)},expression:"signUpForm.marriage"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Phone",prop:"phone"}},[a("el-input",{attrs:{name:"phone","auto-complete":"on"},model:{value:e.signUpForm.phone,callback:function(t){e.$set(e.signUpForm,"phone",t)},expression:"signUpForm.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Email",prop:"email"}},[a("el-input",{attrs:{name:"email","auto-complete":"on"},model:{value:e.signUpForm.email,callback:function(t){e.$set(e.signUpForm,"email",t)},expression:"signUpForm.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Birthplace",prop:"birthplace"}},[a("el-input",{attrs:{name:"birthplace","auto-complete":"on"},model:{value:e.signUpForm.birthplace,callback:function(t){e.$set(e.signUpForm,"birthplace",t)},expression:"signUpForm.birthplace"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Workplace",prop:"workplace"}},[a("el-input",{attrs:{name:"workplace","auto-complete":"on"},model:{value:e.signUpForm.workplace,callback:function(t){e.$set(e.signUpForm,"workplace",t)},expression:"signUpForm.workplace"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.signUp}},[e._v("Sign up")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.logIn}},[e._v("Log in")])],1)],1)],1)])},staticRenderFns:[]};var m=a("VU/8")(p,u,!1,function(e){a("Yp2s")},"data-v-5e4c7818",null).exports,h={name:"NavigationBar",data:()=>({headerList:[{id:"1",path:"/vqa",title:"VQA    "},{id:"2",path:"/deepLearning",title:"Deep Learning"},{id:"3",path:"/medicalArchivePreprocess",title:"Medical Archive Preprocess"},{id:"4",path:"/knowledgeGraph",title:"Knowledge Graph"},{id:"5",path:"/medicalCaseDeepSearch",title:"Medical Case Deep Search"},{id:"6",path:"/autoDiagnosis",title:"Automatic Diagnosis"},{id:"7",path:"/QA",title:"Q&A"},{id:"8",path:"/consult",title:"Consult"},{id:"10",path:"/my",title:"My"}],isShow:!1}),methods:{goToMainPage(){this.$router.push("/deepLearning")},logOut(){this.$confirm("Log Out? ","Notification",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(()=>{window.location.reload(),this.$store.commit("clearUserInfo"),this.$router.push("/"),this.$notify({title:"Success",message:"Log out successfully! ",type:"success"})}).catch(()=>{})}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-header",{attrs:{height:"80px"}},[a("div",[a("div",{staticClass:"nav-center"},[a("ul",e._l(e.headerList,function(t){return a("li",{key:t.id},[a("router-link",{attrs:{to:{path:t.path},onmouseover:"this.style.color = '#409EFF'",onmouseout:"this.style.color = 'rgb(140, 197, 255)'"}},[e._v("\n            "+e._s(t.title)+"\n          ")])],1)}),0)]),e._v(" "),a("div",{staticClass:"nav-right"},[a("span",[e._v(e._s("Hi, "+this.$store.state.user.username))]),e._v(" | "),a("el-button",{attrs:{type:"text"},on:{click:e.logOut}},[e._v("Log Out")])],1)])])},staticRenderFns:[]};var v=a("VU/8")(h,g,!1,function(e){a("DT1y")},"data-v-3f27429f",null).exports,f={name:"DeepLearningMenu",data:()=>({category:[]}),methods:{},created(){}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-aside",{staticClass:"scrollable-div",attrs:{width:"240px"}},[a("el-scrollbar",{ref:"deepLearningMenuScrollBar"},[a("el-menu",{attrs:{router:"","default-active":this.$route.path,"default-openeds":["2"]},on:{select:function(e){},open:function(e){},close:function(e){}}},[a("el-menu-item",{attrs:{index:"/deepLearning/deepModels"}},[e._v("Deep Models")]),e._v(" "),a("el-submenu",{attrs:{index:"2"}},[a("template",{slot:"title"},[e._v("Data Preparation")]),e._v(" "),a("el-menu-item-group",[a("el-menu-item",{attrs:{index:"/deepLearning/uploadDataset"}},[e._v("Dataset")]),e._v(" "),a("el-menu-item",{attrs:{index:"/deepLearning/uploadKnowledgeGraph"}},[e._v("Knowledge Graph")])],1)],2),e._v(" "),a("el-menu-item",{attrs:{index:"/deepLearning/modelEvaluation"}},[e._v("Model Evaluation")]),e._v(" "),a("el-menu-item",{attrs:{index:"/deepLearning/autoSelection"}},[e._v("Auto Selection")]),e._v(" "),a("el-menu-item",{attrs:{index:"/deepLearning/knowledgeExploration"}},[e._v("Knowledge Exploration")])],1)],1)],1)},staticRenderFns:[]};var y={name:"deepLearning",components:{NavigationBar:v,DeepLearningMenu:a("VU/8")(f,b,!1,function(e){a("vQDT")},"data-v-62b7879e",null).exports}},k={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-container",[t("NavigationBar"),this._v(" "),t("el-container",{staticClass:"parent-div"},[t("DeepLearningMenu"),this._v(" "),t("keep-alive",[this.$route.meta.keepAlive?t("router-view"):this._e()],1),this._v(" "),this.$route.meta.keepAlive?this._e():t("router-view")],1)],1)],1)},staticRenderFns:[]};var _=a("VU/8")(y,k,!1,function(e){a("9RPW")},"data-v-645ca784",null).exports,w=a("mtWM"),x=a.n(w),F={name:"DeepModels",data:()=>({deepModelsOptions:[],selectedDeepModel:[],modelInfoFormVisible:!1,modelInfoForm:{modelName:"",articleTitle:"",articleUrl:"",introduction:"",imgUrl:"",codeUrl:""}}),methods:{loadDeepModels(){this.$axios({method:"get",url:"/modelCategory"}).then(e=>{for(let t in e.data)if(e.data.hasOwnProperty(t)){let a=[],s=e.data[t].models;for(let e in s)s.hasOwnProperty(e)&&a.push({value:s[e].id,label:s[e].name});this.deepModelsOptions.push({value:e.data[t].id,label:e.data[t].name,children:a})}}).catch(e=>{console.log(e)})},selectModel(e){this.getModelInfo(e[e.length-1]),this.modelInfoFormVisible=!0},getModelInfo(e){this.$axios({method:"get",url:"/modelCategory/model/"+e}).then(e=>{this.modelInfoForm.modelName=e.data.name,this.modelInfoForm.articleTitle=e.data.articleTitle,""!==this.modelInfoForm.articleTitle&&null!==this.modelInfoForm.articleTitle||(this.modelInfoForm.articleTitle=""),this.modelInfoForm.introduction=e.data.intro,""!==this.modelInfoForm.introduction&&null!==this.modelInfoForm.introduction||(this.modelInfoForm.introduction="");let t=e.data.architectureUrl;this.modelInfoForm.imgUrl=""===t||null===t?"":"/api/model-img/deep-model-img/"+t,this.modelInfoForm.codeUrl=e.data.codeUrl,""!==this.modelInfoForm.codeUrl&&null!==this.modelInfoForm.codeUrl||(this.modelInfoForm.codeUrl=""),this.modelInfoForm.articleUrl=e.data.articleUrl,""!==this.modelInfoForm.articleUrl&&null!==this.modelInfoForm.articleUrl||(this.modelInfoForm.articleUrl="")}).catch(e=>{console.log(e)})},downloadArticle(){if(""!==this.modelInfoForm.articleUrl&&null!==this.modelInfoForm.articleUrl){let e=document.createElement("a");e.href="/api/model-article/deep-model-article/"+this.modelInfoForm.articleUrl;let t=this.modelInfoForm.articleUrl,a=t.substring(t.lastIndexOf("."),t.length);e.download=this.modelInfoForm.modelName+a,e.click()}else this.$notify.info({title:"Notification",message:"No Article. "})},downloadCode(){if(""!==this.modelInfoForm.codeUrl&&null!==this.modelInfoForm.codeUrl){let e=document.createElement("a");e.href="/api/model-code/deep-model-code/"+this.modelInfoForm.codeUrl;let t=this.modelInfoForm.codeUrl,a=t.substring(t.lastIndexOf("."),t.length);e.download=this.modelInfoForm.modelName+a,e.click()}else this.$notify.info({title:"Notification",message:"No Code. "})}},mounted(){let e=[],t=[];this.$axios({method:"get",url:"/modelCategory/modelName"}).then(a=>{for(let t in a.data)a.data.hasOwnProperty(t)&&(e[a.data[t].id]=a.data[t].name);this.$axios({method:"get",url:"/modelMetric"}).then(a=>{for(let e in a.data)a.data.hasOwnProperty(e)&&(t[a.data[e].id]=a.data[e].metricName);this.$store.dispatch("saveSysData",{models:e,metrics:t})}).catch(e=>{console.log(e)})}).catch(e=>{console.log(e)})},created(){this.loadDeepModels()}},C={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"top-bar"},[a("div",{staticClass:"option-bar"},[a("div",{staticClass:"selector-bar"},[a("span",[e._v("Deep Model: ")]),e._v(" "),a("el-cascader",{ref:"selectedDeepModelOptions",attrs:{options:e.deepModelsOptions,props:{expandTrigger:"hover"},placeholder:"Select a model"},on:{change:e.selectModel},model:{value:e.selectedDeepModel,callback:function(t){e.selectedDeepModel=t},expression:"selectedDeepModel"}})],1)])]),e._v(" "),a("div",{staticClass:"content-div scrollable-div"},[a("el-scrollbar",[a("div",{staticClass:"content-parent"},[a("div",{staticClass:"content"},[a("el-card",{},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[a("b",[e._v("Model:")]),e._v(" "+e._s(e.modelInfoForm.modelName))])]),e._v(" "),a("div",[e.modelInfoFormVisible?a("div",[a("el-form",{attrs:{model:e.modelInfoForm,"label-position":"left","label-width":"110px"}},[""!==e.modelInfoForm.articleTitle?a("el-form-item",{attrs:{label:"Article",prop:"articleTitle"}},[a("span",[e._v(e._s(e.modelInfoForm.articleTitle))]),e._v("  \n                    "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.downloadArticle}},[e._v("Download")])],1):e._e(),e._v(" "),""!==e.modelInfoForm.introduction?a("el-form-item",{attrs:{label:"Introduction",prop:"introduction"}},[a("span",[e._v(e._s(e.modelInfoForm.introduction))])]):e._e(),e._v(" "),""!==e.modelInfoForm.imgUrl?a("el-form-item",{attrs:{label:"Architecture",prop:"architecture"}},[a("el-image",{staticStyle:{width:"90%"},attrs:{src:e.modelInfoForm.imgUrl,fit:"scale-down"}},[a("div",{attrs:{slot:"placeholder"},slot:"placeholder"},[e._v("Loading... ")])])],1):e._e(),e._v(" "),""!==e.modelInfoForm.codeUrl?a("el-form-item",{attrs:{label:"Code",prop:"code"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.downloadCode}},[e._v("Download")])],1):e._e()],1)],1):a("div",[a("span",[e._v("Select a model. ")])])])])],1)])])],1)])},staticRenderFns:[]};var D=a("VU/8")(F,C,!1,function(e){a("8IKi")},"data-v-e1095c52",null).exports,T={name:"UploadDataset",data:()=>({datasetTableHeight:200,datasetTableData:[],datasetTableEmptyText:"Loading...",stepsActive:0,addDatasetFormVisible:!1,addDatasetForm:{name:"",desc:""},rules:{name:[{required:!0,message:"Please input name",trigger:"blur"}],desc:[{required:!0,message:"Please input description",trigger:"blur"}]},uploadDatasetFormVisible:!1,uploadDatasetForm:{datasetId:0,type:""},trainSetExist:!1,testSetExist:!1,devSetExist:!1,trainSetFileList:[],testSetFileList:[],devSetFileList:[]}),methods:{loadDataset(){this.$axios({method:"get",url:"/doctor/"+this.$store.state.user.id+"/dataSets"}).then(e=>{this.datasetTableData.length=0;for(let t in e.data)if(e.data.hasOwnProperty(t)){let a=!0,s="",o="",i="";""===e.data[t].train_name||null===e.data[t].train_name?(s="",a=!1):s=e.data[t].train_name,""===e.data[t].test_name||null===e.data[t].test_name?(o="",a=!1):o=e.data[t].test_name,""===e.data[t].dev_name||null===e.data[t].dev_name?(i="",a=!1):i=e.data[t].dev_name,this.datasetTableData.push({id:e.data[t].id,name:e.data[t].dataset_name,desc:e.data[t].dataset_desc,status:a,trainSetName:s,testSetName:o,devSetName:i})}0===this.datasetTableData.length&&(this.datasetTableEmptyText="No Dataset")}).catch(e=>{console.log(e)})},newDatasetDialog(){this.stepsActive=0,this.addDatasetFormVisible=!0},addDataset(){this.$axios({method:"post",url:"/doctor/"+this.$store.state.user.id+"/dataSet",data:{dataset_name:this.addDatasetForm.name,dataset_desc:this.addDatasetForm.desc}}).then(e=>{this.closeAddDatasetForm(),this.loadDataset(),this.$notify({title:"Success",message:"Successfully create dataset! ",type:"success"}),this.openUploadDatasetForm(e.data,"","","")}).catch(e=>{console.log(e)})},cancelAddDataset(){this.closeAddDatasetForm()},closeAddDatasetForm(){this.addDatasetFormVisible=!1,this.$refs.addDatasetForm.resetFields()},submitUploadTrainSetFile(){this.uploadDatasetForm.type="train",this.$refs.uploadTrainSet.submit()},submitUploadTestSetFile(){this.uploadDatasetForm.type="test",this.$refs.uploadTestSet.submit()},submitUploadDevSetFile(){this.uploadDatasetForm.type="dev",this.$refs.uploadDevSet.submit()},uploadDatasetFile(e){let t=new FormData;t.append("dId",this.uploadDatasetForm.datasetId),t.append("type",this.uploadDatasetForm.type),t.append("file",e.file),this.$axios({method:"post",url:"/doctor/"+this.$store.state.user.id+"/dataSets",data:t}).then(e=>{this.$notify({title:"Success",message:"Successfully upload file! ",type:"success"})}).catch(e=>{console.log(e),this.$notify.error({title:"Error",message:"Wrong file format! "})})},cancelUploadDataset(){this.closeUploadDatasetForm(),this.loadDataset()},openUploadDatasetForm(e,t,a,s){this.stepsActive=1,this.uploadDatasetForm.datasetId=e,this.trainSetExist=""!==t,this.testSetExist=""!==a,this.devSetExist=""!==s,this.uploadDatasetFormVisible=!0},closeUploadDatasetForm(){this.uploadDatasetFormVisible=!1,this.$refs.uploadDatasetForm.resetFields(),this.trainSetFileList=[],this.testSetFileList=[],this.devSetFileList=[]},showMsg(e){e?this.$notify({title:"Success",message:"Dataset is available! Begin a TASK or RESET dataset! ",type:"success"}):this.$notify.warning({title:"Warning",message:"Dataset is not available! Please UPLOAD first! "})},goToModelEvaluation(e){this.$router.push("/deepLearning/modelEvaluation")},goToAutoSelection(e){this.$router.push("/deepLearning/autoSelection")}},created(){this.loadDataset()},mounted(){this.$nextTick(function(){this.datasetTableHeight=window.innerHeight-this.$refs.datasetTable.$el.offsetTop-190;let e=this;window.onresize=function(){e.datasetTableHeight=window.innerHeight-e.$refs.datasetTable.$el.offsetTop-190}})}},S={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"top-bar"},[a("div",{staticClass:"option-bar"},[a("div",{staticClass:"header-bar"},[a("span",[e._v("My Dataset")])]),e._v(" "),a("div",{staticClass:"operation-btn-bar"},[a("el-button",{attrs:{type:"primary"},on:{click:e.newDatasetDialog}},[e._v("Add Dataset")])],1)])]),e._v(" "),a("el-dialog",{attrs:{title:"Add Dataset",visible:e.addDatasetFormVisible,width:"640px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.addDatasetFormVisible=t}}},[a("el-steps",{attrs:{active:e.stepsActive,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"Step 1",description:"Create dataset"}}),e._v(" "),a("el-step",{attrs:{title:"Step 2",description:"Upload files"}})],1),e._v(" "),a("el-form",{ref:"addDatasetForm",attrs:{model:e.addDatasetForm,rules:e.rules,"label-position":"left","label-width":"130px"}},[a("el-form-item",{attrs:{label:"Name",prop:"name"}},[a("el-input",{model:{value:e.addDatasetForm.name,callback:function(t){e.$set(e.addDatasetForm,"name",t)},expression:"addDatasetForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Description",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.addDatasetForm.desc,callback:function(t){e.$set(e.addDatasetForm,"desc",t)},expression:"addDatasetForm.desc"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addDataset}},[e._v("Submit")]),e._v(" "),a("el-button",{on:{click:e.cancelAddDataset}},[e._v("Cancel")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"Upload Dataset",visible:e.uploadDatasetFormVisible,width:"640px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.uploadDatasetFormVisible=t}}},[a("el-steps",{attrs:{active:e.stepsActive,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"Step 1",description:"Create dataset"}}),e._v(" "),a("el-step",{attrs:{title:"Step 2",description:"Upload files"}})],1),e._v(" "),a("el-form",{ref:"uploadDatasetForm",attrs:{model:e.uploadDatasetForm,"label-position":"left","label-width":"70px"}},[e.trainSetExist?e._e():a("el-form-item",{attrs:{label:"TrainSet",prop:"trainSet"}},[a("el-upload",{ref:"uploadTrainSet",attrs:{action:"",multiple:!1,"file-list":e.trainSetFileList,"show-file-list":!0,"http-request":e.uploadDatasetFile,"auto-upload":!1}},[a("el-button",{staticClass:"browse-btn",attrs:{slot:"trigger",type:"primary",size:"mini"},slot:"trigger"},[e._v("Browse")]),e._v(" "),a("el-button",{staticClass:"browse-btn",attrs:{type:"success",size:"mini"},on:{click:e.submitUploadTrainSetFile}},[e._v("Upload")])],1)],1),e._v(" "),e.testSetExist?e._e():a("el-form-item",{attrs:{label:"TestSet",prop:"trainSet"}},[a("el-upload",{ref:"uploadTestSet",attrs:{action:"",multiple:!1,"file-list":e.testSetFileList,"show-file-list":!0,"http-request":e.uploadDatasetFile,"auto-upload":!1}},[a("el-button",{staticClass:"browse-btn",attrs:{slot:"trigger",type:"primary",size:"mini"},slot:"trigger"},[e._v("Browse")]),e._v(" "),a("el-button",{staticClass:"browse-btn",attrs:{type:"success",size:"mini"},on:{click:e.submitUploadTestSetFile}},[e._v("Upload")])],1)],1),e._v(" "),e.devSetExist?e._e():a("el-form-item",{attrs:{label:"DevSet",prop:"trainSet"}},[a("el-upload",{ref:"uploadDevSet",attrs:{action:"",multiple:!1,"file-list":e.devSetFileList,"show-file-list":!0,"http-request":e.uploadDatasetFile,"auto-upload":!1}},[a("el-button",{staticClass:"browse-btn",attrs:{slot:"trigger",type:"primary",size:"mini"},slot:"trigger"},[e._v("Browse")]),e._v(" "),a("el-button",{staticClass:"browse-btn",attrs:{type:"success",size:"mini"},on:{click:e.submitUploadDevSetFile}},[e._v("Upload")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelUploadDataset}},[e._v("Finish")])],1)],1),e._v(" "),a("div",{staticClass:"content-div scrollable-div"},[a("el-scrollbar",[a("div",{staticClass:"content-parent"},[a("div",{staticClass:"content"},[a("div",{staticClass:"item-list"},[a("el-table",{ref:"datasetTable",attrs:{data:e.datasetTableData,"max-height":e.datasetTableHeight}},[a("template",{slot:"empty"},[a("span",[e._v(e._s(e.datasetTableEmptyText))])]),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"Name","min-width":"20%",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"desc",label:"Description","min-width":"30%",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"Status","min-width":"15%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{placement:"top",title:t.row.name,trigger:"hover"}},[a("div",[a("el-button",{staticClass:"dataset-btn",attrs:{type:""===t.row.trainSetName?"danger":"success",plain:"",size:"mini"}},[e._v("TrainSet")]),e._v(" "),a("el-button",{staticClass:"dataset-btn",attrs:{type:""===t.row.testSetName?"danger":"success",plain:"",size:"mini"}},[e._v("TestSet")]),e._v(" "),a("el-button",{staticClass:"dataset-btn",attrs:{type:""===t.row.devSetName?"danger":"success",plain:"",size:"mini"}},[e._v("DevSet")])],1),e._v(" "),a("el-tag",{attrs:{slot:"reference",type:t.row.status?"success":"danger"},on:{click:function(a){return e.showMsg(t.row.status)}},slot:"reference"},[e._v(e._s(t.row.status?"Available":"Not Available"))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operations",label:"Operations","min-width":"35%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.status?a("div",[a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return e.goToModelEvaluation(t.row.id)}}},[e._v("Model Evaluation")]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return e.goToAutoSelection(t.row.id)}}},[e._v("Auto Selection")])],1):a("div",[a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return e.openUploadDatasetForm(t.row.id,t.row.trainSetName,t.row.testSetName,t.row.devSetName)}}},[e._v("Upload")])],1)]}}])})],2)],1)])])])],1)],1)},staticRenderFns:[]};var $=a("VU/8")(T,S,!1,function(e){a("GJv3")},"data-v-62a798da",null).exports,E={name:"UploadKg",data:()=>({kgTableHeight:200,kgTableData:[],kgTableEmptyText:"Loading...",dialogFormVisible:!1,uploadKgForm:{name:"",desc:""},fileList:[],rules:{name:[{required:!0,message:"Please input name",trigger:"blur"}],desc:[{required:!0,message:"Please input description",trigger:"blur"}]}}),methods:{loadKg(){this.$axios({method:"get",url:"/kg/doctor/"+this.$store.state.user.id}).then(e=>{this.kgTableData.length=0;for(let t in e.data)e.data.hasOwnProperty(t)&&this.kgTableData.push({id:e.data[t].id,name:e.data[t].name,desc:e.data[t].desc});0===this.kgTableData.length&&(this.kgTableEmptyText="No Knowledge Graph")}).catch(e=>{console.log(e)})},submitUpload(){this.$refs.upload.submit()},uploadKg(e){let t=new FormData;t.append("name",this.uploadKgForm.name),t.append("desc",this.uploadKgForm.desc),t.append("file",e.file),this.$axios({method:"post",url:"/kg/upload/"+this.$store.state.user.id,data:t}).then(e=>{this.closeDialogForm(),this.loadKg()}).catch(e=>{this.$message({type:"error",message:"[ERROR: UploadKg -> loadKg()] Check Console plz! ",showClose:!0}),console.log(e)})},cancelAddKG(){this.closeDialogForm()},closeDialogForm(){this.dialogFormVisible=!1,this.$refs.uploadKgForm.resetFields(),this.fileList=[]},goToKnowledgeGraph(e){this.$notify.info({title:"Notification",message:"Go to Knowledge Graph. "}),console.log(e)}},created(){this.loadKg()},mounted(){this.$nextTick(function(){this.kgTableHeight=window.innerHeight-this.$refs.kgTable.$el.offsetTop-190;let e=this;window.onresize=function(){e.kgTableHeight=window.innerHeight-e.$refs.kgTable.$el.offsetTop-190}})}},I={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"top-bar"},[a("div",{staticClass:"option-bar"},[a("div",{staticClass:"header-bar"},[a("span",[e._v("My Knowledge Graph")])]),e._v(" "),a("div",{staticClass:"operation-btn-bar"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("Add KG")])],1)])]),e._v(" "),a("el-dialog",{attrs:{title:"Upload Knowledge Graph",visible:e.dialogFormVisible,width:"640px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"uploadKgForm",attrs:{model:e.uploadKgForm,rules:e.rules,"label-position":"left","label-width":"130px"}},[a("el-form-item",{attrs:{label:"Name",prop:"name"}},[a("el-input",{model:{value:e.uploadKgForm.name,callback:function(t){e.$set(e.uploadKgForm,"name",t)},expression:"uploadKgForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Description",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.uploadKgForm.desc,callback:function(t){e.$set(e.uploadKgForm,"desc",t)},expression:"uploadKgForm.desc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"KG Format",prop:"kgFormat"}},[a("span",[a("b",[e._v("entity,relation,entity")]),e._v(" (Require CSV file type)")]),e._v(" \n          "),a("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n              header,relation,tail"),a("br"),e._v("\n              m,knows,n"),a("br"),e._v("\n              x,knows,y\n            ")]),e._v(" "),a("el-button",{attrs:{type:"info",size:"mini"}},[e._v("Sample")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"File Upload",prop:"fileUpload"}},[a("el-upload",{ref:"upload",attrs:{action:"",multiple:!1,"file-list":e.fileList,"show-file-list":!0,"http-request":e.uploadKg,"auto-upload":!1}},[a("el-button",{staticClass:"browse-btn",attrs:{slot:"trigger",type:"primary"},slot:"trigger"},[e._v("Browse")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitUpload}},[e._v("Submit")]),e._v(" "),a("el-button",{on:{click:e.cancelAddKG}},[e._v("Cancel")])],1)],1),e._v(" "),a("div",{staticClass:"content-div scrollable-div"},[a("el-scrollbar",[a("div",{staticClass:"content-parent"},[a("div",{staticClass:"content"},[a("div",{staticClass:"item-list"},[a("el-table",{ref:"kgTable",attrs:{data:e.kgTableData,"max-height":e.kgTableHeight}},[a("template",{slot:"empty"},[a("span",[e._v(e._s(e.kgTableEmptyText))])]),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"Name","min-width":"20%",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"desc",label:"Description","min-width":"30%",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"operations",label:"Operations","min-width":"50%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return e.goToKnowledgeGraph(t.row.id)}}},[e._v("Show this KG")])]}}])})],2)],1)])])])],1)],1)},staticRenderFns:[]};var N=a("VU/8")(E,I,!1,function(e){a("E0Mh")},"data-v-34c0c14a",null).exports,A={name:"ModelEvaluation",data:()=>({modelEvaluationTaskTableHeight:200,modelEvaluationTaskTableData:[],modelEvaluationTaskTableEmptyText:"Loading...",addTaskFormVisible:!1,datasetList:[],datasetName:[],metricList:[],deepModelsOptions:[],selectedDeepModel:[],addModelEvaluationTaskForm:{name:"",datasetId:"",queryLength:"",documentLength:"",modelId:"",metricId:""},rules:{name:[{required:!0,message:"Please input name",trigger:"blur"}],dataset:[{required:!0,message:"",trigger:"blur"}],queryLength:[{required:!0,message:"",trigger:"blur"}],documentLength:[{required:!0,message:"",trigger:"blur"}],deepModels:[{required:!0,message:"",trigger:"blur"}],metric:[{required:!0,message:"",trigger:"blur"}]},resultDialogFormVisible:!1,resultDesc:"",resultTableData:[]}),methods:{loadModelEvaluationTask(){this.$axios({method:"get",url:"/task/"+this.$store.state.user.id+"/modelEvaluation"}).then(e=>{this.modelEvaluationTaskTableData.length=0;for(let t in e.data)if(e.data.hasOwnProperty(t)){let a="Model: "+this.$store.state.sysData.models[e.data[t].modelId]+",\nDataset: "+this.datasetName[e.data[t].datasetId]+",\nMetric: "+this.$store.state.sysData.metrics[e.data[t].metricId]+",\nQuery Length: "+e.data[t].queryLength+",\nDocument Length: "+e.data[t].documentLength;this.modelEvaluationTaskTableData.push({id:e.data[t].id,name:e.data[t].taskName,desc:a,status:1===e.data[t].status})}0===this.modelEvaluationTaskTableData.length&&(this.modelEvaluationTaskTableEmptyText="No Model Evaluation Task")}).catch(e=>{console.log(e)})},loadDataset(){this.$axios({method:"get",url:"/doctor/"+this.$store.state.user.id+"/availableDataSets"}).then(e=>{this.datasetList.length=0;for(let t in e.data)if(e.data.hasOwnProperty(t)){let a=e.data[t].id,s=e.data[t].dataset_name;this.datasetName[a]=s,this.datasetList.push({value:a,label:s})}this.loadModelEvaluationTask()}).catch(e=>{console.log(e)})},loadMetric(){let e=this.$store.state.sysData.metrics;null!==e&&0!==e.length||(e=JSON.parse(sessionStorage.getItem("addsSysData")).metrics);for(let t in e)e.hasOwnProperty(t)&&null!=e[t]&&this.metricList.push({value:t,label:e[t]})},loadDeepModels(){this.$axios({method:"get",url:"/modelCategory"}).then(e=>{for(let t in e.data)if(e.data.hasOwnProperty(t)){let a=[],s=e.data[t].models;for(let e in s)s.hasOwnProperty(e)&&a.push({value:s[e].id,label:s[e].name});this.deepModelsOptions.push({value:e.data[t].id,label:e.data[t].name,children:a})}}).catch(e=>{console.log(e)})},selectModel(e){this.addModelEvaluationTaskForm.modelId=e[e.length-1]},cancelAddModelEvaluationTask(){this.closeAddModelEvaluationTaskForm()},closeAddModelEvaluationTaskForm(){this.addTaskFormVisible=!1,this.selectedDeepModel=[],this.addModelEvaluationTaskForm.metricId="",this.$refs.addModelEvaluationTask.resetFields()},addModelEvaluationTask(){this.$axios({method:"post",url:"/task/"+this.$store.state.user.id+"/modelEvaluation",data:{taskName:this.addModelEvaluationTaskForm.name,datasetId:this.addModelEvaluationTaskForm.datasetId,queryLength:this.addModelEvaluationTaskForm.queryLength,documentLength:this.addModelEvaluationTaskForm.documentLength,modelId:this.addModelEvaluationTaskForm.modelId,metricId:this.addModelEvaluationTaskForm.metricId}}).then(e=>{this.loadModelEvaluationTask(),this.beginTask(e.data)}).catch(e=>{this.$message({type:"error",message:"[ERROR: ModelEvaluation.vue -> addModelEvaluationTask()] Check Console plz! ",showClose:!0}),console.log(e)})},beginTask(e){this.$axios({method:"post",url:"/doctor/"+this.$store.state.user.id+"/DLTask",data:{id:e,taskName:this.addModelEvaluationTaskForm.name,datasetId:this.addModelEvaluationTaskForm.datasetId,queryLength:this.addModelEvaluationTaskForm.queryLength,documentLength:this.addModelEvaluationTaskForm.documentLength,modelId:this.addModelEvaluationTaskForm.modelId,metricId:this.addModelEvaluationTaskForm.metricId}}).then(e=>{this.closeAddModelEvaluationTaskForm()}).catch(e=>{console.log(e)})},showResult(e){this.resultTableData.length=0,this.resultDialogFormVisible=!0,this.loadTaskResult(e)},closeResultDialog(){this.resultDialogFormVisible=!1},loadTaskResult(e){this.$axios({method:"get",url:"/task/modelEvaluationResult/"+e}).then(e=>{this.resultTableData.push({model:e.data.modelName,ndcg1:e.data.ndcg1,ndcg3:e.data.ndcg3,ndcg5:e.data.ndcg5,ndcg10:e.data.ndcg10,map:e.data.map,recall3:e.data.recall3,recall5:e.data.recall5,recall10:e.data.recall10,precision1:e.data.precision1,precision3:e.data.precision3,precision5:e.data.precision5,precision10:e.data.precision10}),this.resultDesc="model: "+e.data.modelName+", n@1: "+e.data.ndcg1+", n@3: "+e.data.ndcg3+", n@5: "+e.data.ndcg5+", n@10: "+e.data.ndcg10+", map: "+e.data.map+", r@3: "+e.data.recall3+", r@5: "+e.data.recall5+", r@10: "+e.data.recall10+", p@1: "+e.data.precision1+", p@3: "+e.data.precision3+", p@5: "+e.data.precision5+", p@10: "+e.data.precision10}).catch(e=>{this.$message({type:"error",message:"[ERROR: ModelEvaluation.vue -> loadTaskResult()] Check Console plz! ",showClose:!0}),console.log(e)})},lineFeeds:e=>e.replace(/\n/g,"<br/>"),showMsg(e){e?this.$notify({title:"Success",message:"This task is finished! Check RESULT! ",type:"success"}):this.$notify.info({title:"Notification",message:"This task is still running! "})}},created(){this.loadDeepModels(),this.loadMetric(),this.loadDataset()},mounted(){this.$nextTick(function(){this.modelEvaluationTaskTableHeight=window.innerHeight-this.$refs.modelEvaluationTaskTable.$el.offsetTop-190;let e=this;window.onresize=function(){e.modelEvaluationTaskTableHeight=window.innerHeight-e.$refs.modelEvaluationTaskTable.$el.offsetTop-190}})}},M={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"top-bar"},[a("div",{staticClass:"option-bar"},[a("div",{staticClass:"header-bar"},[a("span",[e._v("Model Evaluation Tasks")])]),e._v(" "),a("div",{staticClass:"operation-btn-bar"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addTaskFormVisible=!0}}},[e._v("Add a task")])],1)])]),e._v(" "),a("el-dialog",{attrs:{title:"New Task",visible:e.addTaskFormVisible,width:"640px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.addTaskFormVisible=t}}},[a("el-form",{ref:"addModelEvaluationTask",attrs:{model:e.addModelEvaluationTaskForm,rules:e.rules,"label-position":"left","label-width":"140px"}},[a("el-form-item",{attrs:{label:"Name",prop:"name"}},[a("el-input",{attrs:{placeholder:"Input task name"},model:{value:e.addModelEvaluationTaskForm.name,callback:function(t){e.$set(e.addModelEvaluationTaskForm,"name",t)},expression:"addModelEvaluationTaskForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Dataset",prop:"dataset"}},[a("el-select",{attrs:{placeholder:"Choose a dataset"},model:{value:e.addModelEvaluationTaskForm.datasetId,callback:function(t){e.$set(e.addModelEvaluationTaskForm,"datasetId",t)},expression:"addModelEvaluationTaskForm.datasetId"}},e._l(e.datasetList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Query Length",prop:"queryLength"}},[a("el-input",{attrs:{placeholder:"Input query length"},model:{value:e.addModelEvaluationTaskForm.queryLength,callback:function(t){e.$set(e.addModelEvaluationTaskForm,"queryLength",t)},expression:"addModelEvaluationTaskForm.queryLength"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Document Length",prop:"documentLength"}},[a("el-input",{attrs:{placeholder:"Input document length"},model:{value:e.addModelEvaluationTaskForm.documentLength,callback:function(t){e.$set(e.addModelEvaluationTaskForm,"documentLength",t)},expression:"addModelEvaluationTaskForm.documentLength"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Deep Models",prop:"deepModels"}},[a("el-cascader",{ref:"selectedDeepModelOptions",attrs:{options:e.deepModelsOptions,props:{expandTrigger:"hover"},placeholder:"Select a model"},on:{change:e.selectModel},model:{value:e.selectedDeepModel,callback:function(t){e.selectedDeepModel=t},expression:"selectedDeepModel"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Metric",prop:"metric"}},[a("el-select",{attrs:{placeholder:"Choose a metric"},model:{value:e.addModelEvaluationTaskForm.metricId,callback:function(t){e.$set(e.addModelEvaluationTaskForm,"metricId",t)},expression:"addModelEvaluationTaskForm.metricId"}},e._l(e.metricList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addModelEvaluationTask}},[e._v("Submit")]),e._v(" "),a("el-button",{on:{click:e.cancelAddModelEvaluationTask}},[e._v("Cancel")])],1)],1),e._v(" "),a("div",{staticClass:"content-div scrollable-div"},[a("el-scrollbar",[a("div",{staticClass:"content-parent"},[a("div",{staticClass:"content"},[a("div",{staticClass:"item-list"},[a("el-table",{ref:"modelEvaluationTaskTable",attrs:{data:e.modelEvaluationTaskTableData,"max-height":e.modelEvaluationTaskTableHeight}},[a("template",{slot:"empty"},[a("span",[e._v(e._s(e.modelEvaluationTaskTableEmptyText))])]),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"Name","min-width":"15%",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"desc",label:"Description","min-width":"45%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s(e.lineFeeds(t.row.desc))},slot:"content"}),e._v(" "),a("div",{staticClass:"ellipsis-desc"},[e._v(e._s(t.row.desc))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"Status","min-width":"18%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.status?"success":"info"},on:{click:function(a){return e.showMsg(t.row.status)}}},[e._v(e._s(t.row.status?"Finished":"Running"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operations",label:"Operations","min-width":"22%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.status?a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return e.showResult(t.row.id)}}},[e._v("Result")]):e._e()]}}])})],2)],1)])])])],1),e._v(" "),a("el-dialog",{attrs:{title:"Result",visible:e.resultDialogFormVisible,width:"840px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.resultDialogFormVisible=t}}},[a("div",{staticStyle:{margin:"10px 5px"}},[a("span",[a("b",[e._v("Result: ")])]),a("br"),e._v(" "),a("span",[e._v(e._s(e.resultDesc))])]),e._v(" "),a("el-table",{attrs:{data:e.resultTableData,size:"small",border:""}},[a("el-table-column",{attrs:{label:"model",prop:"model",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"NDCG@1",prop:"ndcg1",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"NDCG@3",prop:"ndcg3",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"NDCG@5",prop:"ndcg5",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"NDCG@10",prop:"ndcg10",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"map",prop:"map",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Recall@3",prop:"recall3",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Recall@5",prop:"recall5",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Recall@10",prop:"recall10",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Precision@1",prop:"precision1",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Precision@3",prop:"precision3",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Precision@5",prop:"precision5",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Precision@10",prop:"precision10",align:"center"}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeResultDialog}},[e._v("Close")])],1)],1)],1)},staticRenderFns:[]};var R=a("VU/8")(A,M,!1,function(e){a("eLQm")},"data-v-d1fa3d50",null).exports,U={name:"AutoSelection",data:()=>({autoSelectionTaskTableHeight:200,autoSelectionTaskTableData:[],autoSelectionTaskTableEmptyText:"Loading...",addTaskFormVisible:!1,addAutoSelectionTaskForm:{name:"",datasetId:"",queryLength:"",documentLength:"",metricId:""},rules:{name:[{required:!0,message:"",trigger:"blur"}],dataset:[{required:!0,message:"",trigger:"blur"}],queryLength:[{required:!0,message:"",trigger:"blur"}],documentLength:[{required:!0,message:"",trigger:"blur"}],metric:[{required:!0,message:"",trigger:"blur"}]},datasetList:[],datasetName:[],metricList:[],deepModelCount:0,resultDialogFormVisible:!1,currentResultTaskId:0,currentResultTaskName:"",bestResultDesc:"",resultTableData:[],resultData:{columns:["model","metric"],rows:[]},resultSettings:{metrics:["metric"],dimension:["model"],labelMap:{metric:""}},resultExtend:{series:{},xAxis:{axisLabel:{rotate:90},triggerEvent:!0}}}),methods:{loadAutoSelectionTask(){this.$axios({method:"get",url:"/task/"+this.$store.state.user.id+"/autoSelection"}).then(e=>{this.autoSelectionTaskTableData.length=0;for(let t in e.data)if(e.data.hasOwnProperty(t)){let a="Dataset: "+this.datasetName[e.data[t].datasetId]+",\nMetric: "+this.$store.state.sysData.metrics[e.data[t].metricId]+",\nQuery Length: "+e.data[t].queryLength+",\nDocument Length: "+e.data[t].documentLength;this.autoSelectionTaskTableData.push({id:e.data[t].id,name:e.data[t].taskName,desc:a,status:e.data[t].status===this.deepModelCount,metric:e.data[t].metricId})}0===this.autoSelectionTaskTableData.length&&(this.autoSelectionTaskTableEmptyText="No Auto Selection Task")}).catch(e=>{console.log(e)})},loadDataset(){this.$axios({method:"get",url:"/doctor/"+this.$store.state.user.id+"/availableDataSets"}).then(e=>{this.datasetList.length=0;for(let t in e.data)if(e.data.hasOwnProperty(t)){let a=e.data[t].id,s=e.data[t].dataset_name;this.datasetName[a]=s,this.datasetList.push({value:a,label:s})}this.loadAutoSelectionTask()}).catch(e=>{this.$message({type:"error",message:"[ERROR: AutoSelection.vue -> loadDataset()] Check Console plz! ",showClose:!0}),console.log(e)})},loadMetric(){let e=this.$store.state.sysData.metrics;null!==e&&0!==e.length||(e=JSON.parse(sessionStorage.getItem("addsSysData")).metrics);for(let t in e)e.hasOwnProperty(t)&&null!=e[t]&&this.metricList.push({value:t,label:e[t]})},cancelAddAutoSelectionTask(){this.closeAddAutoSelectionTaskForm()},closeAddAutoSelectionTaskForm(){this.addTaskFormVisible=!1,this.addAutoSelectionTaskForm.metricId="",this.$refs.addAutoSelectionTaskForm.resetFields()},addAutoSelectionTask(){this.$axios({method:"post",url:"/task/"+this.$store.state.user.id+"/autoSelection",data:{taskName:this.addAutoSelectionTaskForm.name,datasetId:this.addAutoSelectionTaskForm.datasetId,queryLength:this.addAutoSelectionTaskForm.queryLength,documentLength:this.addAutoSelectionTaskForm.documentLength,metricId:this.addAutoSelectionTaskForm.metricId}}).then(e=>{this.loadAutoSelectionTask(),this.beginTask(e.data)}).catch(e=>{this.$message({type:"error",message:"[ERROR: AutoSelection.vue -> addAutoSelectionTask()] Check Console plz! ",showClose:!0}),console.log(e)})},beginTask(e){this.$axios({method:"post",url:"/doctor/"+this.$store.state.user.id+"/DLTask",data:{id:e,taskName:this.addModelEvaluationTaskForm.name,datasetId:this.addModelEvaluationTaskForm.datasetId,queryLength:this.addModelEvaluationTaskForm.queryLength,documentLength:this.addModelEvaluationTaskForm.documentLength,modelId:this.addModelEvaluationTaskForm.modelId,metricId:this.addModelEvaluationTaskForm.metricId}}).then(e=>{console.log(e),this.closeAddAutoSelectionTaskForm()}).catch(e=>{this.$message({type:"error",message:"[ERROR: AutoSelection.vue -> beginTask()] Check Console plz! ",showClose:!0}),console.log(e)})},showResult(e){this.resultTableData.length=0,this.resultData.rows.length=0,this.resultDialogFormVisible=!0,this.currentResultTaskId=e.id,this.currentResultTaskName=e.name,this.loadTaskResult(e)},closeResultDialog(){this.resultDialogFormVisible=!1},loadTaskResult(e){this.$axios({method:"get",url:"/task/autoSelectionResult/"+e.id}).then(t=>{let a=-1,s={1:"ndcg1",2:"ndcg3",3:"ndcg5",4:"ndcg10",5:"map",6:"recall3",7:"recall5",8:"recall10",9:"precision1",10:"precision3",11:"precision5",12:"precision10"};this.resultSettings.labelMap.metric={1:"NDCG@1",2:"NDCG@3",3:"NDCG@5",4:"NDCG@10",5:"map",6:"Recall@3",7:"Recall@5",8:"Recall@10",9:"Precision@1",10:"Precision@3",11:"Precision@5",12:"Precision@10"}[e.metric];for(let o in t.data)t.data.hasOwnProperty(o)&&(this.resultTableData.push({model:t.data[o].modelName,ndcg1:t.data[o].ndcg1,ndcg3:t.data[o].ndcg3,ndcg5:t.data[o].ndcg5,ndcg10:t.data[o].ndcg10,map:t.data[o].map,recall3:t.data[o].recall3,recall5:t.data[o].recall5,recall10:t.data[o].recall10,precision1:t.data[o].precision1,precision3:t.data[o].precision3,precision5:t.data[o].precision5,precision10:t.data[o].precision10}),this.resultData.rows.push({model:t.data[o].modelName,metric:t.data[o][s[e.metric]]}),t.data[o][s[e.metric]]>-999&&(a=o));this.bestResultDesc="model: "+t.data[a].modelName+", n@1: "+t.data[a].ndcg1+", n@3: "+t.data[a].ndcg3+", n@5: "+t.data[a].ndcg5+", n@10: "+t.data[a].ndcg10+", map: "+t.data[a].map+", r@3: "+t.data[a].recall3+", r@5: "+t.data[a].recall5+", r@10: "+t.data[a].recall10+", p@1: "+t.data[a].precision1+", p@3: "+t.data[a].precision3+", p@5: "+t.data[a].precision5+", p@10: "+t.data[a].precision10}).catch(e=>{console.log(e)})},downloadResult(){this.$axios({method:"get",url:"/task/autoSelection/downloadResult/"+this.currentResultTaskId,responseType:"blob"}).then(e=>{let t=new Blob([e.data],{type:"application/octet-stream"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=this.currentResultTaskName+"_Result.xls",s.click()}).catch(e=>{this.$message({type:"error",message:"[ERROR: AutoSelection.vue -> downloadResult()] Check Console plz! ",showClose:!0}),console.log(e)})},lineFeeds:e=>e.replace(/\n/g,"<br/>"),showMsg(e){e?this.$notify({title:"Success",message:"This task is finished! Check RESULT! ",type:"success"}):this.$notify.info({title:"Notification",message:"This task is still running! "})}},created(){this.loadMetric(),this.$axios({method:"get",url:"/modelCategory"}).then(e=>{let t=0;for(let a in e.data)e.data.hasOwnProperty(a)&&(t+=e.data[a].models.length);this.deepModelCount=t,this.loadDataset()}).catch(e=>{console.log(e)})},mounted(){this.$nextTick(function(){this.autoSelectionTaskTableHeight=window.innerHeight-this.$refs.autoSelectionTaskTable.$el.offsetTop-190;let e=this;window.onresize=function(){e.autoSelectionTaskTableHeight=window.innerHeight-e.$refs.autoSelectionTaskTable.$el.offsetTop-190}})}},L={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"top-bar"},[a("div",{staticClass:"option-bar"},[a("div",{staticClass:"header-bar"},[a("span",[e._v("Auto Selection Tasks")])]),e._v(" "),a("div",{staticClass:"operation-btn-bar"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addTaskFormVisible=!0}}},[e._v("Add a task")])],1)])]),e._v(" "),a("el-dialog",{attrs:{title:"New Task",visible:e.addTaskFormVisible,width:"640px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.addTaskFormVisible=t}}},[a("el-form",{ref:"addAutoSelectionTaskForm",attrs:{model:e.addAutoSelectionTaskForm,rules:e.rules,"label-position":"left","label-width":"140px"}},[a("el-form-item",{attrs:{label:"Name",prop:"name"}},[a("el-input",{attrs:{placeholder:"Input task name"},model:{value:e.addAutoSelectionTaskForm.name,callback:function(t){e.$set(e.addAutoSelectionTaskForm,"name",t)},expression:"addAutoSelectionTaskForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Dataset",prop:"dataset"}},[a("el-select",{attrs:{placeholder:"Choose a dataset"},model:{value:e.addAutoSelectionTaskForm.datasetId,callback:function(t){e.$set(e.addAutoSelectionTaskForm,"datasetId",t)},expression:"addAutoSelectionTaskForm.datasetId"}},e._l(e.datasetList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Metric",prop:"metric"}},[a("el-select",{attrs:{placeholder:"Choose a metric"},model:{value:e.addAutoSelectionTaskForm.metricId,callback:function(t){e.$set(e.addAutoSelectionTaskForm,"metricId",t)},expression:"addAutoSelectionTaskForm.metricId"}},e._l(e.metricList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Query Length",prop:"queryLength"}},[a("el-input",{attrs:{placeholder:"Input query length"},model:{value:e.addAutoSelectionTaskForm.queryLength,callback:function(t){e.$set(e.addAutoSelectionTaskForm,"queryLength",t)},expression:"addAutoSelectionTaskForm.queryLength"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Document Length",prop:"documentLength"}},[a("el-input",{attrs:{placeholder:"Input document length"},model:{value:e.addAutoSelectionTaskForm.documentLength,callback:function(t){e.$set(e.addAutoSelectionTaskForm,"documentLength",t)},expression:"addAutoSelectionTaskForm.documentLength"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addAutoSelectionTask}},[e._v("Submit")]),e._v(" "),a("el-button",{on:{click:e.cancelAddAutoSelectionTask}},[e._v("Cancel")])],1)],1),e._v(" "),a("div",{staticClass:"content-div scrollable-div"},[a("el-scrollbar",[a("div",{staticClass:"content-parent"},[a("div",{staticClass:"content"},[a("div",{staticClass:"item-list"},[a("el-table",{ref:"autoSelectionTaskTable",attrs:{data:e.autoSelectionTaskTableData,"max-height":e.autoSelectionTaskTableHeight}},[a("template",{slot:"empty"},[a("span",[e._v(e._s(e.autoSelectionTaskTableEmptyText))])]),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"Name","min-width":"15%",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"desc",label:"Description","min-width":"45%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s(e.lineFeeds(t.row.desc))},slot:"content"}),e._v(" "),a("div",{staticClass:"ellipsis-desc"},[e._v(e._s(t.row.desc))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"Status","min-width":"18%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.status?"success":"info"},on:{click:function(a){return e.showMsg(t.row.status)}}},[e._v(e._s(t.row.status?"Finished":"Running"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operations",label:"Operations","min-width":"22%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.status?a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return e.showResult(t.row)}}},[e._v("Result")]):e._e()]}}])})],2)],1)])])])],1),e._v(" "),a("el-dialog",{attrs:{title:"Result",visible:e.resultDialogFormVisible,width:"840px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.resultDialogFormVisible=t}}},[a("div",{staticStyle:{margin:"10px 5px"}},[a("span",[a("b",[e._v("The best result: ")])]),a("br"),e._v(" "),a("span",[e._v(e._s(e.bestResultDesc))])]),e._v(" "),a("el-table",{attrs:{data:e.resultTableData,size:"small",border:"",stripe:!0,height:"200"}},[a("el-table-column",{attrs:{label:"model","min-width":"100px",prop:"model",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"NDCG@1",prop:"ndcg1",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"NDCG@3",prop:"ndcg3",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"NDCG@5",prop:"ndcg5",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"NDCG@10",prop:"ndcg10",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"map",prop:"map",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Recall@3",prop:"recall3",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Recall@5",prop:"recall5",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Recall@10",prop:"recall10",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Precision@1",prop:"precision1",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Precision@3",prop:"precision3",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Precision@5",prop:"precision5",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Precision@10",prop:"precision10",align:"center"}})],1),e._v(" "),a("div",{staticClass:"download-btn",staticStyle:{"text-align":"right",margin:"10px"}},[a("span",[e._v("Download Results")]),e._v(" \n"),e._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:e.downloadResult}},[e._v("Download")])],1),e._v(" "),a("ve-histogram",{staticStyle:{width:"640px",height:"280px",margin:"20px auto 20px"},attrs:{data:e.resultData,settings:e.resultSettings,extend:e.resultExtend}}),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeResultDialog}},[e._v("Close")])],1)],1)],1)},staticRenderFns:[]};var q=a("VU/8")(U,L,!1,function(e){a("26mL")},"data-v-82eb199e",null).exports,P={name:"KnowledgeExploration",data:()=>({knowledgeExplorationTaskTableHeight:200,knowledgeExplorationTaskTableData:[],knowledgeExplorationTaskTableEmptyText:"Loading...",addTaskFormVisible:!1,addKnowledgeExplorationTaskForm:{name:"",datasetId:"",queryLength:"",documentLength:"",metricId:""},rules:{name:[{required:!0,message:"",trigger:"blur"}],dataset:[{required:!0,message:"",trigger:"blur"}],queryLength:[{required:!0,message:"",trigger:"blur"}],documentLength:[{required:!0,message:"",trigger:"blur"}],metric:[{required:!0,message:"",trigger:"blur"}]},datasetList:[],datasetName:[],metricList:[],deepModelCount:0,resultDialogFormVisible:!1,currentResultTaskId:0,currentResultTaskName:"",bestResultDesc:"",resultTableData:[],resultData:{columns:["model","metric"],rows:[]},resultSettings:{metrics:["metric"],dimension:["model"],labelMap:{metric:""}},resultExtend:{series:{},xAxis:{axisLabel:{rotate:90},triggerEvent:!0}}}),methods:{loadKnowledgeExplorationTask(){this.$axios({method:"get",url:"/task/"+this.$store.state.user.id+"/knowledgeExploration"}).then(e=>{this.knowledgeExplorationTaskTableData.length=0;for(let t in e.data)if(e.data.hasOwnProperty(t)){let a="Dataset: "+this.datasetName[e.data[t].datasetId]+",\nMetric: "+this.$store.state.sysData.metrics[e.data[t].metricId]+",\nQuery Length: "+e.data[t].queryLength+",\nDocument Length: "+e.data[t].documentLength;this.knowledgeExplorationTaskTableData.push({id:e.data[t].id,name:e.data[t].taskName,desc:a,status:e.data[t].status===this.deepModelCount,metric:e.data[t].metricId})}0===this.knowledgeExplorationTaskTableData.length&&(this.knowledgeExplorationTaskTableEmptyText="No Knowledge Exploration Task")}).catch(e=>{console.log(e)})},loadDataset(){this.$axios({method:"get",url:"/doctor/"+this.$store.state.user.id+"/availableDataSets"}).then(e=>{this.datasetList.length=0;for(let t in e.data)if(e.data.hasOwnProperty(t)){let a=e.data[t].id,s=e.data[t].dataset_name;this.datasetName[a]=s,this.datasetList.push({value:a,label:s})}this.loadKnowledgeExplorationTask()}).catch(e=>{this.$message({type:"error",message:"[ERROR: KnowledgeExploration.vue -> loadDataset()] Check Console plz! ",showClose:!0}),console.log(e)})},loadMetric(){let e=this.$store.state.sysData.metrics;null!==e&&0!==e.length||(e=JSON.parse(sessionStorage.getItem("addsSysData")).metrics);for(let t in e)e.hasOwnProperty(t)&&null!=e[t]&&this.metricList.push({value:t,label:e[t]})},cancelAddKnowledgeExplorationTask(){this.closeAddKnowledgeExplorationTaskForm()},closeAddKnowledgeExplorationTaskForm(){this.addTaskFormVisible=!1,this.addKnowledgeExplorationTaskForm.metricId="",this.$refs.addKnowledgeExplorationTaskForm.resetFields()},addKnowledgeExplorationTask(){this.$axios({method:"post",url:"/task/"+this.$store.state.user.id+"/knowledgeExploration",data:{taskName:this.addKnowledgeExplorationTaskForm.name,datasetId:this.addKnowledgeExplorationTaskForm.datasetId,queryLength:this.addKnowledgeExplorationTaskForm.queryLength,documentLength:this.addKnowledgeExplorationTaskForm.documentLength,metricId:this.addKnowledgeExplorationTaskForm.metricId}}).then(e=>{this.loadKnowledgeExplorationTask(),this.beginTask(e.data)}).catch(e=>{this.$message({type:"error",message:"[ERROR: KnowledgeExploration.vue -> addKnowledgeExplorationTask()] Check Console plz! ",showClose:!0}),console.log(e)})},beginTask(e){this.$axios({method:"post",url:"/doctor/"+this.$store.state.user.id+"/DLTask",data:{id:e,taskName:this.addModelEvaluationTaskForm.name,datasetId:this.addModelEvaluationTaskForm.datasetId,queryLength:this.addModelEvaluationTaskForm.queryLength,documentLength:this.addModelEvaluationTaskForm.documentLength,modelId:this.addModelEvaluationTaskForm.modelId,metricId:this.addModelEvaluationTaskForm.metricId}}).then(e=>{console.log(e),this.closeAddKnowledgeExplorationTaskForm()}).catch(e=>{this.$message({type:"error",message:"[ERROR: KnowledgeExploration.vue -> beginTask()] Check Console plz! ",showClose:!0}),console.log(e)})},showResult(e){this.resultTableData.length=0,this.resultData.rows.length=0,this.resultDialogFormVisible=!0,this.currentResultTaskId=e.id,this.currentResultTaskName=e.name,this.loadTaskResult(e)},closeResultDialog(){this.resultDialogFormVisible=!1},loadTaskResult(e){this.$axios({method:"get",url:"/task/knowledgeExplorationResult/"+e.id}).then(t=>{let a=-1,s={1:"ndcg1",2:"ndcg3",3:"ndcg5",4:"ndcg10",5:"map",6:"recall3",7:"recall5",8:"recall10",9:"precision1",10:"precision3",11:"precision5",12:"precision10"};this.resultSettings.labelMap.metric={1:"NDCG@1",2:"NDCG@3",3:"NDCG@5",4:"NDCG@10",5:"map",6:"Recall@3",7:"Recall@5",8:"Recall@10",9:"Precision@1",10:"Precision@3",11:"Precision@5",12:"Precision@10"}[e.metric];for(let o in t.data)t.data.hasOwnProperty(o)&&(this.resultTableData.push({model:t.data[o].modelName,ndcg1:t.data[o].ndcg1,ndcg3:t.data[o].ndcg3,ndcg5:t.data[o].ndcg5,ndcg10:t.data[o].ndcg10,map:t.data[o].map,recall3:t.data[o].recall3,recall5:t.data[o].recall5,recall10:t.data[o].recall10,precision1:t.data[o].precision1,precision3:t.data[o].precision3,precision5:t.data[o].precision5,precision10:t.data[o].precision10}),this.resultData.rows.push({model:t.data[o].modelName,metric:t.data[o][s[e.metric]]}),t.data[o][s[e.metric]]>-999&&(a=o));this.bestResultDesc="model: "+t.data[a].modelName+", n@1: "+t.data[a].ndcg1+", n@3: "+t.data[a].ndcg3+", n@5: "+t.data[a].ndcg5+", n@10: "+t.data[a].ndcg10+", map: "+t.data[a].map+", r@3: "+t.data[a].recall3+", r@5: "+t.data[a].recall5+", r@10: "+t.data[a].recall10+", p@1: "+t.data[a].precision1+", p@3: "+t.data[a].precision3+", p@5: "+t.data[a].precision5+", p@10: "+t.data[a].precision10}).catch(e=>{console.log(e)})},downloadResult(){this.$axios({method:"get",url:"/task/knowledgeExploration/downloadResult/"+this.currentResultTaskId,responseType:"blob"}).then(e=>{let t=new Blob([e.data],{type:"application/octet-stream"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=this.currentResultTaskName+"_Result.xls",s.click()}).catch(e=>{this.$message({type:"error",message:"[ERROR: KnowledgeExploration.vue -> downloadResult()] Check Console plz! ",showClose:!0}),console.log(e)})},lineFeeds:e=>e.replace(/\n/g,"<br/>"),showMsg(e){e?this.$notify({title:"Success",message:"This task is finished! Check RESULT! ",type:"success"}):this.$notify.info({title:"Notification",message:"This task is still running! "})}},created(){this.loadMetric(),this.$axios({method:"get",url:"/modelCategory"}).then(e=>{let t=0;for(let a in e.data)e.data.hasOwnProperty(a)&&(t+=e.data[a].models.length);this.deepModelCount=t,this.loadDataset()}).catch(e=>{console.log(e)})},mounted(){this.$nextTick(function(){this.knowledgeExplorationTaskTableHeight=window.innerHeight-this.$refs.knowledgeExplorationTaskTable.$el.offsetTop-190;let e=this;window.onresize=function(){e.knowledgeExplorationTaskTableHeight=window.innerHeight-e.$refs.knowledgeExplorationTaskTable.$el.offsetTop-190}})}},B={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"top-bar"},[a("div",{staticClass:"option-bar"},[a("div",{staticClass:"header-bar"},[a("span",[e._v("Knowledge Exploration Tasks")])]),e._v(" "),a("div",{staticClass:"operation-btn-bar"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addTaskFormVisible=!0}}},[e._v("Add a task")])],1)])]),e._v(" "),a("el-dialog",{attrs:{title:"New Task",visible:e.addTaskFormVisible,width:"640px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.addTaskFormVisible=t}}},[a("el-form",{ref:"addKnowledgeExplorationTaskForm",attrs:{model:e.addKnowledgeExplorationTaskForm,rules:e.rules,"label-position":"left","label-width":"140px"}},[a("el-form-item",{attrs:{label:"Name",prop:"name"}},[a("el-input",{attrs:{placeholder:"Input task name"},model:{value:e.addKnowledgeExplorationTaskForm.name,callback:function(t){e.$set(e.addKnowledgeExplorationTaskForm,"name",t)},expression:"addKnowledgeExplorationTaskForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Dataset",prop:"dataset"}},[a("el-select",{attrs:{placeholder:"Choose a dataset"},model:{value:e.addKnowledgeExplorationTaskForm.datasetId,callback:function(t){e.$set(e.addKnowledgeExplorationTaskForm,"datasetId",t)},expression:"addKnowledgeExplorationTaskForm.datasetId"}},e._l(e.datasetList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Metric",prop:"metric"}},[a("el-select",{attrs:{placeholder:"Choose a metric"},model:{value:e.addKnowledgeExplorationTaskForm.metricId,callback:function(t){e.$set(e.addKnowledgeExplorationTaskForm,"metricId",t)},expression:"addKnowledgeExplorationTaskForm.metricId"}},e._l(e.metricList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Query Length",prop:"queryLength"}},[a("el-input",{attrs:{placeholder:"Input query length"},model:{value:e.addKnowledgeExplorationTaskForm.queryLength,callback:function(t){e.$set(e.addKnowledgeExplorationTaskForm,"queryLength",t)},expression:"addKnowledgeExplorationTaskForm.queryLength"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Document Length",prop:"documentLength"}},[a("el-input",{attrs:{placeholder:"Input document length"},model:{value:e.addKnowledgeExplorationTaskForm.documentLength,callback:function(t){e.$set(e.addKnowledgeExplorationTaskForm,"documentLength",t)},expression:"addKnowledgeExplorationTaskForm.documentLength"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addKnowledgeExplorationTask}},[e._v("Submit")]),e._v(" "),a("el-button",{on:{click:e.cancelAddKnowledgeExplorationTask}},[e._v("Cancel")])],1)],1),e._v(" "),a("div",{staticClass:"content-div scrollable-div"},[a("el-scrollbar",[a("div",{staticClass:"content-parent"},[a("div",{staticClass:"content"},[a("div",{staticClass:"item-list"},[a("el-table",{ref:"knowledgeExplorationTaskTable",attrs:{data:e.knowledgeExplorationTaskTableData,"max-height":e.knowledgeExplorationTaskTableHeight}},[a("template",{slot:"empty"},[a("span",[e._v(e._s(e.knowledgeExplorationTaskTableEmptyText))])]),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"Name","min-width":"15%",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"desc",label:"Description","min-width":"45%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s(e.lineFeeds(t.row.desc))},slot:"content"}),e._v(" "),a("div",{staticClass:"ellipsis-desc"},[e._v(e._s(t.row.desc))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"Status","min-width":"18%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.status?"success":"info"},on:{click:function(a){return e.showMsg(t.row.status)}}},[e._v(e._s(t.row.status?"Finished":"Running"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operations",label:"Operations","min-width":"22%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.status?a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return e.showResult(t.row)}}},[e._v("Result")]):e._e()]}}])})],2)],1)])])])],1),e._v(" "),a("el-dialog",{attrs:{title:"Result",visible:e.resultDialogFormVisible,width:"840px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.resultDialogFormVisible=t}}},[a("div",{staticStyle:{margin:"10px 5px"}},[a("span",[a("b",[e._v("The best result: ")])]),a("br"),e._v(" "),a("span",[e._v(e._s(e.bestResultDesc))])]),e._v(" "),a("el-table",{attrs:{data:e.resultTableData,size:"small",border:"",stripe:!0,height:"200"}},[a("el-table-column",{attrs:{label:"model","min-width":"100px",prop:"model",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"NDCG@1",prop:"ndcg1",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"NDCG@3",prop:"ndcg3",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"NDCG@5",prop:"ndcg5",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"NDCG@10",prop:"ndcg10",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"map",prop:"map",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Recall@3",prop:"recall3",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Recall@5",prop:"recall5",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Recall@10",prop:"recall10",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Precision@1",prop:"precision1",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Precision@3",prop:"precision3",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Precision@5",prop:"precision5",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Precision@10",prop:"precision10",align:"center"}})],1),e._v(" "),a("div",{staticClass:"download-btn",staticStyle:{"text-align":"right",margin:"10px"}},[a("span",[e._v("Download Results")]),e._v(" \n      "),a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:e.downloadResult}},[e._v("Download")])],1),e._v(" "),a("ve-histogram",{staticStyle:{width:"640px",height:"280px",margin:"20px auto 20px"},attrs:{data:e.resultData,settings:e.resultSettings,extend:e.resultExtend}}),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeResultDialog}},[e._v("Close")])],1)],1)],1)},staticRenderFns:[]};var G=a("VU/8")(P,B,!1,function(e){a("d0mQ")},"data-v-c7f1dcee",null).exports,O=a("vwbq"),Q=(a("fw/P"),{name:"knowledgeGraph",components:{NavigationBar:v},data:()=>({kgGroupList:[{label:"System Knowledge Graph",options:[]},{label:"My Knowledge Graph",options:[]}],kgChosen:"",kgSvgComponents:{svg:null,simulation:null,colors:[],linkGroup:[],linkTextGroup:[],nodeGroup:[],nodeTextGroup:[]},kgNodeBufferedMap:[],kgNodeUnfoldFlag:[],kgEntityInfo:{entityType:"Entity Info",id:-1,name:"",childNode:[],noChildNodeInfo:"",status:!0},kgData:{nodes:[],links:[]},kgNodeMap:[],kgNodeChildMap:[],bufferedChildEntities:{nodes:[],links:[]},searchContent:"",transform:"",statistics:{},displayPatient:!0,displayAdmission:!0,displayDisease:!0,displayDrug:!1,hideNode:["drug"]}),beforeMount:function(){this.kgChosen=0,this.loadKG(),this.$axios({method:"get",url:"/kg/statistics/"}).then(e=>{this.statistics=e.data}).catch(e=>{console.log(e)})},methods:{loadKGList(){this.$axios({method:"get",url:"/kg/user/"+this.$store.state.user.id}).then(e=>{this.kgGroupList[1].options.length=0;for(let t in e.data)e.data.hasOwnProperty(t)&&this.kgGroupList[1].options.push({value:e.data[t].id,label:e.data[t].name})}).catch(e=>{console.log(e)})},loadKG(){this.removeCurrentKgData(),this.$axios({method:"get",url:"/kg/graph"}).then(e=>{let t=e.data.nodes,a=e.data.links;this.kgData.nodes=t,this.kgData.links=a;for(let e in t)t.hasOwnProperty(e)&&(this.kgNodeBufferedMap[t[e].id]={id:t[e].id,name:t[e].name,childNode:[],relations:[],loadedInGraph:!0});for(let e in a)a.hasOwnProperty(e)&&(this.kgNodeBufferedMap[a[e].source].childNode.push({id:this.kgNodeBufferedMap[a[e].target].id,name:this.kgNodeBufferedMap[a[e].target].name}),this.kgNodeBufferedMap[a[e].source].relations.push(a[e]),this.kgNodeUnfoldFlag[a[e].source]=!1,this.kgNodeUnfoldFlag[a[e].target]=!0);this.paintGraph()}).catch(e=>{console.log(e)})},searchNode(){this.removeCurrentKgData(),this.$axios({method:"get",url:"/kg/node/search/"+this.searchContent}).then(e=>{let t=e.data.nodes,a=e.data.links;this.kgData.nodes=t,this.kgData.links=a;for(let e in t)t.hasOwnProperty(e)&&(this.kgNodeBufferedMap[t[e].id]={id:t[e].id,name:t[e].name,childNode:[],relations:[],loadedInGraph:!0});for(let e in a)a.hasOwnProperty(e)&&(this.kgNodeBufferedMap[a[e].source].childNode.push({id:this.kgNodeBufferedMap[a[e].target].id,name:this.kgNodeBufferedMap[a[e].target].name}),this.kgNodeBufferedMap[a[e].source].relations.push(a[e]),this.kgNodeUnfoldFlag[a[e].source]=!1,this.kgNodeUnfoldFlag[a[e].target]=!0);this.paintGraph()}).catch(e=>{console.log(e)})},removeCurrentKgData(){this.kgNodeBufferedMap.length=0,this.kgNodeUnfoldFlag.length=0,this.kgEntityInfo.entityType="Entity Info",this.kgEntityInfo.id=-1,this.kgEntityInfo.name="",this.kgEntityInfo.childNode.length=0,this.kgEntityInfo.noChildNodeInfo="",this.kgData.nodes.length=0,this.kgData.links.length=0},displayNodeInfo(e){this.kgEntityInfo.entityType="Node",this.kgEntityInfo.id=e,this.kgEntityInfo.name=this.kgNodeBufferedMap[e].name;let t=this.kgNodeBufferedMap[e].childNode;null!=t?0===t.length?(this.kgEntityInfo.noChildNodeInfo="Loading...",this.getRelNodes(e)):(this.kgEntityInfo.childNode=t,this.kgNodeUnfoldFlag[this.kgEntityInfo.id]&&this.unfoldRelNodes()):this.kgEntityInfo.noChildNodeInfo="No relation node"},getRelNodes(e){0===this.kgNodeBufferedMap[e].childNode.length&&this.$axios({method:"get",url:"/kg/graph/relNodes/"+e}).then(t=>{let a=t.data.nodes,s=t.data.links;this.kgNodeBufferedMap[e].childNode=a,this.kgNodeBufferedMap[e].relations=s,this.kgEntityInfo.childNode=a;for(let e in a)a.hasOwnProperty(e)&&null==this.kgNodeBufferedMap[a[e].id]&&(this.kgNodeBufferedMap[a[e].id]={id:a[e].id,name:a[e].name,childNode:[],relations:[],loadedInGraph:!1},this.kgNodeUnfoldFlag[a[e].id]=!0);this.kgNodeUnfoldFlag[this.kgEntityInfo.id]&&this.unfoldRelNodes()}).catch(e=>{console.log(e)})},unfoldRelNodes(){let e=this.kgNodeBufferedMap[this.kgEntityInfo.id].childNode;for(let t in e)if(e.hasOwnProperty(t)){let a=e[t];this.kgNodeBufferedMap[a.id].loadedInGraph||(this.kgData.nodes.push(a),this.kgNodeBufferedMap[a.id].loadedInGraph=!0)}let t=this.kgData.links.concat(this.kgNodeBufferedMap[this.kgEntityInfo.id].relations),a=new Set(t);this.kgData.links=Array.from(a),this.paintGraph(),this.kgNodeUnfoldFlag[this.kgEntityInfo.id]=!1},ellipsisRelNodes(){},resetGraph(){this.loadKG()},initGraph(){let e=this.$refs.svgDiv.offsetWidth,t=this.$refs.svgDiv.offsetHeight;this.kgSvgComponents.simulation=O.g().force("link",O.e().id(e=>e.id)).force("charge",O.f().strength(100)).force("center",O.c(e/2,t/2)).force("collide",O.d(80).strength(.2).iterations(5)),this.kgSvgComponents.colors=["#6ca46c","#4e88af","#ca635f","#d2907c","#d6744d","#cec255","#b4c6e7","#cdb4e6"],this.kgSvgComponents.svg=O.h("svg"),this.kgSvgComponents.linkGroup=this.kgSvgComponents.svg.append("g").attr("class","links"),this.kgSvgComponents.nodeGroup=this.kgSvgComponents.svg.append("g").attr("class","nodes"),this.kgSvgComponents.nodeTextGroup=this.kgSvgComponents.svg.append("g").attr("class","texts")},paintGraph(){let e=this.kgSvgComponents.svg,t=this.kgSvgComponents.simulation,a=this.kgSvgComponents.colors;e.selectAll("*").remove();let s=this.$refs.svgDiv.offsetWidth/2,o=this.$refs.svgDiv.offsetHeight/2,i=e.append("g").attr("class","links").selectAll("line").data(this.kgData.links.filter(e=>{for(const t of this.kgData.nodes)if(this.hideNode.includes(t.type)&&(t.id==e.target.id||t.id==e.source.id))return!1;return!0})).enter().append("line").attr("stroke-width",1).style("stroke","rgba(240, 240, 240, 0.8)"),l=O.h("body").select(".tooltip");null==l._groups[0][0]&&(l=O.h("body").append("div").attr("class","tooltip").style("display","none").style("color","#ffffff").style("background-color","#303133").style("text-align","center").style("border","1px solid #303133").style("border-radius","4px").style("padding","10px 20px").style("width","fit-content").style("position","relative").style("white-space","pre").style("box-shadow","2px 2px 2px #202020"));var n=this;function r(e){return!n.hideNode.includes(e.type)}function d(e){l.html(function(e){let t="";return"patient"==e.type?(t+="patient_id: "+e.patient_id+"\n",t+="gender: "+e.gender+"\n",t+="religion: "+e.religion+"\n",t+="ethnicity: "+e.ethnicity+"\n",t+="birth_time: "+e.birth_time+"\n"):"admission"==e.type?(t+="admission_id: "+e.admission_id+"\n",t+="admit_time: "+e.admit_time+"\n",t+="duration: "+e.duration+"\n",t+="flag: "+e.flag+"\n",t+="admit_age: "+e.admit_age+"\n"):"disease"==e.type?(t+="disease_id: "+e.disease_id+"\n",t+="alias: "+e.alias+"\n"):"drug"==e.type&&(t+="drug_id: "+e.drug_id+"\n",t+="drug_alias: "+e.drug_alias+"\n",t+="dose_val_rx: "+e.dose_val_rx+"\n",t+="dose_unit_rx: "+e.dose_unit_rx+"\n"),t}(e)).style("left",O.event.pageX+"px").style("top",O.event.pageY-.5*l.node().getBoundingClientRect().height+"px")}let c=e.append("g").attr("class","nodes").selectAll("circle").data(this.kgData.nodes.filter(r)).enter().append("circle").attr("cx",s).attr("cy",o).attr("r",e=>50).attr("fill",e=>"patient"==e.type?a[0]:"admission"==e.type?a[1]:"disease"==e.type?a[2]:"drug"==e.type?a[5]:void 0).style("stroke","#fff").style("stroke-width","2px").style("cursor","pointer").call(O.a().on("start",m).on("drag",h).on("end",g)).on("mouseover",function(e,t){l.style("display","block").style("color","#ffffff").style("background-color","#303133").style("border","1px solid #303133").style("box-shadow","2px 2px 2px #202020"),d(e)}).on("mousemove",function(e,t){d(e)}).on("mouseout",function(e,t){l.style("display","none")});c.on("click",e=>{this.displayNodeInfo(e.id)});let p=e.append("g").attr("class","texts").selectAll("text").data(this.kgData.nodes.filter(r)).enter().append("text").text(e=>"patient"==e.type?"patient "+e.patient_id:"admission"==e.type?"admission "+e.admission_id:"disease"==e.type?e.alias:"drug"==e.type?e.drug_alias:void 0).attr("x",s).attr("y",o).attr("text-anchor","middle").attr("fill","white").style("cursor","pointer").call(O.a().on("start",m).on("drag",h).on("end",g)).on("mouseover",function(e,t){l.style("display","block").style("color","#ffffff").style("background-color","#303133").style("border","1px solid #303133").style("box-shadow","2px 2px 2px #202020"),d(e)}).on("mousemove",function(e,t){d(e)}).on("mouseout",function(e,t){l.style("display","none")}).call(function(e){e.each(function(){for(var e,t=O.h(this),a=t.text().split(/\s+|\*|-/).reverse(),s=t.attr("x"),o=t.attr("y"),i=5,l=[],n=[],r=0;e=a.pop();)n.push(e),n.join(" ").length>9&&(1==n.length?(l.push(n.join(" ")),n.pop()):(n.pop(),l.push(n.join(" ")),n=[e]));0!=n.length&&l.push(n.join(" ")),t.text(null),i+=18*(1-l.length)*.5;for(let e=0;e<l.length;e++){const a=l[e];t.append("tspan").attr("x",s).attr("y",o).attr("dy",18*r+++i).text(a)}})});var u=e.selectAll("tspan");function m(e){O.event.active||t.alphaTarget(.2).restart(),e.fx=e.x,e.fy=e.y}function h(e){e.fx=O.event.x,e.fy=O.event.y}function g(e){O.event.active||t.alphaTarget(0),e.fx=null,e.fy=null}p.on("click",e=>{this.displayNodeInfo(e.id)}),e.selectAll("g").attr("transform",this.transform),t.nodes(this.kgData.nodes.filter(r)).on("tick",function(){i.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),c.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),p.attr("x",function(e){return e.x}).attr("y",function(e){return e.y}),u.attr("x",function(e){return e.x}).attr("y",function(e){return e.y})}),t.force("link").links(this.kgData.links.filter(e=>{for(const t of this.kgData.nodes)if(this.hideNode.includes(t.type)&&(t.id==e.target||t.id==e.source))return!1;return!0})),t.alpha(.1).restart(),e.call(O.j().on("zoom",()=>{e.selectAll("g").attr("transform",O.event.transform),this.transform=O.event.transform})),e.on("dblclick.zoom",null)},downloadKg(){},patientSwitchChange(e){this.switchChange(e,"patient")},admissionSwitchChange(e){this.switchChange(e,"admission")},diseaseSwitchChange(e){this.switchChange(e,"disease")},drugSwitchChange(e){this.switchChange(e,"drug")},switchChange(e,t){e?this.hideNode.splice(this.hideNode.indexOf(t),1):this.hideNode.push(t),this.paintGraph()}},created(){this.loadKGList()},mounted(){this.initGraph()}}),V={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-container",[a("NavigationBar"),e._v(" "),a("el-container",[a("el-main",[a("div",{staticClass:"kg-div"},[a("div",{ref:"svgDiv",staticClass:"svg-div"},[a("svg",{attrs:{width:"100%",height:"100%"}})])]),e._v(" "),a("div",{staticClass:"search-bar"},[a("el-input",{attrs:{placeholder:"Search Node",clearable:""},model:{value:e.searchContent,callback:function(t){e.searchContent=t},expression:"searchContent"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchNode},slot:"append"})],1)],1),e._v(" "),a("div",{staticClass:"info-div"},[a("el-card",{attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("Statistics")])]),e._v(" "),a("div",[a("span",[e._v("All nodes: "),a("em",[e._v(e._s(e.statistics.numOfNodes))])]),a("br"),a("br"),e._v(" "),a("span",[e._v("Patients: "),a("em",[e._v(e._s(e.statistics.numOfPatients))])]),a("br"),e._v(" "),a("span",[e._v("Admissions: "),a("em",[e._v(e._s(e.statistics.numOfAdmissions))])]),a("br"),e._v(" "),a("span",[e._v("Diseases: "),a("em",[e._v(e._s(e.statistics.numOfDiseases))])]),a("br"),e._v(" "),a("span",[e._v("Drugs: "),a("em",[e._v(e._s(e.statistics.numOfDrugs))])]),a("br"),a("br"),e._v(" "),a("span",[e._v("Edges: "),a("em",[e._v(e._s(e.statistics.numOfEdges))])]),a("br")])])],1),e._v(" "),a("div",{staticClass:"option-div"},[a("el-card",{attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("Display Options")])]),e._v(" "),a("div",[a("el-switch",{attrs:{"active-text":"Patients"},on:{change:e.patientSwitchChange},model:{value:e.displayPatient,callback:function(t){e.displayPatient=t},expression:"displayPatient"}}),e._v(" "),a("br"),e._v(" "),a("el-switch",{attrs:{"active-text":"Admissions"},on:{change:e.admissionSwitchChange},model:{value:e.displayAdmission,callback:function(t){e.displayAdmission=t},expression:"displayAdmission"}}),e._v(" "),a("br"),e._v(" "),a("el-switch",{attrs:{"active-text":"Diseases"},on:{change:e.diseaseSwitchChange},model:{value:e.displayDisease,callback:function(t){e.displayDisease=t},expression:"displayDisease"}}),e._v(" "),a("br"),e._v(" "),a("el-switch",{attrs:{"active-text":"Drugs"},on:{change:e.drugSwitchChange},model:{value:e.displayDrug,callback:function(t){e.displayDrug=t},expression:"displayDrug"}})],1)])],1)])],1)],1)],1)},staticRenderFns:[]};var K=a("VU/8")(Q,V,!1,function(e){a("5neq")},"data-v-e30a3268",null).exports,z={name:"medicalArchivePreprocess",components:{NavigationBar:v},methods:{loadArchiveList(){this.$axios({method:"get",url:"/archive/user/"+this.$store.state.user.id}).then(e=>{this.tableData.length=0;for(let t in e.data)e.data.hasOwnProperty(t)&&this.tableData.push({title:e.data[t].title,category:e.data[t].category,finished:e.data[t].status,id:e.data[t].id});0==e.data.length&&(this.promptText="No Medical Archive")}).catch(e=>{console.log(e)})},openUploadDialog(){this.uploadFormVisible=!0},upload(){this.$refs.upload.submit()},cancelUpload(){this.$refs.uploadForm.resetFields(),this.uploadFormVisible=!1},uploadMedicalArchive(e){let t=new FormData;t.append("title",this.uploadForm.title),t.append("category",this.uploadForm.category),t.append("desc",this.uploadForm.desc),t.append("file",e.file),this.$axios({method:"post",url:"/archive/user/"+this.$store.state.user.id,data:t}).then(e=>{this.$refs.uploadForm.resetFields(),this.uploadFormVisible=!1,this.$message({type:"success",message:"Successully uploaded medical archive!",showClose:!0}),this.loadArchiveList(),this.$axios({method:"post",url:"/preprocess/"+e.data.medicalArchiveId})}).catch(e=>{this.$message({type:"error",message:"Failed to upload! Check console.",showClose:!0}),console.log(e)})},downloadArchive(e){let t=document.createElement("a");t.style.display="none",t.href=window.location.origin+this.$axios.defaults.baseURL+"/archive/download/"+e,document.body.appendChild(t),t.click(),t.remove()}},data:function(){return{uploadFormVisible:!1,fileList:[],uploadForm:{title:"",category:"Orthopaedic",desc:""},rules:{title:[{required:!0,message:"Please input title",trigger:"blur"}],category:[{required:!0,message:"Please select category",trigger:"blur"}],uploadFile:[{required:!0,message:"Please select file",trigger:"change"}],desc:[{required:!0,message:"Please input description",trigger:"blur"}]},tableData:[],promptText:"Loading ...",tableHeight:200}},created(){this.loadArchiveList()},mounted(){this.$nextTick(function(){this.tableHeight=window.innerHeight-this.$refs.table.$el.offsetTop-190;let e=this;window.onresize=function(){e.tableHeight=window.innerHeight-e.$refs.table.$el.offsetTop-190}})}},H={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-container",[a("NavigationBar"),e._v(" "),a("el-container",{staticClass:"content-div"},[a("el-header",[a("el-button",{attrs:{type:"primary"},on:{click:e.openUploadDialog}},[e._v("Upload Medical Archive")])],1),e._v(" "),a("el-main",[a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"max-height":e.tableHeight}},[a("template",{slot:"empty"},[a("span",[e._v(e._s(e.promptText))])]),e._v(" "),a("el-table-column",{attrs:{prop:"title",label:"Title",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"category",label:"Category",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"Status",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.finished?"success":"danger","disable-transitions":""}},[e._v(e._s(t.row.finished?"Processed":"Processing")+"\n              ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Options",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small",disabled:!t.row.finished},on:{click:function(a){return e.downloadArchive(t.row.id)}}},[e._v("\n                Download\n              ")])]}}])})],2)],1),e._v(" "),a("el-dialog",{attrs:{title:"Upload Medical Archive",visible:e.uploadFormVisible,width:"640px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.uploadFormVisible=t}}},[a("el-form",{ref:"uploadForm",attrs:{model:e.uploadForm,rules:e.rules,"label-position":"left","label-width":"130px"}},[a("el-form-item",{attrs:{label:"Title",prop:"title"}},[a("el-input",{model:{value:e.uploadForm.title,callback:function(t){e.$set(e.uploadForm,"title",t)},expression:"uploadForm.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Category",prop:"category"}},[a("el-select",{attrs:{placeholder:"Please select category"},model:{value:e.uploadForm.category,callback:function(t){e.$set(e.uploadForm,"category",t)},expression:"uploadForm.category"}},[a("el-option",{attrs:{label:"Orthopaedic",value:"Orthopaedic"}}),e._v(" "),a("el-option",{attrs:{label:"Hepatobiliary surgery",value:"Hepatobiliary surgery"}}),e._v(" "),a("el-option",{attrs:{label:"Cardiovascular Surgery",value:"Cardiovascular Surgery"}}),e._v(" "),a("el-option",{attrs:{label:"Endocrinology",value:"Endocrinology"}}),e._v(" "),a("el-option",{attrs:{label:"Cardiology",value:"Cardiology"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Upload File",prop:"uploadFile"}},[a("el-upload",{ref:"upload",attrs:{action:"",accept:".zip",multiple:!1,"file-list":e.fileList,"show-file-list":!0,"http-request":e.uploadMedicalArchive,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",type:"primary"},slot:"trigger"},[e._v("Browse")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Description",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.uploadForm.desc,callback:function(t){e.$set(e.uploadForm,"desc",t)},expression:"uploadForm.desc"}})],1)],1),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.upload}},[e._v("Submit")]),e._v(" "),a("el-button",{on:{click:e.cancelUpload}},[e._v("Cancel")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var j=a("VU/8")(z,H,!1,function(e){a("bKI1")},"data-v-07f4b36d",null).exports,Y={name:"MedicalCaseSearchMenu",data:()=>({category:[]}),methods:{},created(){}},W={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-aside",{staticClass:"scrollable-div",attrs:{width:"240px"}},[a("el-scrollbar",{ref:"MedicalCaseSearchMenuScrollBar"},[a("el-menu",{attrs:{router:"","default-active":this.$route.path,"default-openeds":["2"]}},[a("el-menu-item",{attrs:{index:"/medicalCaseDeepSearch/uploadMedicalRecords"}},[e._v("Upload Medical Records")]),e._v(" "),3!=this.$store.state.user.type?a("el-menu-item",{attrs:{index:"/medicalCaseDeepSearch/caseSearch"}},[e._v("Medical Case Search")]):e._e(),e._v(" "),3==this.$store.state.user.type?a("el-menu-item",{attrs:{index:"/medicalCaseDeepSearch/caseCluster"}},[e._v("Medical Records Cluster")]):e._e(),e._v(" "),a("el-menu-item",{attrs:{index:"/medicalCaseDeepSearch/SubmitQuestions"}},[e._v("Submit Questions")])],1)],1)],1)},staticRenderFns:[]};var J={name:"MedicalSearch",components:{NavigationBar:v,MedicalSearchMenu:a("VU/8")(Y,W,!1,function(e){a("fwwP")},"data-v-14917789",null).exports}},X={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-container",[t("NavigationBar"),this._v(" "),t("el-container",{staticClass:"parent-div"},[t("MedicalSearchMenu"),this._v(" "),t("keep-alive",[this.$route.meta.keepAlive?t("router-view"):this._e()],1),this._v(" "),this.$route.meta.keepAlive?this._e():t("router-view")],1)],1)],1)},staticRenderFns:[]};var Z=a("VU/8")(J,X,!1,function(e){a("TDYV")},"data-v-51ff653c",null).exports,ee={name:"UploadMedicalRecords",data(){return{uploadForm1:{desc:"Upload medical case By User: "+this.$store.state.user.login_name},uploadForm2:{desc:"Upload medical cases By Manager: "+this.$store.state.user.login_name},cluster_num:{},downloadForm1:{},downloadForm2:{},downloadForm3:{},fileList1:[],fileList2:[]}},methods:{downloadResultImage(){let e=document.createElement("a"),t=this.base64ToBlob();document.createEvent("HTMLEvents").initEvent("click",!0,!0),e.download="cluster result image",e.href=URL.createObjectURL(t),e.click()},exportImg(){return this.$echarts.init(document.getElementById("main")).getDataURL({type:"png",pixelRatio:1,backgroundColor:"#fff"})},base64ToBlob(){let e=this.exportImg().split(";base64,"),t=e[0].split(":")[1],a=window.atob(e[1]),s=a.length,o=new Uint8Array(s);for(let e=0;e<s;++e)o[e]=a.charCodeAt(e);return new Blob([o],{type:t})},myEcharts(e){console.log(e);for(var t=this.$echarts.init(document.getElementById("main")),a=["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],s=0;s<e.length;s++){var o=parseInt(e[s].itemStyle.color.color);e[s].itemStyle.color=a[o]}var i={xAxis:{type:"value"},yAxis:{type:"value"},series:[{symbolSize:13,data:e,type:"scatter"}],tooltip:{trigger:"axis",formatter:function(e){return"id: "+e[0].data.name}}},l=document.getElementById("hight"),n=document.getElementById("weight");t.setOption(i);var r=echarts.config;t.on(r.EVENT.CLICK,function(e){e.value.length>1?(l.innerText=e.value[0]+"cm",n.innerText=e.value[1]+"cm"):(l.innerText=e.name+"cm",n.innerText=e.value+"cm")})},upload(){this.$refs.upload.submit()},uploadCsv(){this.$refs.uploadCsv.submit()},downloadClusterReport(){let e=document.createElement("a");e.style.display="none",e.href=window.location.origin+this.$axios.defaults.baseURL+"/case/download/ClusterReport",document.body.appendChild(e),e.click(),e.remove()},downloadSampleCsvFileForCluster(){let e=document.createElement("a");e.style.display="none",e.href=window.location.origin+this.$axios.defaults.baseURL+"/case/download/SampleCsvFileForCluster",document.body.appendChild(e),e.click(),e.remove()},downloadSampleImageFile(){let e=document.createElement("a");e.style.display="none",e.href=window.location.origin+this.$axios.defaults.baseURL+"/case/download/SampleImageFile",document.body.appendChild(e),e.click(),e.remove()},uploadMedicalArchive(e){var t=new Date,a=t.getUTCFullYear()+("0"+(t.getUTCMonth()+1)).slice(-2)+("0"+t.getUTCDate()).slice(-2)+("0"+t.getUTCHours()).slice(-2)+("0"+t.getUTCMinutes()).slice(-2)+("0"+t.getUTCSeconds()).slice(-2);let s=new FormData;s.append("title","Patient "+this.$store.state.user.id+" Medical Archive "+a),s.append("category","N/A"),s.append("desc",this.uploadForm1.desc),s.append("file",e.file),this.$axios({method:"post",url:"/case/user/"+this.$store.state.user.id,data:s}).then(e=>{this.$refs.uploadForm1.resetFields(),this.$message({type:"success",message:"Successully uploaded medical case!",showClose:!0}),this.$axios({method:"post",url:"/caseSearch/"+e.data.medicalCaseId})}).catch(e=>{this.$message({type:"error",message:"Failed to upload! Check console.",showClose:!0}),console.log(e)})},uploadDataset(e){var t=new Date,a=t.getUTCFullYear()+("0"+(t.getUTCMonth()+1)).slice(-2)+("0"+t.getUTCDate()).slice(-2)+("0"+t.getUTCHours()).slice(-2)+("0"+t.getUTCMinutes()).slice(-2)+("0"+t.getUTCSeconds()).slice(-2);let s=new FormData;s.append("title",this.$store.state.user.id+" Upload History Admissions "+a),s.append("category","N/A"),s.append("file",e.file),s.append("cluster_num",this.uploadForm2.cluster_num),this.$axios({}).then(e=>{this.$refs.uploadForm2.resetFields(),this.$message({type:"success",message:"Successfully Cluster!",showClose:!0}),this.$axios({method:"get",url:"/case/cluster/result"}).then(e=>{this.myEcharts(e.data)}).catch(e=>{console.log(e)})}).catch(e=>{this.$message({type:"error",message:"Failed to upload! Check console.",showClose:!0}),console.log(e)})}},mounted(){this.myEcharts()}},te={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{id:"container",direction:"vertical"}},[3==this.$store.state.user.type?a("el-form",{ref:"downloadForm2",attrs:{model:e.downloadForm2,"label-position":"left","label-width":"170px"}},[a("el-form-item",{attrs:{label:"Sample File Format:"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.downloadSampleCsvFileForCluster}},[e._v("\n                    Download\n                ")])],1)],1):e._e(),e._v(" "),3==this.$store.state.user.type?a("el-form",{ref:"uploadForm2",attrs:{model:e.uploadForm2,"label-position":"left","label-width":"170px"}},[a("el-form-item",{attrs:{label:"Medical Cases Upload:",prop:"uploadFile"}},[a("el-upload",{ref:"uploadCsv",attrs:{action:"",accept:".csv",multiple:!1,"file-list":e.fileList2,"show-file-list":!0,"http-request":e.uploadDataset,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("Browse")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Diagnosis Number:"}},[a("el-input",{staticStyle:{width:"80px","margin-right":"9px"},attrs:{type:"text",oninput:"value=value.replace(/^\\.+|[^\\d.]/g,'')",clearable:""},model:{value:e.uploadForm2.cluster_num,callback:function(t){e.$set(e.uploadForm2,"cluster_num",t)},expression:"uploadForm2.cluster_num"}}),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.uploadCsv}},[e._v("Submit")])],1)],1):e._e(),e._v(" "),a("div",{staticClass:"Echarts"},[a("div",{staticStyle:{width:"600px",height:"400px"},attrs:{id:"main"}}),e._v(" "),3==this.$store.state.user.type?a("el-form",{ref:"downloadForm1",attrs:{model:e.downloadForm1,"label-position":"left","label-width":"170px"}},[a("el-form-item",{attrs:{label:"Report Download:"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.downloadClusterReport}},[e._v("\n                       text\n                    ")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.downloadResultImage}},[e._v("\n                        image\n                    ")])],1)],1):e._e()],1)],1)},staticRenderFns:[]};var ae=a("VU/8")(ee,te,!1,function(e){a("o74x")},"data-v-6484440c",null).exports,se={name:"caseSearch",data:()=>({kgList:[],kgChosen:"",kgData1:{nodes:[],links:[]},kgData2:{nodes:[],links:[]},kgSvgComponents1:{svg:null,simulation:null,colors:[],linkGroup:[],linkTextGroup:[],nodeGroup:[],nodeTextGroup:[]},kgSvgComponents2:{svg:null,simulation:null,colors:[],linkGroup:[],linkTextGroup:[],nodeGroup:[],nodeTextGroup:[]},kgNodeBufferedMap:[],kgNodeUnfoldFlag:[],kgEntityInfo:{id:-1},transform:"",similarCaseHadmIds:[],similarCaseKgIds:[],numOfGraphs:10,note_texts:{notes:[],isHide:[]}}),created(){this.loadKGList()},mounted(){this.initGraph()},watch:{$route:{handler(e){this.loadKGList(),this.removeCurrentKgData1(),this.removeCurrentKgData2(),this.paintGraph1(this.kgData1,this.kgSvgComponents1),this.$refs.similarCases.style.display="none"}}},methods:{onShow:function(e){s.default.set(this.note_texts.isHide,e,!1)},onHide:function(e){s.default.set(this.note_texts.isHide,e,!0)},loadKGList(){this.$axios({method:"get",url:"/kg/user/"+this.$store.state.user.id}).then(e=>{this.kgList.length=0;for(let t in e.data)e.data.hasOwnProperty(t)&&this.kgList.push({value:e.data[t].id,label:e.data[t].name})}).catch(e=>{console.log(e)})},loadKG1(){this.removeCurrentKgData1(),this.removeCurrentKgData2(),this.$axios({method:"get",url:"/kg/medical_case_graph/"+this.kgChosen}).then(e=>{let t=e.data.nodes,a=e.data.links;this.kgData1.nodes=t,this.kgData1.links=a,this.paintGraph1(this.kgData1,this.kgSvgComponents1)}).catch(e=>{console.log(e)}),this.$axios({method:"get",url:"/caseSearch/"+this.kgChosen}).then(e=>{let t=e.data.similar_case_hadmIds,a=e.data.similar_case_kgIds;this.similarCaseKgIds=a.split(","),this.similarCaseHadmIds=t.split(","),this.numOfGraphs=this.similarCaseKgIds.length,this.$refs.similarCases.style.display="block",this.loadKG2(1)}).catch(e=>{console.log(e)})},loadKG2(e){this.$axios({method:"get",url:"/kg/medical_case_graph/"+this.similarCaseKgIds[e-1]}).then(t=>{let a=t.data.nodes,s=t.data.links;this.kgData2.nodes=a,this.kgData2.links=s;for(let e in a)a.hasOwnProperty(e)&&(this.kgNodeBufferedMap[a[e].id]={id:a[e].id,name:a[e].name,childNode:[],relations:[],loadedInGraph:!0});for(let e in s)s.hasOwnProperty(e)&&(this.kgNodeBufferedMap[s[e].source].childNode.push({id:this.kgNodeBufferedMap[s[e].target].id,name:this.kgNodeBufferedMap[s[e].target].name}),this.kgNodeBufferedMap[s[e].source].relations.push(s[e]),this.kgNodeUnfoldFlag[s[e].source]=!1,this.kgNodeUnfoldFlag[s[e].target]=!0);this.paintGraph1(this.kgData2,this.kgSvgComponents2),this.$axios({method:"get",url:"/caseSearch/history_admissions/"+this.similarCaseHadmIds[e-1]}).then(e=>{if(0!=e.data.length){this.note_texts.notes=e.data;for(var t=0;t<e.data.length;t++)this.note_texts.isHide.push(!0)}else this.note_texts.notes=["no doctor notes"],this.note_texts.isHide=[!1]}).catch(e=>{console.log(e)})}).catch(e=>{console.log(e)})},initGraph(){let e=this.$refs.svgDiv1.offsetWidth,t=this.$refs.svgDiv1.offsetHeight;this.kgSvgComponents1.simulation=O.g().force("link",O.e().id(e=>e.id)).force("charge",O.f().strength(100)).force("center",O.c(e/2,t/2)).force("collide",O.d(80).strength(.2).iterations(5)),this.kgSvgComponents2.simulation=O.g().force("link",O.e().id(e=>e.id)).force("charge",O.f().strength(100)).force("center",O.c(e/2,t/2)).force("collide",O.d(80).strength(.2).iterations(5)),this.kgSvgComponents1.colors=["#6ca46c","#4e88af","#ca635f","#d2907c","#d6744d","#cec255","#b4c6e7","#cdb4e6"],this.kgSvgComponents2.colors=this.kgSvgComponents1.colors,this.kgSvgComponents1.svg=O.i("svg").filter(function(e,t){return 0===t}),this.kgSvgComponents2.svg=O.i("svg").filter(function(e,t){return 1===t}),this.kgSvgComponents1.linkGroup=this.kgSvgComponents1.svg.append("g").attr("class","links"),this.kgSvgComponents1.nodeGroup=this.kgSvgComponents1.svg.append("g").attr("class","nodes"),this.kgSvgComponents1.nodeTextGroup=this.kgSvgComponents1.svg.append("g").attr("class","texts"),this.kgSvgComponents2.linkGroup=this.kgSvgComponents2.svg.append("g").attr("class","links"),this.kgSvgComponents2.nodeGroup=this.kgSvgComponents2.svg.append("g").attr("class","nodes"),this.kgSvgComponents2.nodeTextGroup=this.kgSvgComponents2.svg.append("g").attr("class","texts")},paintGraph1(e,t){let a=t.svg,s=t.simulation,o=t.colors;a.selectAll("*").remove();let i=this.$refs.svgDiv1.offsetWidth/2,l=this.$refs.svgDiv1.offsetHeight/2;a.append("circle").attr("cx",30).attr("cy",100).attr("r",7).style("fill",o[0]),a.append("circle").attr("cx",30).attr("cy",130).attr("r",7).style("fill",o[1]),a.append("circle").attr("cx",30).attr("cy",160).attr("r",7).style("fill",o[2]),a.append("text").attr("x",50).attr("y",100).text("Drug").style("font-size","15px").attr("alignment-baseline","middle"),a.append("text").attr("x",50).attr("y",130).text("Diagnosis").style("font-size","15px").attr("alignment-baseline","middle"),a.append("text").attr("x",50).attr("y",160).text("Procedure").style("font-size","15px").attr("alignment-baseline","middle");let n=a.append("g").attr("class","links").selectAll("line").data(e.links).enter().append("line").attr("stroke-width",1).style("stroke","rgba(50, 50, 50, 0.8)"),r=a.append("g").attr("class","nodes").selectAll("circle").data(e.nodes).enter().append("circle").attr("cx",i).attr("cy",l).attr("r",e=>60).attr("fill",e=>"DRUG"==e.type?o[0]:"DIAGNOSIS"==e.type?o[1]:"PROCEDURE"==e.type?o[2]:void 0).style("stroke","rgba(50, 50, 50, 0.8)").style("stroke-width","2px").style("cursor","pointer").call(O.a().on("start",p).on("drag",u).on("end",m)),d=a.append("g").attr("class","texts").selectAll("text").data(e.nodes).enter().append("text").text(e=>"DIAGNOSIS"==e.type?e.short_title:"DRUG"==e.type?e.drug_name:"PROCEDURE"==e.type?e.short_title:void 0).attr("x",i).attr("y",l).attr("text-anchor","middle").attr("fill","rgba(50, 50, 50, 0.8)").style("cursor","pointer").call(O.a().on("start",p).on("drag",u).on("end",m)).call(this.wrap);var c=a.selectAll("tspan");function p(e){O.event.active||s.alphaTarget(.2).restart(),e.fx=e.x,e.fy=e.y}function u(e){e.fx=O.event.x,e.fy=O.event.y}function m(e){O.event.active||s.alphaTarget(0),e.fx=null,e.fy=null}s.nodes(e.nodes).on("tick",function(){n.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),r.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),d.attr("x",function(e){return e.x}).attr("y",function(e){return e.y}),c.attr("x",function(e){return e.x}).attr("y",function(e){return e.y})}),s.force("link").links(e.links),s.alpha(.1).restart(),a.call(O.j().on("zoom",()=>{a.selectAll("g").attr("transform",O.event.transform)})),a.on("dblclick.zoom",null)},paintGraph2(e,t){let a=t.svg,s=t.simulation,o=t.colors;a.selectAll("*").remove();let i=this.$refs.svgDiv1.offsetWidth/2,l=this.$refs.svgDiv1.offsetHeight/2,n=a.append("g").attr("class","links").selectAll("line").data(e.links).enter().append("line").attr("stroke-width",1).style("stroke","rgba(50, 50, 50, 0.8)"),r=O.h("body").select(".tooltip");function d(e){r.html(function(e){let t="";return"patient"==e.type?(t+="patient_id: "+e.patient_id+"\n",t+="gender: "+e.gender+"\n",t+="religion: "+e.religion+"\n",t+="ethnicity: "+e.ethnicity+"\n",t+="birth_time: "+e.birth_time+"\n"):"admission"==e.type?(t+="admission_id: "+e.admission_id+"\n",t+="admit_time: "+e.admit_time+"\n",t+="duration: "+e.duration+"\n",t+="flag: "+e.flag+"\n",t+="admit_age: "+e.admit_age+"\n"):"disease"==e.type?(t+="disease_id: "+e.disease_id+"\n",t+="alias: "+e.alias+"\n"):"drug"==e.type&&(t+="drug_id: "+e.drug_id+"\n",t+="drug_alias: "+e.drug_alias+"\n",t+="dose_val_rx: "+e.dose_val_rx+"\n",t+="dose_unit_rx: "+e.dose_unit_rx+"\n"),t}(e)).style("left",O.event.pageX+"px").style("top",O.event.pageY-.5*r.node().getBoundingClientRect().height+"px")}null==r._groups[0][0]&&(r=O.h("body").append("div").attr("class","tooltip").style("display","none").style("text-align","center").style("border-radius","4px").style("padding","10px 20px").style("width","fit-content").style("position","relative").style("white-space","pre"));let c=a.append("g").attr("class","nodes").selectAll("circle").data(e.nodes).enter().append("circle").attr("cx",i).attr("cy",l).attr("r",e=>60).attr("fill",e=>"DRUG"==e.type?o[0]:"PROCEDURE"==e.type?o[1]:"DIAGNOSIS"==e.type?o[2]:void 0).style("stroke","rgba(50, 50, 50, 0.8)").style("stroke-width","2px").style("cursor","pointer").call(O.a().on("start",m).on("drag",h).on("end",g)).on("mouseover",function(e,t){r.style("display","block").style("color","rgb(20, 20, 20)").style("background-color","rgba(240, 240, 240, 0.95)").style("border","1px solid rgba(240, 240, 240, 0.95)").style("box-shadow","2px 2px 2px rgba(80, 80, 80, 0.6)"),d(e)}).on("mousemove",function(e,t){d(e)}).on("mouseout",function(e,t){r.style("display","none")});c.on("click",e=>{this.expand(e.id)});let p=a.append("g").attr("class","texts").selectAll("text").data(e.nodes).enter().append("text").text(e=>"patient"==e.type?"patient "+e.patient_id:"admission"==e.type?"admission "+e.admission_id:"disease"==e.type?e.alias:"drug"==e.type?e.drug_alias:void 0).attr("x",i).attr("y",l).attr("text-anchor","middle").attr("fill","rgba(50, 50, 50, 0.8)").style("cursor","pointer").call(O.a().on("start",m).on("drag",h).on("end",g)).on("mouseover",function(e,t){r.style("display","block").style("color","rgb(20, 20, 20)").style("background-color","rgba(240, 240, 240, 0.95)").style("border","1px solid rgba(240, 240, 240, 0.95)").style("box-shadow","2px 2px 2px rgba(80, 80, 80, 0.6)"),d(e)}).on("mousemove",function(e,t){d(e)}).on("mouseout",function(e,t){r.style("display","none")}).call(this.wrap);p.on("click",e=>{this.expand(e.id)});var u=a.selectAll("tspan");function m(e){O.event.active||s.alphaTarget(.2).restart(),e.fx=e.x,e.fy=e.y}function h(e){e.fx=O.event.x,e.fy=O.event.y}function g(e){O.event.active||s.alphaTarget(0),e.fx=null,e.fy=null}a.selectAll("g").attr("transform",this.transform),s.nodes(e.nodes).on("tick",function(){n.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),c.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),p.attr("x",function(e){return e.x}).attr("y",function(e){return e.y}),u.attr("x",function(e){return e.x}).attr("y",function(e){return e.y})}),s.force("link").links(e.links),s.alpha(.1).restart(),a.call(O.j().on("zoom",()=>{a.selectAll("g").attr("transform",O.event.transform),this.transform=O.event.transform})),a.on("dblclick.zoom",null)},wrap(e){e.each(function(){for(var e,t=O.h(this),a=t.text().split(/\s+|\*|-/).reverse(),s=t.attr("x"),o=t.attr("y"),i=5,l=[],n=[],r=0;e=a.pop();)n.push(e),n.join(" ").length>9&&(1==n.length?(l.push(n.join(" ")),n.pop()):(n.pop(),l.push(n.join(" ")),n=[e]));0!=n.length&&l.push(n.join(" ")),t.text(null),i+=18*(1-l.length)*.5;for(let e=0;e<l.length;e++){const a=l[e];t.append("tspan").attr("x",s).attr("y",o).attr("dy",18*r+++i).text(a)}})},expand(e){this.kgEntityInfo.id=e;let t=this.kgNodeBufferedMap[e].childNode;null!=t&&(0===t.length?this.getRelNodes(e):this.kgNodeUnfoldFlag[this.kgEntityInfo.id]&&this.unfoldRelNodes())},getRelNodes(e){0===this.kgNodeBufferedMap[e].childNode.length&&this.$axios({method:"get",url:"/kg/graph/relNodes/"+e}).then(t=>{let a=t.data.nodes,s=t.data.links;this.kgNodeBufferedMap[e].childNode=a,this.kgNodeBufferedMap[e].relations=s;for(let e in a)a.hasOwnProperty(e)&&null==this.kgNodeBufferedMap[a[e].id]&&(this.kgNodeBufferedMap[a[e].id]={id:a[e].id,name:a[e].name,childNode:[],relations:[],loadedInGraph:!1},this.kgNodeUnfoldFlag[a[e].id]=!0);this.kgNodeUnfoldFlag[this.kgEntityInfo.id]&&this.unfoldRelNodes()}).catch(e=>{console.log(e)})},unfoldRelNodes(){let e=this.kgNodeBufferedMap[this.kgEntityInfo.id].childNode;for(let t in e)if(e.hasOwnProperty(t)){let a=e[t];this.kgNodeBufferedMap[a.id].loadedInGraph||(this.kgData2.nodes.push(a),this.kgNodeBufferedMap[a.id].loadedInGraph=!0)}let t=this.kgData2.links.concat(this.kgNodeBufferedMap[this.kgEntityInfo.id].relations),a=new Set(t);this.kgData2.links=Array.from(a),this.paintGraph2(this.kgData2,this.kgSvgComponents2),this.kgNodeUnfoldFlag[this.kgEntityInfo.id]=!1},removeCurrentKgData1(){this.kgData1.nodes.length=0,this.kgData1.links.length=0},removeCurrentKgData2(){this.kgNodeBufferedMap.length=0,this.kgNodeUnfoldFlag.length=0,this.kgData2.nodes.length=0,this.kgData2.links.length=0,this.kgEntityInfo.id=-1},handleCurrentChange(e){this.loadKG2(e)}}},oe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"patientCase"},[a("h3",{staticStyle:{float:"left","margin-right":"10px","margin-top":"4px"}},[e._v("Select Your Case: ")]),e._v(" "),a("div",{staticClass:"option-block"},[a("el-select",{staticStyle:{width:"350px"},attrs:{placeholder:"Choose a knowledge graph"},on:{change:e.loadKG1},model:{value:e.kgChosen,callback:function(t){e.kgChosen=t},expression:"kgChosen"}},e._l(e.kgList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("div",{staticClass:"kg-div"},[a("div",{ref:"svgDiv1",staticClass:"svg-div"},[a("svg",{attrs:{id:"kg1",width:"100%",height:"100%"}})])])]),e._v(" "),a("div",{ref:"similarCases",staticClass:"similarCases"},[a("h3",{staticStyle:{"margin-top":"4px","margin-bottom":"1px"}},[e._v("Similar Cases:")]),e._v(" "),a("div",{staticClass:"page-nav"},[a("el-pagination",{attrs:{"page-size":1,layout:"prev, pager, next",total:e.numOfGraphs},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("div",{staticClass:"kg-div"},[a("div",{ref:"svgDiv2",staticClass:"svg-div"},[a("svg",{attrs:{id:"kg2",width:"100%",height:"100%"}})])]),e._v(" "),a("div",{staticClass:"diagnosis",staticStyle:{"margin-top":"10px",width:"90%","text-align":"left","font-size":"16px"}},[a("span",{staticStyle:{"font-weight":"bold"}},[e._v("NOTEEVENTS：")]),e._v(" "),e._l(e.note_texts.notes,function(t,s){return a("div",{key:s},[e.note_texts.isHide[s]?[a("div",{staticClass:"hideBg"},[a("pre",[a("p",{staticClass:"summary"},[e._v(" "+e._s(t))])]),e._v(" "),a("div",{staticClass:"showBtn"},[a("a",{attrs:{href:"#"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.onShow(s)}}},[a("span",{staticClass:"downArrow"})])])])]:[a("div",{staticClass:"showBg"},[a("pre",[e._v(" "),a("p",[e._v(e._s(t))])]),e._v(" "),a("div",{staticClass:"hideBtn"},[a("a",{attrs:{href:"#"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.onHide(s)}}},[a("span",{staticClass:"upArrow"})])])])]],2)})],2)])])},staticRenderFns:[]};var ie=a("VU/8")(se,oe,!1,function(e){a("GEJk")},"data-v-3f731efa",null).exports,le={name:"SubmitQuestions",data:()=>({submitQuestionForm:{questionDesc:""}}),methods:{submitQuestion(){this.$axios({method:"put",url:"/patient",data:{content:this.submitQuestionForm.questionDesc,hospitalDepartmentId:2,type:1,userid:this.$store.state.user.id,remark:""}}).then(e=>{this.$message({type:"success",message:"Add Question successfully! "}),this.$refs.submitQuestionForm.resetFields(),window.location.href="#/QA/questions"}).catch(e=>{console.log(e),alert("ERROR! Check Console plz! ")})}},created(){},mounted(){}},ne={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{id:"container",direction:"vertical"}},[a("div",{staticClass:"note"},[a("strong",[e._v("Note:")]),a("div",[e._v("Please submit a simple yes or no question. You also can contact the doctors using "),a("a",{attrs:{href:"#/consult"}},[e._v("Online system")]),e._v(".")])]),e._v(" "),a("div",{staticClass:"form"},[a("el-form",{ref:"submitQuestionForm",attrs:{model:e.submitQuestionForm,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"Description:",prop:"questionDesc"}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.submitQuestionForm.questionDesc,callback:function(t){e.$set(e.submitQuestionForm,"questionDesc",t)},expression:"submitQuestionForm.questionDesc"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"button"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitQuestion}},[e._v("Submit")])],1)])},staticRenderFns:[]};var re=a("VU/8")(le,ne,!1,function(e){a("BS75")},"data-v-48c5fa3e",null).exports,de={name:"UploadMedicalRecords",data(){return{uploadForm1:{desc:"Upload medical case By User: "+this.$store.state.user.login_name},uploadForm2:{desc:"Upload medical cases By Manager: "+this.$store.state.user.login_name},downloadForm1:{},downloadForm2:{},downloadForm3:{},fileList1:[],fileList2:[]}},methods:{upload(){this.$refs.upload.submit()},uploadCsv(){this.$refs.uploadCsv.submit()},downloadSampleCsvFile(){let e=document.createElement("a");e.style.display="none",e.href=window.location.origin+this.$axios.defaults.baseURL+"/case/download/SampleCsvFile",document.body.appendChild(e),e.click(),e.remove()},downloadSampleImageFile(){let e=document.createElement("a");e.style.display="none",e.href=window.location.origin+this.$axios.defaults.baseURL+"/case/download/SampleImageFile",document.body.appendChild(e),e.click(),e.remove()},uploadMedicalArchive(e){var t=new Date,a=t.getUTCFullYear()+("0"+(t.getUTCMonth()+1)).slice(-2)+("0"+t.getUTCDate()).slice(-2)+("0"+t.getUTCHours()).slice(-2)+("0"+t.getUTCMinutes()).slice(-2)+("0"+t.getUTCSeconds()).slice(-2);let s=new FormData;s.append("title","Patient "+this.$store.state.user.id+" Medical Archive "+a),s.append("category","N/A"),s.append("desc",this.uploadForm1.desc),s.append("file",e.file),this.$axios({method:"post",url:"/case/user/"+this.$store.state.user.id,data:s}).then(e=>{this.$refs.uploadForm1.resetFields(),this.$message({type:"success",message:"Successully uploaded medical case!",showClose:!0}),this.$axios({method:"post",url:"/caseSearch/"+e.data.medicalCaseId})}).catch(e=>{this.$message({type:"error",message:"Failed to upload! Check console.",showClose:!0}),console.log(e)})},uploadHistoryAdmissions(e){var t=new Date,a=t.getUTCFullYear()+("0"+(t.getUTCMonth()+1)).slice(-2)+("0"+t.getUTCDate()).slice(-2)+("0"+t.getUTCHours()).slice(-2)+("0"+t.getUTCMinutes()).slice(-2)+("0"+t.getUTCSeconds()).slice(-2);let s=new FormData;s.append("title",this.$store.state.user.id+" Upload History Admissions "+a),s.append("category","N/A"),s.append("desc",this.uploadForm2.desc),s.append("file",e.file),this.$axios({method:"post",url:"/case/history_admissions/"+this.$store.state.user.id,data:s}).then(e=>{this.$refs.uploadForm2.resetFields(),this.$message({type:"success",message:"Successully uploaded history admissions!",showClose:!0})}).catch(e=>{this.$message({type:"error",message:"Failed to upload! Check console.",showClose:!0}),console.log(e)})}}},ce={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{id:"container",direction:"vertical"}},[3!=this.$store.state.user.type?a("el-form",{ref:"downloadForm3",attrs:{model:e.downloadForm3,"label-position":"left","label-width":"110px"}},[a("el-form-item",{attrs:{label:"File Format:"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.downloadSampleImageFile}},[e._v("\n                Download\n            ")])],1)],1):e._e(),e._v(" "),3!=this.$store.state.user.type?a("el-form",{ref:"uploadForm1",attrs:{model:e.uploadForm1,"label-position":"left","label-width":"110px"}},[a("el-form-item",{attrs:{label:"File Upload:",prop:"uploadFile"}},[a("el-upload",{ref:"upload",attrs:{action:"",accept:".zip",multiple:!1,"file-list":e.fileList1,"show-file-list":!0,"http-request":e.uploadMedicalArchive,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("Browse")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Description:",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.uploadForm1.desc,callback:function(t){e.$set(e.uploadForm1,"desc",t)},expression:"uploadForm1.desc"}})],1)],1):e._e(),e._v(" "),3!=this.$store.state.user.type?a("div",{attrs:{id:"footer1"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.upload}},[e._v("Submit")])],1):e._e(),e._v(" "),3==this.$store.state.user.type?a("el-form",{ref:"downloadForm2",attrs:{model:e.downloadForm2,"label-position":"left","label-width":"170px"}},[a("el-form-item",{attrs:{label:"Sample File Format:"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.downloadSampleCsvFile}},[e._v("\n        Download\n    ")])],1)],1):e._e(),e._v(" "),3==this.$store.state.user.type?a("el-form",{ref:"uploadForm2",attrs:{model:e.uploadForm2,"label-position":"left","label-width":"170px"}},[a("el-form-item",{attrs:{label:"Medical Cases Upload:",prop:"uploadFile"}},[a("el-upload",{ref:"uploadCsv",attrs:{action:"",accept:".csv",multiple:!1,"file-list":e.fileList2,"show-file-list":!0,"http-request":e.uploadHistoryAdmissions,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("Browse")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Description:",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.uploadForm2.desc,callback:function(t){e.$set(e.uploadForm2,"desc",t)},expression:"uploadForm2.desc"}})],1)],1):e._e(),e._v(" "),3==this.$store.state.user.type?a("div",{attrs:{id:"footer2"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.uploadCsv}},[e._v("Submit")])],1):e._e()],1)},staticRenderFns:[]};var pe=a("VU/8")(de,ce,!1,function(e){a("oDKw")},"data-v-a9b80e3e",null).exports,ue={name:"AutoDiagnosisMenu",data:()=>({category:[]}),methods:{},created(){}},me={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-aside",{staticClass:"scrollable-div",attrs:{width:"240px"}},[t("el-scrollbar",{ref:"AutoDiagnosisMenuScrollBar"},[t("el-menu",{attrs:{router:"","default-active":this.$route.path,"default-openeds":["2"]}},[t("el-menu-item",{attrs:{index:"/autoDiagnosis/uploadMedicalRecords"}},[this._v("Upload Medical Records")]),this._v(" "),t("el-menu-item",{attrs:{index:"/autoDiagnosis/machineDiagnosis"}},[this._v("Machine Diagnosis")]),this._v(" "),t("el-menu-item",{attrs:{index:"/autoDiagnosis/submitQuestions"}},[this._v("Submit Questions")])],1)],1)],1)},staticRenderFns:[]};var he={name:"AutoDiagnosis",components:{NavigationBar:v,AutoDiagnosisMenu:a("VU/8")(ue,me,!1,function(e){a("GR5o")},"data-v-61c1da04",null).exports}},ge={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-container",[t("NavigationBar"),this._v(" "),t("el-container",{staticClass:"parent-div"},[t("AutoDiagnosisMenu"),this._v(" "),t("keep-alive",[this.$route.meta.keepAlive?t("router-view"):this._e()],1),this._v(" "),this.$route.meta.keepAlive?this._e():t("router-view")],1)],1)],1)},staticRenderFns:[]};var ve=a("VU/8")(he,ge,!1,function(e){a("Q5AK")},"data-v-74a5f860",null).exports,fe={name:"autoDiagnosis",components:{NavigationBar:v},data:()=>({}),methods:{magic(){this.$axios({method:"post",url:"/kg/createGraph"}).then(e=>{}).catch(e=>{console.log(e)})}}},be={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-container",[t("NavigationBar"),this._v(" "),t("el-container",{attrs:{id:"container",direction:"vertical"}},[t("el-button",{attrs:{size:"small",type:"primary",id:"magic"},on:{click:this.magic}},[this._v("magic button")])],1)],1)],1)},staticRenderFns:[]};var ye=a("VU/8")(fe,be,!1,function(e){a("CrTx")},"data-v-504a0fc0",null).exports,ke={name:"UploadMedicalRecords",data:()=>({uploadForm:{desc:""},fileList:[]}),methods:{upload(){this.$refs.upload.submit()},uploadMedicalArchive(e){var t=new Date,a=t.getUTCFullYear()+("0"+(t.getUTCMonth()+1)).slice(-2)+("0"+t.getUTCDate()).slice(-2)+("0"+t.getUTCHours()).slice(-2)+("0"+t.getUTCMinutes()).slice(-2)+("0"+t.getUTCSeconds()).slice(-2);let s=new FormData;s.append("title","Patient "+this.$store.state.user.id+" Medical Archive "+a),s.append("category","N/A"),s.append("desc",this.uploadForm.desc),s.append("file",e.file),this.$axios({method:"post",url:"/archive/user/"+this.$store.state.user.id,data:s}).then(e=>{this.$refs.uploadForm.resetFields(),this.$message({type:"success",message:"Successully uploaded medical archive!",showClose:!0}),this.$axios({method:"post",url:"/diagnosis/"+e.data.medicalArchiveId})}).catch(e=>{this.$message({type:"error",message:"Failed to upload! Check console.",showClose:!0}),console.log(e)})}}},_e={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{id:"container",direction:"vertical"}},[a("el-form",{ref:"uploadForm",attrs:{model:e.uploadForm,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"File Upload:",prop:"uploadFile"}},[a("el-upload",{ref:"upload",attrs:{action:"",accept:".zip",multiple:!1,"file-list":e.fileList,"show-file-list":!0,"http-request":e.uploadMedicalArchive,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("Browse")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Description:",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.uploadForm.desc,callback:function(t){e.$set(e.uploadForm,"desc",t)},expression:"uploadForm.desc"}})],1)],1),e._v(" "),a("div",{attrs:{id:"footer"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.upload}},[e._v("Submit")])],1)],1)},staticRenderFns:[]};var we=a("VU/8")(ke,_e,!1,function(e){a("sRQ2")},"data-v-0bfa362c",null).exports,xe={name:"machineDiagnosis",data:()=>({kgList:[],kgChosen:"",kgData1:{nodes:[],links:[]},kgData2:{nodes:[],links:[]},kgSvgComponents1:{svg:null,simulation:null,colors:[],linkGroup:[],linkTextGroup:[],nodeGroup:[],nodeTextGroup:[]},kgSvgComponents2:{svg:null,simulation:null,colors:[],linkGroup:[],linkTextGroup:[],nodeGroup:[],nodeTextGroup:[]},kgNodeBufferedMap:[],kgNodeUnfoldFlag:[],kgEntityInfo:{id:-1},transform:"",similarGraphAdmissionIds:[],numOfGraphs:10,diagnosis:""}),created(){this.loadKGList()},mounted(){this.initGraph()},watch:{$route:{handler(e){this.loadKGList(),this.removeCurrentKgData1(),this.removeCurrentKgData2(),this.paintGraph1(this.kgData1,this.kgSvgComponents1),this.$refs.similarCases.style.display="none"}}},methods:{loadKGList(){this.$axios({method:"get",url:"/kg/user/"+this.$store.state.user.id}).then(e=>{this.kgList.length=0;for(let t in e.data)e.data.hasOwnProperty(t)&&this.kgList.push({value:e.data[t].id,label:e.data[t].name})}).catch(e=>{console.log(e)})},loadKG1(){this.removeCurrentKgData1(),this.removeCurrentKgData2(),this.$axios({method:"get",url:"/kg/graph/"+this.kgChosen}).then(e=>{let t=e.data.nodes,a=e.data.links;this.kgData1.nodes=t,this.kgData1.links=a,this.paintGraph1(this.kgData1,this.kgSvgComponents1)}).catch(e=>{console.log(e)}),this.$axios({method:"get",url:"/diagnosis/"+this.kgChosen}).then(e=>{this.similarGraphAdmissionIds=e.data,this.numOfGraphs=e.data.length,0!=e.data.length?(this.$refs.similarCases.style.display="block",this.loadKG2(1)):this.$refs.similarCases.style.display="none"}).catch(e=>{console.log(e)})},loadKG2(e){this.$axios({method:"get",url:"/kg/node/"+this.similarGraphAdmissionIds[e-1]}).then(e=>{let t=e.data.nodes,a=e.data.links;this.kgData2.nodes=t,this.kgData2.links=a;for(let e in t)t.hasOwnProperty(e)&&(this.kgNodeBufferedMap[t[e].id]={id:t[e].id,name:t[e].name,childNode:[],relations:[],loadedInGraph:!0});for(let e in a)a.hasOwnProperty(e)&&(this.kgNodeBufferedMap[a[e].source].childNode.push({id:this.kgNodeBufferedMap[a[e].target].id,name:this.kgNodeBufferedMap[a[e].target].name}),this.kgNodeBufferedMap[a[e].source].relations.push(a[e]),this.kgNodeUnfoldFlag[a[e].source]=!1,this.kgNodeUnfoldFlag[a[e].target]=!0);this.paintGraph2(this.kgData2,this.kgSvgComponents2);var s="";t.forEach(e=>{"admission"==e.type&&(s=e.admission_id.substring(2,e.admission_id.length))}),this.$axios({method:"get",url:"/diagnosis/admission/"+s}).then(e=>{""!=e.data?this.diagnosis=e.data:this.diagnosis="Doctor's diagnosis missing"}).catch(e=>{console.log(e)})}).catch(e=>{console.log(e)})},initGraph(){let e=this.$refs.svgDiv1.offsetWidth,t=this.$refs.svgDiv1.offsetHeight;this.kgSvgComponents1.simulation=O.g().force("link",O.e().id(e=>e.id)).force("charge",O.f().strength(100)).force("center",O.c(e/2,t/2)).force("collide",O.d(80).strength(.2).iterations(5)),this.kgSvgComponents2.simulation=O.g().force("link",O.e().id(e=>e.id)).force("charge",O.f().strength(100)).force("center",O.c(e/2,t/2)).force("collide",O.d(80).strength(.2).iterations(5)),this.kgSvgComponents1.colors=["#6ca46c","#4e88af","#ca635f","#d2907c","#d6744d","#cec255","#b4c6e7","#cdb4e6"],this.kgSvgComponents2.colors=this.kgSvgComponents1.colors,this.kgSvgComponents1.svg=O.i("svg").filter(function(e,t){return 0===t}),this.kgSvgComponents2.svg=O.i("svg").filter(function(e,t){return 1===t}),this.kgSvgComponents1.linkGroup=this.kgSvgComponents1.svg.append("g").attr("class","links"),this.kgSvgComponents1.nodeGroup=this.kgSvgComponents1.svg.append("g").attr("class","nodes"),this.kgSvgComponents1.nodeTextGroup=this.kgSvgComponents1.svg.append("g").attr("class","texts"),this.kgSvgComponents2.linkGroup=this.kgSvgComponents2.svg.append("g").attr("class","links"),this.kgSvgComponents2.nodeGroup=this.kgSvgComponents2.svg.append("g").attr("class","nodes"),this.kgSvgComponents2.nodeTextGroup=this.kgSvgComponents2.svg.append("g").attr("class","texts")},paintGraph1(e,t){let a=t.svg,s=t.simulation,o=t.colors;a.selectAll("*").remove();let i=this.$refs.svgDiv1.offsetWidth/2,l=this.$refs.svgDiv1.offsetHeight/2,n=a.append("g").attr("class","links").selectAll("line").data(e.links).enter().append("line").attr("stroke-width",1).style("stroke","rgba(50, 50, 50, 0.8)"),r=a.append("g").attr("class","nodes").selectAll("circle").data(e.nodes).enter().append("circle").attr("cx",i).attr("cy",l).attr("r",e=>50).attr("fill",e=>"patient"==e.type?o[0]:"admission"==e.type?o[1]:"disease"==e.type?o[2]:"drug"==e.type?o[5]:void 0).style("stroke","rgba(50, 50, 50, 0.8)").style("stroke-width","2px").style("cursor","pointer").call(O.a().on("start",p).on("drag",u).on("end",m)),d=a.append("g").attr("class","texts").selectAll("text").data(e.nodes).enter().append("text").text(e=>"patient"==e.type?"patient "+e.patient_id:"admission"==e.type?"admission "+e.admission_id:"disease"==e.type?e.alias:"drug"==e.type?e.drug_alias:void 0).attr("x",i).attr("y",l).attr("text-anchor","middle").attr("fill","rgba(50, 50, 50, 0.8)").style("cursor","pointer").call(O.a().on("start",p).on("drag",u).on("end",m)).call(this.wrap);var c=a.selectAll("tspan");function p(e){O.event.active||s.alphaTarget(.2).restart(),e.fx=e.x,e.fy=e.y}function u(e){e.fx=O.event.x,e.fy=O.event.y}function m(e){O.event.active||s.alphaTarget(0),e.fx=null,e.fy=null}s.nodes(e.nodes).on("tick",function(){n.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),r.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),d.attr("x",function(e){return e.x}).attr("y",function(e){return e.y}),c.attr("x",function(e){return e.x}).attr("y",function(e){return e.y})}),s.force("link").links(e.links),s.alpha(.1).restart(),a.call(O.j().on("zoom",()=>{a.selectAll("g").attr("transform",O.event.transform)})),a.on("dblclick.zoom",null)},paintGraph2(e,t){let a=t.svg,s=t.simulation,o=t.colors;a.selectAll("*").remove();let i=this.$refs.svgDiv1.offsetWidth/2,l=this.$refs.svgDiv1.offsetHeight/2,n=a.append("g").attr("class","links").selectAll("line").data(e.links).enter().append("line").attr("stroke-width",1).style("stroke","rgba(50, 50, 50, 0.8)"),r=O.h("body").select(".tooltip");function d(e){r.html(function(e){let t="";return"patient"==e.type?(t+="patient_id: "+e.patient_id+"\n",t+="gender: "+e.gender+"\n",t+="religion: "+e.religion+"\n",t+="ethnicity: "+e.ethnicity+"\n",t+="birth_time: "+e.birth_time+"\n"):"admission"==e.type?(t+="admission_id: "+e.admission_id+"\n",t+="admit_time: "+e.admit_time+"\n",t+="duration: "+e.duration+"\n",t+="flag: "+e.flag+"\n",t+="admit_age: "+e.admit_age+"\n"):"disease"==e.type?(t+="disease_id: "+e.disease_id+"\n",t+="alias: "+e.alias+"\n"):"drug"==e.type&&(t+="drug_id: "+e.drug_id+"\n",t+="drug_alias: "+e.drug_alias+"\n",t+="dose_val_rx: "+e.dose_val_rx+"\n",t+="dose_unit_rx: "+e.dose_unit_rx+"\n"),t}(e)).style("left",O.event.pageX+"px").style("top",O.event.pageY-.5*r.node().getBoundingClientRect().height+"px")}null==r._groups[0][0]&&(r=O.h("body").append("div").attr("class","tooltip").style("display","none").style("text-align","center").style("border-radius","4px").style("padding","10px 20px").style("width","fit-content").style("position","relative").style("white-space","pre"));let c=a.append("g").attr("class","nodes").selectAll("circle").data(e.nodes).enter().append("circle").attr("cx",i).attr("cy",l).attr("r",e=>50).attr("fill",e=>"patient"==e.type?o[0]:"admission"==e.type?o[1]:"disease"==e.type?o[2]:"drug"==e.type?o[5]:void 0).style("stroke","rgba(50, 50, 50, 0.8)").style("stroke-width","2px").style("cursor","pointer").call(O.a().on("start",m).on("drag",h).on("end",g)).on("mouseover",function(e,t){r.style("display","block").style("color","rgb(20, 20, 20)").style("background-color","rgba(240, 240, 240, 0.95)").style("border","1px solid rgba(240, 240, 240, 0.95)").style("box-shadow","2px 2px 2px rgba(80, 80, 80, 0.6)"),d(e)}).on("mousemove",function(e,t){d(e)}).on("mouseout",function(e,t){r.style("display","none")});c.on("click",e=>{this.expand(e.id)});let p=a.append("g").attr("class","texts").selectAll("text").data(e.nodes).enter().append("text").text(e=>"patient"==e.type?"patient "+e.patient_id:"admission"==e.type?"admission "+e.admission_id:"disease"==e.type?e.alias:"drug"==e.type?e.drug_alias:void 0).attr("x",i).attr("y",l).attr("text-anchor","middle").attr("fill","rgba(50, 50, 50, 0.8)").style("cursor","pointer").call(O.a().on("start",m).on("drag",h).on("end",g)).on("mouseover",function(e,t){r.style("display","block").style("color","rgb(20, 20, 20)").style("background-color","rgba(240, 240, 240, 0.95)").style("border","1px solid rgba(240, 240, 240, 0.95)").style("box-shadow","2px 2px 2px rgba(80, 80, 80, 0.6)"),d(e)}).on("mousemove",function(e,t){d(e)}).on("mouseout",function(e,t){r.style("display","none")}).call(this.wrap);p.on("click",e=>{this.expand(e.id)});var u=a.selectAll("tspan");function m(e){O.event.active||s.alphaTarget(.2).restart(),e.fx=e.x,e.fy=e.y}function h(e){e.fx=O.event.x,e.fy=O.event.y}function g(e){O.event.active||s.alphaTarget(0),e.fx=null,e.fy=null}a.selectAll("g").attr("transform",this.transform),s.nodes(e.nodes).on("tick",function(){n.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),c.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),p.attr("x",function(e){return e.x}).attr("y",function(e){return e.y}),u.attr("x",function(e){return e.x}).attr("y",function(e){return e.y})}),s.force("link").links(e.links),s.alpha(.1).restart(),a.call(O.j().on("zoom",()=>{a.selectAll("g").attr("transform",O.event.transform),this.transform=O.event.transform})),a.on("dblclick.zoom",null)},wrap(e){e.each(function(){for(var e,t=O.h(this),a=t.text().split(/\s+|\*|-/).reverse(),s=t.attr("x"),o=t.attr("y"),i=5,l=[],n=[],r=0;e=a.pop();)n.push(e),n.join(" ").length>9&&(1==n.length?(l.push(n.join(" ")),n.pop()):(n.pop(),l.push(n.join(" ")),n=[e]));0!=n.length&&l.push(n.join(" ")),t.text(null),i+=18*(1-l.length)*.5;for(let e=0;e<l.length;e++){const a=l[e];t.append("tspan").attr("x",s).attr("y",o).attr("dy",18*r+++i).text(a)}})},expand(e){this.kgEntityInfo.id=e;let t=this.kgNodeBufferedMap[e].childNode;null!=t&&(0===t.length?this.getRelNodes(e):this.kgNodeUnfoldFlag[this.kgEntityInfo.id]&&this.unfoldRelNodes())},getRelNodes(e){0===this.kgNodeBufferedMap[e].childNode.length&&this.$axios({method:"get",url:"/kg/graph/relNodes/"+e}).then(t=>{let a=t.data.nodes,s=t.data.links;this.kgNodeBufferedMap[e].childNode=a,this.kgNodeBufferedMap[e].relations=s;for(let e in a)a.hasOwnProperty(e)&&null==this.kgNodeBufferedMap[a[e].id]&&(this.kgNodeBufferedMap[a[e].id]={id:a[e].id,name:a[e].name,childNode:[],relations:[],loadedInGraph:!1},this.kgNodeUnfoldFlag[a[e].id]=!0);this.kgNodeUnfoldFlag[this.kgEntityInfo.id]&&this.unfoldRelNodes()}).catch(e=>{console.log(e)})},unfoldRelNodes(){let e=this.kgNodeBufferedMap[this.kgEntityInfo.id].childNode;for(let t in e)if(e.hasOwnProperty(t)){let a=e[t];this.kgNodeBufferedMap[a.id].loadedInGraph||(this.kgData2.nodes.push(a),this.kgNodeBufferedMap[a.id].loadedInGraph=!0)}let t=this.kgData2.links.concat(this.kgNodeBufferedMap[this.kgEntityInfo.id].relations),a=new Set(t);this.kgData2.links=Array.from(a),this.paintGraph2(this.kgData2,this.kgSvgComponents2),this.kgNodeUnfoldFlag[this.kgEntityInfo.id]=!1},removeCurrentKgData1(){this.kgData1.nodes.length=0,this.kgData1.links.length=0},removeCurrentKgData2(){this.kgNodeBufferedMap.length=0,this.kgNodeUnfoldFlag.length=0,this.kgData2.nodes.length=0,this.kgData2.links.length=0,this.kgEntityInfo.id=-1},handleCurrentChange(e){this.loadKG2(e)}}},Fe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"patientCase"},[a("h3",[e._v("Select Your Case:")]),e._v(" "),a("div",{staticClass:"option-block"},[a("el-select",{attrs:{placeholder:"Choose a knowledge graph"},on:{change:e.loadKG1},model:{value:e.kgChosen,callback:function(t){e.kgChosen=t},expression:"kgChosen"}},e._l(e.kgList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("div",{staticClass:"kg-div"},[a("div",{ref:"svgDiv1",staticClass:"svg-div"},[a("svg",{attrs:{width:"100%",height:"100%"}})])])]),e._v(" "),a("div",{ref:"similarCases",staticClass:"similarCases"},[a("h3",[e._v("Similar Cases:")]),e._v(" "),a("div",{staticClass:"kg-div"},[a("div",{ref:"svgDiv2",staticClass:"svg-div"},[a("svg",{attrs:{width:"100%",height:"100%"}})])]),e._v(" "),a("div",{staticClass:"diagnosis",staticStyle:{"margin-right":"auto","margin-left":"auto","margin-top":"10px",width:"750px","text-align":"left","font-size":"16px"}},[a("span",{staticStyle:{"font-weight":"bold"}},[e._v("Diagnosis：")]),e._v("\n            "+e._s(e.diagnosis)+"\n        ")]),e._v(" "),a("div",{staticClass:"page-nav"},[a("el-pagination",{attrs:{"page-size":1,layout:"prev, pager, next",total:e.numOfGraphs},on:{"current-change":e.handleCurrentChange}})],1)])])},staticRenderFns:[]};var Ce=a("VU/8")(xe,Fe,!1,function(e){a("XTzr")},"data-v-103945c2",null).exports,De={name:"SubmitQuestions",data:()=>({submitQuestionForm:{questionDesc:""}}),methods:{submitQuestion(){this.$axios({method:"put",url:"/patient",data:{content:this.submitQuestionForm.questionDesc,hospitalDepartmentId:2,type:1,userid:this.$store.state.user.id,remark:""}}).then(e=>{this.$message({type:"success",message:"Add Question successfully! "}),this.$refs.submitQuestionForm.resetFields(),window.location.href="#/QA/questions"}).catch(e=>{console.log(e),alert("ERROR! Check Console plz! ")})}},created(){},mounted(){}},Te={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{id:"container",direction:"vertical"}},[a("div",{staticClass:"note"},[a("strong",[e._v("Note:")]),a("div",[e._v("Please submit a simple yes or no question. You also can contact the doctors using "),a("a",{attrs:{href:"#/consult"}},[e._v("Online system")]),e._v(".")])]),e._v(" "),a("div",{staticClass:"form"},[a("el-form",{ref:"submitQuestionForm",attrs:{model:e.submitQuestionForm,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"Description:",prop:"questionDesc"}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.submitQuestionForm.questionDesc,callback:function(t){e.$set(e.submitQuestionForm,"questionDesc",t)},expression:"submitQuestionForm.questionDesc"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"button"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitQuestion}},[e._v("Submit")])],1)])},staticRenderFns:[]};var Se=a("VU/8")(De,Te,!1,function(e){a("+LGA")},"data-v-4ce98b25",null).exports,$e={name:"QA",components:{NavigationBar:v}},Ee={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-container",[t("NavigationBar"),this._v(" "),t("el-container",{staticClass:"parent-div"},[t("keep-alive",[this.$route.meta.keepAlive?t("router-view"):this._e()],1),this._v(" "),this.$route.meta.keepAlive?this._e():t("router-view")],1)],1)],1)},staticRenderFns:[]};var Ie=a("VU/8")($e,Ee,!1,function(e){a("bW9o")},"data-v-520b5e62",null).exports,Ne={name:"Questions",data:()=>({options1:[{value:"1",label:"Answered"},{value:"2",label:"Not Answered"}],value1:"1",options2:[{value:"1",label:"Simple choice"},{value:"2",label:"Detailed answer"}],value2:"1",searchContent:"",dialogFormVisible:!1,newQuestionForm:{departmentOptions:[],hospitalDepartmentId:"",questionDesc:"",questionType:""},rules:{hospitalDepartmentId:[{required:!0,message:"Please choose a department",trigger:"blur"}],questionDesc:[{required:!0,message:"Please input question description",trigger:"blur"}],questionType:[{required:!0,message:"Please choose question type",trigger:"blur"}]},questionList:[],page:1,limit:10,loadedQuestionCount:999,scroll:0,questionStatus:1,questionType:1,scrollTarget:".scrollable-div .el-scrollbar__wrap"}),computed:{stopLoading(){return this.loadedQuestionCount<this.limit}},methods:{selectQuestionStatus(e){"1"===e?(this.questionStatus=1,this.selectQuestions()):"2"===e&&(this.questionStatus=2,this.selectQuestions())},selectQuestionType(e){"1"===e?(this.questionType=1,this.selectQuestions()):"2"===e&&(this.questionType=2,this.selectQuestions())},initPage(){this.questionList.length=0,this.page=1,this.loadedQuestionCount=999},selectQuestions(){this.initPage(),this.loadQuestions()},loadQuestions(){this.$axios({method:"post",url:"/doctor/"+this.$store.state.user.id+"/question",data:{answeredOrNot:this.questionStatus,questionType:this.questionType,start:this.page,limit:this.limit}}).then(e=>{console.log(e.data),this.loadedQuestionCount=e.data.length;for(let t in e.data)e.data.hasOwnProperty(t)&&this.questionList.push({id:e.data[t].qid,desc:e.data[t].content,type:e.data[t].type,status:this.questionStatus});this.questionList.sort((e,t)=>e.id>t.id?-1:1)}).catch(e=>{console.log(e),alert("ERROR! Check Console plz! "),this.loadedQuestionCount=0}),this.page++},load(){setTimeout(()=>{this.loadQuestions()},500)},searchQuestions(){this.$axios({method:"post",url:"/user/similarityQuestion",data:{question:this.searchContent}}).then(e=>{console.log(e.data),this.loadedQuestionCount=0,this.initPage();for(let t in e.data)if(e.data.hasOwnProperty(t)){let a=1===e.data[t].answered;this.questionList.push({id:e.data[t].qid,desc:e.data[t].content,isAnswered:a})}}).catch(e=>{console.log(e),alert("ERROR! Check Console plz! ")})},loadDepartments(){this.$axios({method:"get",url:"/department"}).then(e=>{for(let t in e.data)e.data.hasOwnProperty(t)&&this.newQuestionForm.departmentOptions.push({value:e.data[t].id,label:e.data[t].name})}).catch(e=>{console.log(e),alert('ERROR  in function "loadDepartments( )"! Check Console plz! ')})},addNewQuestion(){this.$axios({method:"put",url:"/patient",data:{content:this.newQuestionForm.questionDesc,hospitalDepartmentId:this.newQuestionForm.hospitalDepartmentId,type:this.newQuestionForm.questionType,userid:2,remark:""}}).then(e=>{this.$message({type:"success",message:"Add Question successfully! "}),this.dialogFormVisible=!1,this.selectQuestions(),this.$refs.addQuestionForm.resetFields()}).catch(e=>{console.log(e),alert("ERROR! Check Console plz! ")})},loadMyQuestions(){this.$axios({method:"get",url:"/patient/"+this.$store.state.user.id+"/question"}).then(e=>{this.loadedQuestionCount=0,this.initPage();for(let t in e.data)e.data.hasOwnProperty(t)&&this.questionList.push({id:e.data[t].qid,desc:e.data[t].content,type:e.data[t].type});this.loadedQuestionCount=0,this.questionList.sort((e,t)=>e.id>t.id?-1:1)}).catch(e=>{console.log(e),alert('ERROR  in function "loadMyQuestions( )" [Questions]! Check Console plz! ')})},scrollTo(){JSON.parse(sessionStorage.getItem("addsCurrentQuestionStatusIsChanged")).isChanged?this.selectQuestions():this.$refs.questionListDiv.parentElement.parentElement.scrollTop=this.scroll},showDetails(e){sessionStorage.setItem("addsCurrentQuestion",JSON.stringify(e)),this.$router.push("/QA/questionDetail/"+e.id)}},created(){this.loadMyQuestions(),this.loadDepartments(),sessionStorage.setItem("addsCurrentQuestionStatusIsChanged",JSON.stringify({isChanged:!1}))},beforeRouteEnter(e,t,a){a(e=>{e.scrollTo()})},beforeRouteLeave(e,t,a){this.scroll=this.$refs.questionListDiv.parentElement.parentElement.scrollTop,a()},watch:{$route:{handler(e){this.loadMyQuestions()}}}},Ae={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"option-bar-div"},[a("div",{staticClass:"option-bar"},[a("div",{staticClass:"selector-bar"},[a("span",[e._v("Select: ")]),e._v(" "),a("el-select",{attrs:{placeholder:"Question Status"},on:{change:e.selectQuestionStatus},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}},e._l(e.options1,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-select",{attrs:{placeholder:"Question Type"},on:{change:e.selectQuestionType},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(e.options2,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("div",{staticClass:"search-bar"},[a("el-input",{attrs:{placeholder:"Search",clearable:""},model:{value:e.searchContent,callback:function(t){e.searchContent=t},expression:"searchContent"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchQuestions},slot:"append"})],1)],1),e._v(" "),a("div",{staticClass:"btn-bar"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("New Question")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.loadMyQuestions}},[e._v("My Questions")])],1)])]),e._v(" "),a("el-dialog",{attrs:{title:"New Question",visible:e.dialogFormVisible,"append-to-body":"",width:"560px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"addQuestionForm",attrs:{model:e.newQuestionForm,rules:e.rules,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"Department",prop:"hospitalDepartmentId"}},[a("el-select",{attrs:{placeholder:"Choose a department"},model:{value:e.newQuestionForm.hospitalDepartmentId,callback:function(t){e.$set(e.newQuestionForm,"hospitalDepartmentId",t)},expression:"newQuestionForm.hospitalDepartmentId"}},e._l(e.newQuestionForm.departmentOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Description",prop:"questionDesc"}},[a("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.newQuestionForm.questionDesc,callback:function(t){e.$set(e.newQuestionForm,"questionDesc",t)},expression:"newQuestionForm.questionDesc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Type",prop:"questionType"}},[a("el-radio-group",{model:{value:e.newQuestionForm.questionType,callback:function(t){e.$set(e.newQuestionForm,"questionType",t)},expression:"newQuestionForm.questionType"}},[a("el-radio",{attrs:{label:"1"}},[e._v("Simple choice")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("Detailed answer")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addNewQuestion}},[e._v("Submit")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("Cancel")])],1)],1),e._v(" "),a("div",{staticClass:"content-div scrollable-div"},[a("el-scrollbar",[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.load,expression:"load"}],ref:"questionListDiv",staticClass:"question-list-div",attrs:{"infinite-scroll-disabled":"stopLoading"}},[e._l(e.questionList,function(t){return a("el-card",{key:t.id,staticClass:"question-div"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("Question ID: "+e._s(t.id))]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showDetails(t)}}},[e._v("Details")])],1),e._v(" "),a("div",{staticClass:"question-content"},[e._v(e._s(t.desc))])])}),e._v(" "),a("div",{staticClass:"loading-info"},[e.stopLoading?a("p",[e._v("No more questions. ")]):e._e(),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:!e.stopLoading,expression:"!stopLoading"}],attrs:{"element-loading-text":"Loading... ","element-loading-spinner":"el-icon-loading"}})]),e._v(" "),a("el-backtop",{attrs:{target:e.scrollTarget,bottom:75,right:75,"visibility-height":500}},[a("div",{staticClass:"back-top"},[e._v("TOP")])])],2)])],1)],1)},staticRenderFns:[]};var Me=a("VU/8")(Ne,Ae,!1,function(e){a("1vLB")},"data-v-ba076aaa",null).exports,Re={name:"QuestionDetail",data:()=>({pageHeader:"",question:{id:0,department:"",desc:"",type:1,status:1},simpleChoiceAnswers:{columns:["Answer","Count"],rows:[{Answer:"Yes",Count:0},{Answer:"No",Count:0}]},detailedAnswers:[],noAnswerForNowFlag:!1,dialogFormVisible:!1,disabledBtn:!1,answerQuestionForm:{answer:"",remark:""},rules:{answer:[{required:!0,message:"Please input your answer",trigger:"blur"}]}}),computed:{noAnswerForNow(){return this.noAnswerForNowFlag}},methods:{backToQuestionList(){this.$router.back()},getSimpleChoiceAnswers(){this.$axios({method:"get",url:"/QA/"+this.question.id+"/simpleAnswer"}).then(e=>{console.log(e.data),this.question.desc=e.data.content,this.simpleChoiceAnswers.rows[0].Count=e.data.yesCount,this.simpleChoiceAnswers.rows[1].Count=e.data.noCount,0===e.data.yesCount&&0===e.data.noCount&&(this.noAnswerForNowFlag=!0)}).catch(e=>{console.log(e),alert('ERROR  in function "getSimpleChoiceAnswers( )"! Check Console plz! ')})},getDetailedAnswers(){this.$axios({method:"get",url:"/QA/"+this.question.id+"/detailAnswer"}).then(e=>{if(console.log(e.data),this.detailedAnswers.length=0,0===e.data.length)this.noAnswerForNowFlag=!0;else for(let t in e.data)e.data.hasOwnProperty(t)&&this.detailedAnswers.push({id:e.data[t].qrid,userId:e.data[t].userid,answerContent:e.data[t].detailedAnswer})}).catch(e=>{console.log(e),alert('ERROR  in function "getDetailedAnswers( )"! Check Console plz! ')})},answerQuestion(){this.$axios({method:"put",url:"/doctor/"+this.$store.state.user.id+"/question/"+this.question.id+"/answer",data:{type:this.question.type,answer:this.answerQuestionForm.answer,remark:this.answerQuestionForm.remark}}).then(e=>{this.$message({type:"success",message:"Answered Question successfully! "}),this.refreshPage()}).catch(e=>{console.log(e),alert('ERROR  in function "answerQuestion( )"! Check Console plz! ')})},cancelAnswer(){this.dialogFormVisible=!1,this.$refs.answerQuestionForm.resetFields()},refreshPage(){this.question.status=2,this.disabledBtn=!0,this.dialogFormVisible=!1,this.noAnswerForNowFlag=!1,this.$refs.answerQuestionForm.resetFields(),1===this.question.type?this.getSimpleChoiceAnswers():2===this.question.type&&this.getDetailedAnswers(),sessionStorage.setItem("addsCurrentQuestionStatusIsChanged",JSON.stringify({isChanged:!0}))}},created(){this.question.id=this.$route.params.id,this.pageHeader="Question ID "+this.question.id;let e=JSON.parse(sessionStorage.getItem("addsCurrentQuestion"));this.question.department="",this.question.desc=e.desc,this.question.type=e.type,this.question.status=e.status,1===this.question.type?this.getSimpleChoiceAnswers():2===this.question.type&&this.getDetailedAnswers()}},Ue={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"fixed-header"},[a("el-page-header",{attrs:{title:"Go Back",content:this.pageHeader},on:{back:e.backToQuestionList}}),e._v(" "),a("div",{staticClass:"question-desc-div"},[a("div",{staticClass:"question-desc"},[a("span",[e._v("Description: "),a("b",[e._v(e._s(this.question.desc))])])]),e._v(" "),2===this.question.status?a("div",{staticClass:"operation-btn"},[a("el-button",{staticClass:"answerBtn",attrs:{type:"primary",plain:"",disabled:e.disabledBtn},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("Answer This Question")])],1):e._e()]),e._v(" "),a("el-divider")],1),e._v(" "),a("el-dialog",{attrs:{title:"Answer this question",visible:e.dialogFormVisible,"append-to-body":"",width:"640px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"answerQuestionForm",attrs:{model:e.answerQuestionForm,rules:e.rules,"label-position":"left","label-width":"128px"}},[a("el-form-item",{attrs:{label:"Description",prop:"description"}},[a("span",[e._v(e._s(this.question.desc))])]),e._v(" "),1===this.question.type?a("el-form-item",{attrs:{label:"Your answer",prop:"answer"}},[a("el-radio-group",{model:{value:e.answerQuestionForm.answer,callback:function(t){e.$set(e.answerQuestionForm,"answer",t)},expression:"answerQuestionForm.answer"}},[a("el-radio",{attrs:{label:"yes"}},[e._v("Yes")]),e._v(" "),a("el-radio",{attrs:{label:"no"}},[e._v("No")])],1)],1):e._e(),e._v(" "),2===this.question.type?a("el-form-item",{attrs:{label:"Your answer",prop:"answer"}},[a("el-input",{attrs:{type:"textarea",rows:7},model:{value:e.answerQuestionForm.answer,callback:function(t){e.$set(e.answerQuestionForm,"answer",t)},expression:"answerQuestionForm.answer"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"Remark",prop:"remark"}},[a("el-input",{model:{value:e.answerQuestionForm.remark,callback:function(t){e.$set(e.answerQuestionForm,"remark",t)},expression:"answerQuestionForm.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.answerQuestion}},[e._v("Submit")]),e._v(" "),a("el-button",{on:{click:e.cancelAnswer}},[e._v("Cancel")])],1)],1),e._v(" "),a("div",{staticClass:"answer-content-div"},[1===this.question.type?a("div",{staticClass:"simple-choice"},[a("div",{staticClass:"content-div scrollable-div"},[a("el-card",{staticClass:"simple-choice-answer-div"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[a("b",[e._v("Answers Statistics: ")])])]),e._v(" "),a("div",{staticClass:"chart-div"},[a("ve-pie",{attrs:{data:e.simpleChoiceAnswers}}),e._v(" "),e.noAnswerForNow?a("div",[a("span",[e._v("No answer for now. ")])]):e._e()],1)])],1)]):e._e(),e._v(" "),2===this.question.type?a("div",{staticClass:"detailed-answer"},[a("div",{staticClass:"content-div scrollable-div"},[a("el-scrollbar",[a("div",{staticClass:"answer-list"},[e._l(e.detailedAnswers,function(t){return a("el-card",{key:t.id,staticClass:"detailed-answer-div"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("User ID: "+e._s(t.userId))])]),e._v(" "),a("div",{staticClass:"answer-content"},[e._v(e._s(t.answerContent))])])}),e._v(" "),e.noAnswerForNow?a("el-card",{staticClass:"detailed-answer-div"},[a("div",{staticClass:"answer-content"},[e._v("No answer for now. ")])]):e._e()],2)])],1)]):e._e()])],1)},staticRenderFns:[]};var Le=a("VU/8")(Re,Ue,!1,function(e){a("TGbX")},"data-v-611d954b",null).exports,qe={name:"my",components:{NavigationBar:v},data:()=>({input:"",characterList:[{options:[{value:1,label:"AI Robot"},{value:2,label:"Yadi Li"}]}],characterChosen:"AI robot",characterImgPath:"robot.jpg",characterName:"AI robot",characterIntro:"AI robot automatically replies your questions."}),methods:{send(){if(""!=this.input){var e=document.createElement("div");e.style="width: 100%; overflow: auto;";var t=document.createElement("div");t.innerHTML=this.input,t.style="border: 1px rgb(31, 142, 255) solid; border-radius: 5px; background-color: rgb(31, 142, 255); color: white; float: right; width: fit-content; padding: 6px 10px; margin: 5px; margin-left: 30px;",e.append(t),document.getElementById("chat-history").append(e),document.getElementById("chat-history-box").scrollTop=document.getElementById("chat-history").scrollHeight;let a=new FormData;a.append("msg",this.input),this.input="",this.$axios({method:"post",url:"/consult/online",data:a}).then(a=>{(e=document.createElement("div")).style="width: 100%; overflow: auto;",(t=document.createElement("div")).innerHTML=a.data,t.style="border: 1px rgb(235, 237, 240) solid; border-radius: 5px; background-color: rgb(235, 237, 240); float: left; width: fit-content; padding: 6px 10px; margin: 5px; margin-right: 30px;",e.append(t),document.getElementById("chat-history").append(e),setTimeout("testFunction(res)","2000"),document.getElementById("chat-history-box").scrollTop=document.getElementById("chat-history").scrollHeight}).catch(e=>{console.log(e)})}},chooseCharacter(){1==this.characterChosen?(this.characterImgPath="robot.jpg",this.characterName="AI robot",this.characterIntro="AI robot automatically replies your questions."):(this.characterImgPath="doctor.png",this.characterName="Yadi Li",this.characterIntro="Yadi Li is currently an attending doctor in the department of dermatology, Beijing Tongren hospital. She received her M.D. in dermatology from Capital Medical University in 2012. Her sub-specialties are skin cosmetic medicine and dermatology surgery.")}}},Pe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-container",[s("NavigationBar"),e._v(" "),s("el-container",{attrs:{id:"consult-div"}},[s("el-container",{attrs:{id:"chat-div"}},[s("el-main",[s("div",{staticClass:"option-block"},[s("el-select",{attrs:{placeholder:"Choose a people to consult"},on:{change:e.chooseCharacter},model:{value:e.characterChosen,callback:function(t){e.characterChosen=t},expression:"characterChosen"}},e._l(e.characterList,function(t){return s("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)}),1)],1),e._v(" "),s("div",{attrs:{id:"chat-history-box"}},[s("div",{ref:"chat",attrs:{id:"chat-history"}})])]),e._v(" "),s("el-footer",[s("div",{attrs:{id:"input"}},[s("el-input",{attrs:{placeholder:"Input here"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.send(t)}},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[s("el-button",{attrs:{slot:"append"},on:{click:e.send},slot:"append"},[e._v("SEND")])],1)],1)])],1),e._v(" "),s("el-container",{attrs:{id:"info-div"}},[s("el-main",{attrs:{id:"intro"}},[s("div",[s("el-avatar",[s("img",{attrs:{src:a("PvXa")("./"+e.characterImgPath)}})])],1),e._v(" "),s("div",{attrs:{id:"name-box"}},[s("div",[e._v(e._s(e.characterName))])]),e._v(" "),s("div",{attrs:{id:"name-box1"}},[s("div",{staticStyle:{"font-size":"12px"}},[e._v(e._s(e.characterIntro))])])])],1)],1)],1)],1)},staticRenderFns:[]};var Be=a("VU/8")(qe,Pe,!1,function(e){a("4pru")},"data-v-7d81d09b",null).exports,Ge={name:"my",components:{NavigationBar:v},data(){return{myInfoForm:{name:this.$store.state.user.username,age:this.$store.state.user.age,gender:this.$store.state.user.gender,phone:this.$store.state.user.phone,email:this.$store.state.user.email,identityID:this.$store.state.user.identityId,birthday:this.$store.state.user.birthday,nation:this.$store.state.user.nation,marriage:this.$store.state.user.marriage,birthplace:this.$store.state.user.birth_place,workplace:this.$store.state.user.work_place,picture:"(null)",loginName:"",password:"",type:"",state:""},rules:{name:[{required:!0,message:"Please input name",trigger:"blur"}],gender:[{required:!0,message:"Please input gender",trigger:"blur"}],age:[{required:!0,message:"Please input age",trigger:"blur"}],nation:[{required:!0,message:"Please input nation",trigger:"blur"}],identityID:[{required:!0,message:"Please input identityID",trigger:"blur"}],birthday:[{required:!0,message:"Please input birthday",trigger:"blur"}],marriage:[{required:!0,message:"Please input marriage",trigger:"blur"}],phone:[{required:!0,message:"Please input phone",trigger:"blur"}],email:[{required:!0,message:"Please input email",trigger:"blur"}],birthplace:[{required:!0,message:"Please input birthplace",trigger:"blur"}],workplace:[{required:!0,message:"Please input workplace",trigger:"blur"}]}}},methods:{modifyMyInfo(){this.$message.error("修改个人信息的功能暂未开放哦！")},resetMyInfo(){this.$refs.myInfoForm.resetFields(),this.$message({type:"success",message:"Reset successfully! "})}}},Oe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-container",[a("NavigationBar"),e._v(" "),a("el-container",[a("el-main",[a("div",{attrs:{id:"my-info-div"}},[a("el-form",{ref:"myInfoForm",attrs:{model:e.myInfoForm,rules:e.rules,"label-position":"left","label-width":"90px"}},[a("div",{attrs:{id:"my-info-div-1"}},[a("div",{attrs:{id:"my-info-div-1-1"}},[a("el-form-item",{attrs:{label:"Name",prop:"name"}},[a("el-input",{model:{value:e.myInfoForm.name,callback:function(t){e.$set(e.myInfoForm,"name",t)},expression:"myInfoForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Gender",prop:"gender"}},[a("el-input",{model:{value:e.myInfoForm.gender,callback:function(t){e.$set(e.myInfoForm,"gender",t)},expression:"myInfoForm.gender"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Age",prop:"age"}},[a("el-input",{model:{value:e.myInfoForm.age,callback:function(t){e.$set(e.myInfoForm,"age",t)},expression:"myInfoForm.age"}})],1)],1),e._v(" "),a("div",{attrs:{id:"my-info-div-1-2"}},[a("el-form-item",{attrs:{label:"Picture",prop:"picture"}},[a("el-input",{model:{value:e.myInfoForm.picture,callback:function(t){e.$set(e.myInfoForm,"picture",t)},expression:"myInfoForm.picture"}})],1)],1)]),e._v(" "),a("div",{attrs:{id:"my-info-div-2"}},[a("div",{attrs:{id:"my-info-div-2-1"}},[a("el-form-item",{attrs:{label:"Nation",prop:"nation"}},[a("el-input",{model:{value:e.myInfoForm.nation,callback:function(t){e.$set(e.myInfoForm,"nation",t)},expression:"myInfoForm.nation"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Birthday",prop:"birthday"}},[a("el-input",{model:{value:e.myInfoForm.birthday,callback:function(t){e.$set(e.myInfoForm,"birthday",t)},expression:"myInfoForm.birthday"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Phone",prop:"phone"}},[a("el-input",{model:{value:e.myInfoForm.phone,callback:function(t){e.$set(e.myInfoForm,"phone",t)},expression:"myInfoForm.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Birthplace",prop:"birthplace"}},[a("el-input",{model:{value:e.myInfoForm.birthplace,callback:function(t){e.$set(e.myInfoForm,"birthplace",t)},expression:"myInfoForm.birthplace"}})],1)],1),e._v(" "),a("div",{attrs:{id:"my-info-div-2-2"}},[a("el-form-item",{attrs:{label:"IdentityID",prop:"identityID"}},[a("el-input",{model:{value:e.myInfoForm.identityID,callback:function(t){e.$set(e.myInfoForm,"identityID",t)},expression:"myInfoForm.identityID"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Marriage",prop:"marriage"}},[a("el-input",{model:{value:e.myInfoForm.marriage,callback:function(t){e.$set(e.myInfoForm,"marriage",t)},expression:"myInfoForm.marriage"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Email",prop:"email"}},[a("el-input",{model:{value:e.myInfoForm.email,callback:function(t){e.$set(e.myInfoForm,"email",t)},expression:"myInfoForm.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Workplace",prop:"workplace"}},[a("el-input",{model:{value:e.myInfoForm.workplace,callback:function(t){e.$set(e.myInfoForm,"workplace",t)},expression:"myInfoForm.workplace"}})],1)],1)]),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center",margin:"40px auto"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.modifyMyInfo}},[e._v("Modify")]),e._v(" "),a("el-button",{on:{click:e.resetMyInfo}},[e._v("Reset")])],1)],1)],1)])],1)],1)],1)},staticRenderFns:[]};var Qe=a("VU/8")(Ge,Oe,!1,function(e){a("bvRR")},"data-v-291e7085",null).exports,Ve={name:"VqaMenu",data:()=>({category:[]}),methods:{},created(){}},Ke={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-aside",{staticClass:"scrollable-div",attrs:{width:"240px"}},[a("el-scrollbar",{ref:"vqaMenuScrollBar"},[a("el-menu",{attrs:{router:"","default-active":this.$route.path,"default-openeds":["1","3"]},on:{select:function(e){},open:function(e){},close:function(e){}}},[a("el-submenu",{attrs:{index:"1"}},[a("template",{slot:"title"},[e._v("Dataset Generation")]),e._v(" "),a("el-menu-item-group",[a("el-menu-item",{attrs:{index:"/vqa/dataset"}},[e._v("Data Upload")]),e._v(" "),a("el-menu-item",{attrs:{index:"/vqa/label"}},[e._v("Labeling Module")])],1)],2),e._v(" "),a("el-menu-item",{attrs:{index:"/vqa/modelEvaluation"}},[e._v("Model Practice")]),e._v(" "),a("el-submenu",{attrs:{index:"3"}},[a("template",{slot:"title"},[e._v("Result Representation")]),e._v(" "),a("el-menu-item-group",[a("el-menu-item",{attrs:{index:"/vqa/report"}},[e._v("Evaluation Report")]),e._v(" "),a("el-menu-item",{attrs:{index:"/vqa/AI"}},[e._v("AI Robot")])],1)],2)],1)],1)],1)},staticRenderFns:[]};var ze={name:"vqa",components:{NavigationBar:v,VqaMenu:a("VU/8")(Ve,Ke,!1,function(e){a("4q6C")},"data-v-d2109b4e",null).exports}},He={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-container",[t("NavigationBar"),this._v(" "),t("el-container",{staticClass:"parent-div"},[t("VqaMenu"),this._v(" "),t("keep-alive",[this.$route.meta.keepAlive?t("router-view"):this._e()],1),this._v(" "),this.$route.meta.keepAlive?this._e():t("router-view")],1)],1)],1)},staticRenderFns:[]};var je=a("VU/8")(ze,He,!1,function(e){a("UKlj")},"data-v-526007b7",null).exports,Ye={name:"my",data:()=>({blue:!0,blue_color:255,input:"",characterList:[],characterChosen:"",final_transcript:"",recognizing:!1,ignore_onend:"",start_timestamp:"",current_style:"",create_email:!1,recognization:"",first_char:/\S/,two_line:/\n\n/g,one_line:/\n/g,uploadFormVisible:!1,fileList:[],uploadForm:{title:"",desc:""},rules:{uploadFile:[{required:!0,message:"Please select file",trigger:"change"}],desc:[{required:!0,message:"Please input description",trigger:"blur"}]}}),methods:{getAllModels(){this.$axios({method:"get",url:"/models"}).then(e=>{for(var t=0;t<e.data.length;t++){console.log(e.data[t]);var a={value:t+1,label:e.data[t]};this.characterList.push(a)}console.log(this.characterList)}).catch(e=>{console.log(e),alert("ERROR! Load Models Failed! ")})},send(){if(console.log("send msg."),""!=this.input){var e=document.createElement("div");e.style="width: 100%; overflow: auto;";var t=document.createElement("div");t.innerHTML=this.input,t.style="border: 1px rgb(31, 142, 255) solid; border-radius: 5px; background-color: rgb(31, 142, 255); color: white; float: right; width: fit-content; padding: 6px 10px; margin: 5px; margin-left: 30px;",e.append(t),document.getElementById("chat-history").append(e),document.getElementById("chat-history-box").scrollTop=document.getElementById("chat-history").scrollHeight;let a=new FormData;a.append("msg",this.input),this.input="",this.$axios({method:"post",url:"/consult/online",data:a}).then(a=>{(e=document.createElement("div")).style="width: 100%; overflow: auto;",(t=document.createElement("div")).innerHTML=a.data,t.style="border: 1px rgb(235, 237, 240) solid; border-radius: 5px; background-color: rgb(235, 237, 240); float: left; width: fit-content; padding: 6px 10px; margin: 5px; margin-right: 30px;",e.append(t),document.getElementById("chat-history").append(e),setTimeout("testFunction(res)","2000"),document.getElementById("chat-history-box").scrollTop=document.getElementById("chat-history").scrollHeight}).catch(e=>{console.log(e)})}},showInfo:function(e){if(e){for(var t=document.getElementById("info").firstChild;t;t=t.nextSibling)t.style&&(t.style.display=t.id==e?"inline":"none");document.getElementById("info").setAttribute("style","visibility:'visible'")}else document.getElementById("info").setAttribute("style","visibility:'hidden'")},startButton:function(e){this.recognizing?this.recognition.stop():(this.final_transcript="",this.recognition.lang="en-US",this.recognition.start(),this.ignore_onend=!1,this.micImgPath="mic-slash.gif",this.showInfo("info_allow"),this.start_timestamp=e.timeStamp)},chooseCharacter(e){console.log(e),this.characterChosen=e,this.blue=!this.blue,this.blue?this.blue_color=255:this.blue_color=120;var t=document.getElementById("app").firstChild.firstChild.lastChild.lastChild.firstChild.lastChild.firstChild.firstChild.firstChild.firstChild.lastChild.firstChild,a=t.childNodes;console.log(a);for(var s=a.length;s>=0;s--)t.contains(a[s])&&(console.log(a[s]),t.removeChild(a[s]));console.log(this.characterList[this.characterChosen-1].label)},linebreak:function(e){return e.replace(this.two_line,"<p></p>").replace(this.one_line,"<br>")},upgrade:function(){document.getElementById("start_button").setAttribute("style","visibility :'hidden'"),this.showInfo("info_upgrade")},upload(){this.uploadFormVisible=!1,this.$refs.upload.submit()},openUploadDialog(){this.uploadFormVisible=!0},cancelUpload(){this.$refs.uploadForm.resetFields(),this.uploadFormVisible=!1},uploadMedicalArchive(e){var t=URL.createObjectURL(e.file);window.console.log(t),console.log(this.uploadForm.desc),window.console.log("this.uploadForm.desc");var a=this.uploadForm.desc;let s=new FormData;s.append("desc",this.uploadForm.desc),s.append("file",e.file),console.log(s);var o=document.createElement("img");o.src=URL.createObjectURL(e.file),o.style="border: 1px rgb(31, 142, 255) solid; border-radius: 5px; background-color: rgb(31, 142, 255); color: white; float: right; width: 150px; padding: 6px 10px; margin: 5px; margin-left: 30px;";var i=document.createElement("div");i.style="width: 100%; overflow: auto;";var l=document.createElement("div");l.innerHTML=a,l.style="border: 1px rgb(31, 142, 255) solid; border-radius: 5px; background-color: rgb(31, 142, 255); color: white; float: right; width: fit-content; padding: 6px 10px; margin: 5px; margin-left: 30px;",i.append(l);var n=document.createElement("div");i.style="width: 100%; overflow: auto;",n.append(o),document.getElementById("chat-history").append(i),document.getElementById("chat-history-box").scrollTop=document.getElementById("chat-history").scrollHeight,document.getElementById("chat-history").append(n),document.getElementById("chat-history-box").scrollTop=document.getElementById("chat-history").scrollHeight,console.log("modelname:"+this.characterList[this.characterChosen]),this.$axios({method:"post",url:"/archive/user/"+this.characterList[this.characterChosen-1].label,data:s}).then(e=>{window.console.log(e),this.$refs.uploadForm.resetFields(),this.$message({type:"success",message:"Successully uploaded medical archive!",showClose:!0}),(i=document.createElement("div")).style="width: 100%; overflow: auto;",(l=document.createElement("div")).innerHTML=e.data,l.style="border: 1px rgb(235, 237, 240) solid; border-radius: 5px; background-color: rgb(235, 237, 240); float: left; width: fit-content; padding: 6px 10px; margin: 5px; margin-right: 30px;",i.append(l),document.getElementById("chat-history").append(i),setTimeout("testFunction(res)","2000"),document.getElementById("chat-history-box").scrollTop=document.getElementById("chat-history").scrollHeight})},capitalize:function(e){return e.replace(this.first_char,function(e){return e.toUpperCase()})}},mounted(){if(this.getAllModels(),"webkitSpeechRecognition"in window){this.recognition=new webkitSpeechRecognition,this.recognition.continuous=!0,this.recognition.interimResults=!0;var e=this;this.recognition.onstart=function(){e.recognizing=!0,e.showInfo("info_speak_now"),e.micImgPath="mic-animate.gif"},this.recognition.onerror=function(t){"no-speech"==t.error&&(e.micImgPath="mic.gif",e.showInfo("info_no_speech"),e.ignore_onend=!0),"audio-capture"==t.error&&(e.micImgPath="mic.gif",e.showInfo("info_no_microphone"),e.ignore_onend=!0),"not-allowed"==t.error&&(t.timeStamp-start_timestamp<100?e.showInfo("info_blocked"):e.showInfo("info_denied"),e.ignore_onend=!0)},this.recognition.onend=function(){console.log("endof recog"),e.recognizing=!1,e.ignore_onend||(e.micImgPath="mic.gif",e.final_transcript?e.showInfo(""):e.showInfo("info_start"))},this.recognition.onresult=function(t){for(var a=t.resultIndex;a<t.results.length;++a)t.results[a].isFinal?e.final_transcript+=t.results[a][0].transcript:t.results[a][0].transcript;e.final_transcript=e.capitalize(e.final_transcript),e.input=e.linebreak(e.final_transcript)}}else this.upgrade()}},We={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("div",{staticClass:"top-bar"},[a("div",{staticClass:"option-bar"}),e._v(" "),a("el-main",[a("div",[a("el-container",{attrs:{id:"consult-div"}},[a("el-container",{attrs:{id:"chat-div"}},[a("el-main",[a("div",{staticClass:"option-block"},[[a("el-select",{attrs:{placeholder:"Please"},on:{change:e.chooseCharacter},model:{value:e.characterChosen,callback:function(t){e.characterChosen=t},expression:"characterChosen"}},e._l(e.characterList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]],2),e._v(" "),a("div",{attrs:{id:"chat-history-box"}},[a("div",{ref:"chat",attrs:{id:"chat-history"}})])]),e._v(" "),a("el-dialog",{attrs:{title:"UPLOAD",visible:e.uploadFormVisible,width:"640px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.uploadFormVisible=t}}},[a("el-form",{ref:"uploadForm",attrs:{model:e.uploadForm,rules:e.rules,"label-position":"left","label-width":"130px"}},[a("el-form-item",{attrs:{label:"Question",prop:"desc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.uploadForm.desc,callback:function(t){e.$set(e.uploadForm,"desc",t)},expression:"uploadForm.desc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"UPDATE",prop:"uploadFile"}},[a("el-upload",{ref:"upload",attrs:{action:"",accept:".png, .jpg, .jpeg",multiple:!1,"file-list":e.fileList,"show-file-list":!0,"http-request":e.uploadMedicalArchive,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",type:"primary"},slot:"trigger"},[e._v("BROWSE\n                    ")])],1)],1)],1),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.upload}},[e._v("SUBMIT")]),e._v(" "),a("el-button",{on:{click:e.cancelUpload}},[e._v("CANCEL")])],1)],1),e._v(" "),a("el-footer",[a("el-container",[a("div",{attrs:{id:"input"}},[[a("el-input",{staticStyle:{width:"90%",float:"left"},attrs:{placeholder:"please input through UPDATE button",disabled:!0},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.send(t)}},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("el-button",{attrs:{slot:"prepend"},on:{click:e.openUploadDialog},slot:"prepend"},[e._v("UPDATE\n                      ")]),e._v(" "),a("el-button",{staticStyle:{float:"left"},attrs:{slot:"append"},on:{click:e.send},slot:"append"},[e._v("SEND\n                      ")])],1)]],2)])],1)],1)],1)],1)])],1)])},staticRenderFns:[]};var Je=a("VU/8")(Ye,We,!1,function(e){a("SBUn")},"data-v-32ad7863",null).exports,Xe={name:"dataset",data:()=>({datasetTableHeight:200,datasetTableData:[{}],datasetTableEmptyText:"Loading...",stepsActive:0,addDatasetFormVisible:!1,addDatasetForm:{name:"",description:"",ratio:[4,8]},rules:{name:[{required:!0,message:"Please input name",trigger:"blur"}],description:[{required:!0,message:"Please input description",trigger:"blur"}],train:[{required:!0,message:"Please input description",trigger:"blur"}],valid:[{required:!0,message:"Please input description",trigger:"blur"}],test:[{required:!0,message:"Please input description",trigger:"blur"}]},uploadDatasetFormVisible:!1,uploadDatasetForm:{datasetId:0,type:""},trainSetExist:!1,testSetExist:!1,devSetExist:!1,trainSetFileList:[],testSetFileList:[],devSetFileList:[]}),methods:{handleRemove(e,t){console.log(e,t)},submitUpload(){this.$refs.upload.submit()},handleFilUploadSuccess(e,t,a){console.log(e,t,a),this.$message.success("上传成功")},handleUpdate(){this.dialogVisible=!0},handleUpload(){this.submitUpload(),this.dialogVisible=!1},download(e){const t=document.createElement("a");t.setAttribute("href",this.$options.filters.filterUrl(e)),t.setAttribute("download",name),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)},goDownload(e){window.location.replace("https://"+e),console.log(e)},loadDataset(){this.$axios({method:"get",url:"/dataSets"}).then(e=>{console.log(e.data),this.datasetTableData=e.data,0===this.datasetTableData.length&&(this.datasetTableEmptyText="No Dataset")}).catch(e=>{console.log(e)})},newDatasetDialog(){this.stepsActive=0,this.addDatasetFormVisible=!0},addDataset(){this.handleUpload();let e=new FormData;e.append("name",this.addDatasetForm.name),e.append("description",this.addDatasetForm.description),e.append("train",this.addDatasetForm.ratio[0]),e.append("valid",this.addDatasetForm.ratio[1]-this.addDatasetForm.ratio[0]),e.append("test",10-this.addDatasetForm.ratio[1]),this.$axios({method:"post",url:"/addDataset",data:e}).then(e=>{this.addDatasetFormVisible=!0,console.log(e.data),this.closeAddDatasetForm(),this.loadDataset(),this.$notify({title:"Success",message:"Successfully create dataset! ",type:"success"}),this.openUploadDatasetForm(e.data,"","","")}).catch(e=>{console.log(e)})},cancelAddDataset(){this.closeAddDatasetForm()},closeAddDatasetForm(){this.addDatasetFormVisible=!1,this.$refs.addDatasetForm.resetFields()},submitUploadTrainSetFile(){this.uploadDatasetForm.type="train",this.$refs.uploadTrainSet.submit()},submitUploadTestSetFile(){this.uploadDatasetForm.type="test",this.$refs.uploadTestSet.submit()},submitUploadDevSetFile(){this.uploadDatasetForm.type="dev",DevSet.submit()},uploadDatasetFile(e){let t=new FormData;t.append("dId",this.uploadDatasetForm.datasetId),t.append("type",this.uploadDatasetForm.type),t.append("file",e.file),this.$axios({method:"post",url:"/doctor/"+this.$store.state.user.id+"/dataSets",data:t}).then(e=>{this.$notify({title:"Success",message:"Successfully upload file! ",type:"success"})}).catch(e=>{console.log(e),this.$notify.error({title:"Error",message:"Wrong file format! "})})},cancelUploadDataset(){this.$router.push("/vqa/label"),this.closeUploadDatasetForm(),this.loadDataset()},openUploadDatasetForm(e,t,a,s){this.stepsActive=1,this.uploadDatasetForm.datasetId=e,this.trainSetExist=""!==t,this.testSetExist=""!==a,this.devSetExist=""!==s,this.uploadDatasetFormVisible=!0},closeUploadDatasetForm(){this.uploadDatasetFormVisible=!1,this.$refs.uploadDatasetForm.resetFields(),this.trainSetFileList=[],this.testSetFileList=[],this.devSetFileList=[]},showMsg(e){e?this.$notify({title:"Success",message:"Dataset is available! Begin a TASK or RESET dataset! ",type:"success"}):this.$notify.warning({title:"Warning",message:"Dataset is not available! Please UPLOAD first! "})},goToModelEvaluation(e){this.$router.push("/deepLearning/modelEvaluation")},goToAutoSelection(e){this.$router.push("/deepLearning/autoSelection")},open(){this.ZipFormat="├── img <br/>│   └── 1.img│   └── 2.img│   └── 3.img├── txt\n│   └── 1.txt│   └── 2.txt│   └── 3.txt└── relationship.csv",this.$alert(this.ZipFormat,"The format of zip file",{confirmButtonText:"Confirm",callback:e=>{this.$message({type:"info",message:`action: ${e}`})}})}},created(){this.loadDataset()},mounted(){this.$nextTick(function(){this.datasetTableHeight=window.innerHeight-this.$refs.datasetTable.$el.offsetTop-190;let e=this;window.onresize=function(){e.datasetTableHeight=window.innerHeight-e.$refs.datasetTable.$el.offsetTop-190}})}},Ze={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"top-bar"},[a("div",{staticClass:"option-bar"},[a("div",{staticClass:"header-bar"},[a("span",[e._v("My Dataset")])]),e._v(" "),a("div",{staticClass:"operation-btn-bar"},[a("el-button",{attrs:{type:"text"},on:{click:e.open}},[e._v("Readme")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.newDatasetDialog}},[e._v("Generate Dataset")])],1)])]),e._v(" "),a("el-dialog",{attrs:{title:"Generate Dataset",visible:e.addDatasetFormVisible,width:"640px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.addDatasetFormVisible=t}}},[a("el-steps",{attrs:{active:e.stepsActive,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"Upload your data",icon:"el-icon-upload",description:"Create dataset"}})],1),e._v(" "),a("el-form",{ref:"addDatasetForm",attrs:{model:e.addDatasetForm,rules:e.rules,"label-position":"left","label-width":"130px"}},[a("el-form-item",{attrs:{label:"Name",prop:"name"}},[a("el-input",{model:{value:e.addDatasetForm.name,callback:function(t){e.$set(e.addDatasetForm,"name",t)},expression:"addDatasetForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Description",prop:"description"}},[a("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.addDatasetForm.description,callback:function(t){e.$set(e.addDatasetForm,"description",t)},expression:"addDatasetForm.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Train/Valid/Test",prop:"test"}},[[a("div",{staticClass:"block"},[a("el-slider",{attrs:{range:"","show-stops":"",max:10},model:{value:e.addDatasetForm.ratio,callback:function(t){e.$set(e.addDatasetForm,"ratio",t)},expression:"addDatasetForm.ratio"}})],1)]],2),e._v(" "),a("el-form-item",[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:"http://localhost:8089/upload",multiple:"","auto-upload":!1,limit:5,"on-success":e.handleFilUploadSuccess,"on-remove":e.handleRemove}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("drop files here,or "),a("em",[e._v("click here to upload files")])]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("please upload zip files")])])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addDataset}},[e._v("Submit")]),e._v(" "),a("el-button",{on:{click:e.cancelAddDataset}},[e._v("Cancel")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"Upload Dataset",visible:e.uploadDatasetFormVisible,width:"640px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.uploadDatasetFormVisible=t}}},[a("el-steps",{attrs:{active:e.stepsActive,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"Step 1",description:"Create dataset"}}),e._v(" "),a("el-step",{attrs:{title:"Step 2",description:"Go labeling"}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelUploadDataset}},[e._v("Finish")])],1)],1),e._v(" "),a("div",{staticClass:"content-div scrollable-div"},[a("el-scrollbar",[a("div",{staticClass:"content-parent"},[a("div",{staticClass:"content"},[a("div",{staticClass:"item-list"},[a("el-table",{ref:"datasetTable",attrs:{data:e.datasetTableData,"max-height":e.datasetTableHeight}},[a("template",{slot:"empty"},[a("span",[e._v(e._s(e.datasetTableEmptyText))])]),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"Name","min-width":"20%",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"Description","min-width":"30%",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"Status","min-width":"15%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{slot:"reference",type:t.row.status?"success":"danger"},on:{click:function(a){return e.showMsg(t.row.status)}},slot:"reference"},[e._v(e._s(t.row.status?"Available":"Not Available"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operations",label:"Operations","min-width":"35%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.status?a("div",[a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return e.goDownload(t.row.link)}}},[e._v("Download")])],1):a("div",[a("el-button",{attrs:{type:"primary",plain:"",size:"small",disabled:""},on:{click:function(t){return e.goDownload()}}},[e._v("Download")])],1)]}}])}),e._v("ratio\n              ")],2)],1)])])])],1)],1)},staticRenderFns:[]};var et=a("VU/8")(Xe,Ze,!1,function(e){a("4Ogv")},"data-v-6352da6a",null).exports,tt={methods:{getAllDatasets(){this.$axios({method:"get",url:"/dataSetsNamesLabeled"}).then(e=>{console.log("all datasets: "),console.log(e.data);for(var t=0;t<e.data.length;t++){var a={value:t+1,label:e.data[t]};this.options.push(a)}console.log(this.options)}).catch(e=>{console.log(e),alert("ERROR! Load Models Failed! ")})},chooseEmbedding(e){this.choosenEmbedding=e},chooseAttention(e){this.choosenAttention=e},chooseConstruct(e){this.choosenConstruct=e},chooseRnncell(e){this.choosenRnncell=e},chooseBatchsize(e){this.choosenBatchsize=e},chooseDataset(e){this.characterChosen=e},tableRowClassName:({row:e,rowIndex:t})=>1===t?"warning-row":3===t?"success-row":"",trainModel(e){console.log(e),alert("Begin training "+e.name+" model.");for(var t="",a="",s="",o="",i="",l="",n=0;n<this.options.length;n++)if(this.characterChosen==this.options[n].value){t=this.options[n].label;break}for(n=0;n<this.batchsize.length;n++)if(this.choosenBatchsize==this.batchsize[n].value){a=this.batchsize[n].label;break}for(n=0;n<this.rnn.length;n++)if(this.choosenRnncell==this.rnn[n].value){s=this.rnn[n].label;break}for(n=0;n<this.embedding.length;n++)if(this.choosenEmbedding==this.embedding[n].value){o=this.embedding[n].label;break}for(n=0;n<this.attention.length;n++)if(this.choosenAttention==this.attention[n].value){i=this.attention[n].label;break}for(n=0;n<this.construct.length;n++)if(this.choosenConstruct==this.construct[n].value){l=this.construct[n].label;break}console.log(t),console.log(i),console.log(l),this.$axios({method:"post",url:"/train/"+e.name,data:{name:this.input,data:t,batchsize:a,epoch:this.epoch,rnn_cell:s,embedding:o,attention:i,constructor:l}}).then(e=>{"name_existed"==e.data&&(alert("ERROR! This name has existed! "),console.log("name_existed checking."),console.log(e.data)),console.log(this.characterList),console.log(e.data)}).catch(t=>{console.log(t),alert("TRAIN ERROR! Check Console plz! "),this.$axios({method:"post",url:"/error/"+e.name}).then(e=>{console.log(this.characterList),console.log(e.data)}).catch(e=>{console.log(e)})})}},mounted(){this.getAllDatasets()},data:()=>({choosenBatchsize:32,characterChosen:1,epoch:20,choosenRnncell:1,choosenEmbedding:3,choosenAttention:1,choosenConstruct:3,input:"",options:[],rnn:[{value:1,label:"GRU"},{value:2,label:"LSTM"}],embedding:[{value:1,label:"w2v"},{value:2,label:"glove"},{value:3,label:"none"}],attention:[{value:1,label:"SAN"},{value:2,label:"BAN"}],construct:[{value:1,label:"maml"},{value:2,label:"autoencoder"},{value:3,label:"both"}],batchsize:[{value:1,label:"1"},{value:2,label:"4"},{value:3,label:"8"},{value:4,label:"16"},{value:5,label:"32"},{value:6,label:"64"},{value:7,label:"128"}],modelType:[{name:"Joint Embedding  Models",model:[{name:"---\x3e  ODL",paper:"Overcoming Data Limitation in Medical Visual Question Answering. ",type:"joint embedding",link:"https://arxiv.org/abs/1909.11867",embedding_vis:!1,rnn_cell_vis:!0,attention_vis:!0,construct_vis:!0}]},{name:"Encoder-Decoder Models",model:[{name:"---\x3e  NLM",paper:"NLM at VQA-Med 2020: Visual Question Answering and Generation in the Medical Domain",link:"http://ceur-ws.org/Vol-2696/paper_98.pdf",type:"Seq2Seq",embedding_vis:!0,rnn_cell_vis:!0,attention_vis:!1,construct_vis:!1},{name:"---\x3e  VGG-Seq2Seq",paper:"JUST at VQA-Med: A VGG-Seq2Seq Model",link:"http://ceur-ws.org/Vol-2125/paper_171.pdf",type:"Seq2Seq",embedding_vis:!1,rnn_cell_vis:!1,attention_vis:!1,construct_vis:!1}]},{name:"Attention-based  Models",model:[{name:"---\x3e  MMBERT",paper:"MMBERT: Multimodal BERT Pretraining for Improved Medical VQA",link:"https://arxiv.org/abs/2104.01394",type:"attention",embedding_vis:!1,rnn_cell_vis:!1,attention_vis:!1,construct_vis:!1}]},{name:"Knowledge Embedding  Models",model:[{name:"---\x3e  ArticleNet",paper:"OK-VQA: A Visual Question Answering Benchmark Requiring External Knowledge",link:"https://openaccess.thecvf.com/content_CVPR_2019/papers/Marino_OK-VQA_A_Visual_Question_Answering_Benchmark_Requiring_External_Knowledge_CVPR_2019_paper.pdf",type:"knowledge embedding",embedding_vis:!1,rnn_cell_vis:!1,attention_vis:!1,construct_vis:!1}]}]})},at={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"top-bar"},[a("div",{staticClass:"option-bar"},[a("el-header",{staticClass:"header-bar"},[a("div",[a("span",[e._v("Model Practice")])])]),e._v(" "),a("div",[a("el-card",{staticClass:"box-card"},[a("el-collapse",e._l(e.modelType,function(t,s){return a("div",[a("el-collapse-item",{attrs:{title:t.name,name:s}},[a("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(t.model,function(t,s){return a("div",[a("el-collapse-item",{attrs:{title:t.name,name:s}},[a("el-header",[e._v("--\x3e\n                        "),e._v(" "),a("el-link",{staticClass:"ms",attrs:{href:t.link,type:"primary"}},[e._v(e._s(t.paper))]),e._v(" "),a("div")],1),e._v(" "),a("div",[a("el-footer",[a("div",[a("span",[e._v("Dataset")]),e._v(" "),a("div",[[a("el-select",{attrs:{placeholder:"Please"},on:{change:e.chooseDataset},model:{value:e.characterChosen,callback:function(t){e.characterChosen=t},expression:"characterChosen"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]],2),e._v(" "),a("span",[e._v("Epoch")]),e._v(" "),a("div",[[a("div",{staticClass:"block"},[a("el-slider",{attrs:{step:10,"show-stops":"","show-input":""},model:{value:e.epoch,callback:function(t){e.epoch=t},expression:"epoch"}})],1)]],2),e._v(" "),a("span",[e._v("Batchsize")]),e._v(" "),a("div",[[a("el-select",{attrs:{placeholder:"Please"},on:{change:e.chooseBatchsize},model:{value:e.choosenBatchsize,callback:function(t){e.choosenBatchsize=t},expression:"choosenBatchsize"}},e._l(e.batchsize,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]],2),e._v(" "),t.rnn_cell_vis?a("span",[e._v("Rnn Cell")]):e._e(),e._v(" "),a("div",[[t.rnn_cell_vis?a("el-select",{attrs:{placeholder:"Please"},on:{change:e.chooseRnncell},model:{value:e.choosenRnncell,callback:function(t){e.choosenRnncell=t},expression:"choosenRnncell"}},e._l(e.rnn,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1):e._e()]],2),e._v(" "),t.embedding_vis?a("span",[e._v("Embedding")]):e._e(),e._v(" "),a("div",[[t.embedding_vis?a("el-select",{attrs:{placeholder:"Please"},on:{change:e.chooseEmbedding},model:{value:e.choosenEmbedding,callback:function(t){e.choosenEmbedding=t},expression:"choosenEmbedding"}},e._l(e.embedding,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1):e._e()]],2),e._v(" "),t.attention_vis?a("span",[e._v("Attention")]):e._e(),e._v(" "),a("div",[[t.attention_vis?a("el-select",{attrs:{placeholder:"Please"},on:{change:e.chooseAttention},model:{value:e.choosenAttention,callback:function(t){e.choosenAttention=t},expression:"choosenAttention"}},e._l(e.attention,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1):e._e()]],2),e._v(" "),t.construct_vis?a("span",[e._v("Construct Module")]):e._e(),e._v(" "),a("div",[[t.construct_vis?a("el-select",{attrs:{placeholder:"Please"},on:{change:e.chooseConstruct},model:{value:e.choosenConstruct,callback:function(t){e.choosenConstruct=t},expression:"choosenConstruct"}},e._l(e.construct,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1):e._e()]],2),e._v(" "),a("span",[e._v("TrainName")]),e._v(" "),a("div",[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"Please input model name",size:"medium"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1)],1),e._v(" "),a("div",{staticClass:"operation-btn-bar"},[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.trainModel(t)}}},[e._v("Train")])],1),e._v(" "),a("div")])])],1)],1)],1)}),0)],1)],1)}),0)],1)],1)],1)])])},staticRenderFns:[]};var st=a("VU/8")(tt,at,!1,function(e){a("Y7BG")},null,null).exports,ot={mounted(){this.getAllReports()},methods:{fileChange(e){try{const e=document.getElementById("file");if(null==e)return;this.form.imgSavePath=e.files[0].path,console.log(e)}catch(e){console.debug("choice file err:",e)}},btnChange(){document.getElementById("file").click()},downloadReports(){this.$axios({method:"get",url:"/downloadReports"}).then(e=>{console.log(e.data);const t=e.data,a=new Blob([t]);if("download"in document.createElement("a")){const e=document.createElement("a");e.download="report.csv",e.style.display="none",e.href=URL.createObjectURL(a),document.body.appendChild(e),e.click(),URL.revokeObjectURL(e.href),document.body.removeChild(e)}else navigator.msSaveBlob(a,"report.csv")}).catch(e=>{console.log(e),alert("ERROR! Load Reports Failed! ")})},deleteFailed(){this.$axios({method:"delete",url:"/deleteFailed"}).then(e=>{console.log(e.data),alert("Delete failed models sucess! Please refresh manually.")}).catch(e=>{console.log(e),alert("ERROR! Delete Reports Failed! ")})},tableRowClassName:({row:e,rowIndex:t})=>"done"==e.state?"success-row":"running"==e.state?"warning-row":"failed-row",getAllReports(){this.$axios({method:"get",url:"/reports"}).then(e=>{console.log(e.data),this.tableData1=e.data;for(var t=0;t<this.tableData1.length;t++)"NLM"!=this.tableData1[t].classification&&"VGG-Seq2Seq"!=this.tableData1[t].classification?(this.tableData1[t].prec=this.tableData1[t].prec/100+"%",this.tableData1[t].recall=this.tableData1[t].recall/100+"%",this.tableData1[t].f1=this.tableData1[t].f1/100+"%",this.tableData1[t].bleu="---"):(this.tableData1[t].prec="---",this.tableData1[t].recall="---",this.tableData1[t].f1="---",this.tableData1[t].bleu=this.tableData1[t].bleu)}).catch(e=>{console.log(e),alert("ERROR! Load Reports Failed! ")})}},data:()=>({downloadVisable:!1,form:{name:"",desc:"",imgSavePath:""},characterList:[{options:[{value:1,label:"Joint Embedding approches"},{value:2,label:"Attention mechanisms"},{value:3,label:"Compositional Models"},{value:4,label:"Models using external knowledge base"}]}],tableData1:[],models:[{name:"NLM",type:"bleu"},{name:"VGG-Seq2Seq",type:"bleu"},{name:"ODL",type:"acc"},{name:"MMBERT",type:"acc"},{name:"Knowledge Embedded Metalearning",type:"acc"}]})},it={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"top-bar"},[a("div",{staticClass:"option-bar"},[a("el-header",{staticClass:"header-bar"},[a("div",[a("span",[e._v("Evaluation Report")]),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-button-group",[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteFailed()}}},[e._v("Quickly Remove"),a("i",{staticClass:"el-icon-delete el-icon--left"})]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.downloadReports()}}},[e._v("Download"),a("i",{staticClass:"el-icon-download el-icon--right"})])],1)],1)],1)]),e._v(" "),a("div",[a("el-card",{staticClass:"box-card"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData1,"row-class-name":e.tableRowClassName,"default-sort":{prop:"date",order:"descending"}}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[e._v("--\x3e\n                  "),a("el-form-item",{attrs:{label:"Precision"}},[a("span",[e._v(e._s(t.row.prec)+" ")])]),e._v(" "),a("el-form-item",{attrs:{label:"Recall"}},[a("span",[e._v(e._s(t.row.recall)+" ")])]),e._v(" "),a("el-form-item",{attrs:{label:"F1-score"}},[a("span",[e._v(e._s(t.row.f1)+" ")])]),e._v(" "),a("el-form-item",{attrs:{label:"BLEU"}},[a("span",[e._v(e._s(t.row.bleu))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"Report",width:"180",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"classification",label:"Model",width:"180",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"date",label:"Generated Date",width:"180",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"state",label:"Status",width:"180",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"data",label:"DataSet",width:"180",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"epoch",label:"Epochs",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"batch",label:"Batchsize",width:"180"}})],1)],1)],1)],1)])])},staticRenderFns:[]};var lt=a("VU/8")(ot,it,!1,function(e){a("2yY2")},null,null).exports,nt={data:()=>({characterList_dataset:[],imgPath:"",characterChosen:"",upList:[],description:"",boneName:"",photoFile:"",dias:[],patientIds:[],pngFile:"1.png",currentPage:1,total:20,pageSize:100,DirectionChosen:"Please select the shooting surface",characterList:[{options:[{value:1,label:"Transverse"},{value:2,label:"Coronal"},{value:3,label:"Sagittal"}]}],typeChosen:"Please select the type of image to check",typeList:[{options:[{value:1,label:"ct"},{value:2,label:"x-ray"}]}],boneChosen:"Please select the organ corresponding to the bone",boneList:[{options:[{value:1,label:"Head"},{value:2,label:"Chest"},{value:3,label:"Hand"},{value:4,label:"Leg"}]}],xrayChosen:"Please choose the direction of shooting",xrayList:[{options:[{value:1,label:"A-P"},{value:2,label:"Lateral"},{value:3,label:"Lordotic"},{value:4,label:"A-p supine"},{value:5,label:"P-A "}]}]}),methods:{opens(){this.$alert("Labeling is done, Now it's generation VQA pairs, pleases wait for a moment.","Information",{confirmButtonText:"Confirm"})},generate(){this.$axios({method:"get",url:"/doneLableing/"+this.characterList_dataset[this.characterChosen-1].label}).then(e=>{this.opens()}).catch(e=>{this.opens(),this.$router.push("/vqa/dataset")})},chooseCharacter(e){this.characterChosen=e,this.getAllPatients()},getAllModels(){this.$axios({method:"get",url:"/dataSetsNames"}).then(e=>{console.log("all datasets: "),console.log(e.data);for(var t=0;t<e.data.length;t++){var a={value:t+1,label:e.data[t]};this.characterList_dataset.push(a)}}).catch(e=>{console.log(e),alert("ERROR! Load Models Failed! ")})},handleSizeChange(e){console.log(`每页 ${e} 条`),this.pageSize=e},handleCurrentChange(e){console.log(`当前页: ${e}`),this.currentPage=e},getId(e,t,a,s,o,i,l){console.log("patientId",e),console.log("photoId",t);var n=document.getElementsByName("ct"),r=[];for(var d in n)n[d].checked&&r.push(n[d].value);console.log("diaList",r),console.log("description",a),console.log("boneName",s),console.log("direction",o),console.log("type",i),console.log("position",l);let c=new FormData;c.append("patientId",e),c.append("diaList",r),c.append("photoId",t),c.append("description",a),c.append("boneName",s),c.append("direction",o),c.append("type",i),c.append("position",l),this.$axios({method:"post",url:"/vqa/"+this.characterList_dataset[this.characterChosen-1].label,data:c}).then(e=>{this.$message({message:"Successfully!",type:"success",offset:60,showClose:!0}),location.reload()}).catch(e=>{console.log(e)})},getPhoto(e){console.log("id",e),this.photoFile=this.patientIds[e].photoId+".jpg",this.imgPath="./../../../static/"+this.characterList_dataset[this.characterChosen-1].label+"/"+this.photoFile,console.log("imgpath",this.imgPath),this.dias=this.patientIds[e].dias[0].split(","),console.log("dias",this.dias),console.log("diasType",typeof this.dias[0])},confirmEdit(e,t){t.edit=!1,this.$message({message:"该地址已经成功修改",type:"success"})},getAllPatients(){this.$axios({method:"get",url:"/all/"+this.characterList_dataset[this.characterChosen-1].label}).then(e=>{console.log("dataset name: "+this.characterList_dataset[this.characterChosen-1].label),this.patientIds=[];for(let a in e.data)if(e.data.hasOwnProperty(a)){var t=e.data[a].diaList.split("|");this.patientIds.push({patientId:e.data[a].patientId,sym:e.data[a].sym,photoId:e.data[a].photoId,dias:t,annotation:e.data[a].annotation})}}).catch(e=>{console.log(e)})}},mounted(){this.getAllModels()}},rt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"top-bar"},[a("div",{staticClass:"option-bar"},[a("div",{staticClass:"header-bar"},[a("span",[e._v("Labeling Module")])]),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-select",{attrs:{placeholder:"Please choose dataset."},on:{change:e.chooseCharacter},model:{value:e.characterChosen,callback:function(t){e.characterChosen=t},expression:"characterChosen"}},e._l(e.characterList_dataset,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)]),e._v(" "),a("div"),e._v(" "),[a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-button-group",[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.generate()}}},[e._v("Submit"),a("i",{staticClass:"el-icon-check"})])],1)],1)],e._v(" "),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.patientIds.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize)}},[a("el-table-column",{attrs:{prop:"name",label:"Document ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.patientId))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"Picture ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.photoId))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Operation"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{placement:"bottom",title:"Check if the image corresponds to the disease (do not check otherwise).",width:"1000",trigger:"click",content:""}},[a("el-button",{attrs:{slot:"reference"},on:{click:function(a){return e.getPhoto(t.$index)}},slot:"reference"},[e._v("Edit")]),e._v(" "),a("div",[a("el-scrollbar",{staticStyle:{height:"500px"}},[a("p",{staticStyle:{"font-size":"15px"}},[e._v("Symptoms：")]),e._v(" "),a("p",{staticStyle:{"font-size":"15px"}},[e._v(e._s(t.row.sym))]),e._v(" "),a("p",{staticStyle:{"font-size":"15px"}},[e._v("Auxiliary examination：")]),e._v(" "),a("p",{staticStyle:{"font-size":"15px"}},[e._v(e._s(t.row.annotation))]),e._v(" "),a("el-input",{staticStyle:{width:"90%",float:"left"},attrs:{placeholder:"Please enter the description of the inspection image (refer to the auxiliary inspection)."},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),e._v(" "),a("div"),e._v(" "),a("div",{staticClass:"option-block"},[a("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"Please select the location"},model:{value:e.boneChosen,callback:function(t){e.boneChosen=t},expression:"boneChosen"}},e._l(e.boneList,function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)}),1)],1),e._v(" "),a("div",{staticClass:"option-block"},[a("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"Please select the type of examination sheet"},model:{value:e.typeChosen,callback:function(t){e.typeChosen=t},expression:"typeChosen"}},e._l(e.typeList,function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)}),1)],1),e._v(" "),a("div",{staticClass:"option-block"},[a("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"Please select location identification"},model:{value:e.xrayChosen,callback:function(t){e.xrayChosen=t},expression:"xrayChosen"}},e._l(e.xrayList,function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)}),1)],1),e._v(" "),a("div",{staticClass:"option-block"},[a("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"Please scroll down to select"},model:{value:e.DirectionChosen,callback:function(t){e.DirectionChosen=t},expression:"DirectionChosen"}},e._l(e.characterList,function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)}),1)],1),e._v(" "),a("label",[a("img",{attrs:{src:e.imgPath,width:"500px",height:"400px"}})]),e._v(" "),e._l(e.dias,function(t,s){return a("div",{staticClass:"checkbox"},[a("label",[a("input",{staticStyle:{width:"20px",height:"20px"},attrs:{type:"checkbox",name:"ct"},domProps:{value:t}}),e._v(" "),a("p",[e._v(e._s(t))])])])}),e._v(" "),a("p",{staticStyle:{"text-align":"center"}},[a("button",{on:{click:function(a){return e.getId(t.row.patientId,t.row.photoId,e.description,e.boneChosen,e.DirectionChosen,e.typeChosen,e.xrayChosen)}}},[e._v("Submit")])])],2)],1)],1)]}}])})],1),e._v(" "),a("div",{staticClass:"yema"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[5,10,15],"page-size":e.pagesize,layout:"total,jumper,prev, pager, next,sizes",total:e.patientIds.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],2)},staticRenderFns:[]};var dt=a("VU/8")(nt,rt,!1,function(e){a("U+bg")},"data-v-beb9acb6",null).exports;s.default.use(n.a);var ct=new n.a({mode:"history",linkActiveClass:"is-active",routes:[{path:"/",redirect:"/login"},{path:"/login",name:"login",component:c},{path:"/signUp",name:"signUp",component:m},{path:"/deepLearning",component:_,children:[{path:"",redirect:"deepModels"},{path:"deepModels",name:"DeepModels",component:D,meta:{keepAlive:!0}},{path:"uploadDataset",name:"UploadDataset",component:$},{path:"uploadKnowledgeGraph",name:"UploadKg",component:N},{path:"modelEvaluation",name:"ModelEvaluation",component:R},{path:"autoSelection",name:"AutoSelection",component:q},{path:"knowledgeExploration",name:"KnowledgeExploration",component:G}]},{path:"/knowledgeGraph",name:"knowledgeGraph",component:K},{path:"/medicalArchivePreprocess",name:"medicalArchivePreprocess",component:j,meta:{keepAlive:!1}},{path:"/medicalCaseDeepSearch",name:"medicalCaseDeepSearch",component:Z,children:[{path:"",redirect:"Uploadmedicalrecords"},{path:"Uploadmedicalrecords",name:"Uploadmedicalrecords",component:pe},{path:"CaseCluster",name:"CaseCluster",component:ae},{path:"CaseSearch",name:"CaseSearch",component:ie},{path:"SubmitQuestions",name:"SubmitQuestions",component:re}]},{path:"/autoDiagnosis",component:ve,children:[{path:"",redirect:"uploadMedicalRecords"},{path:"uploadMedicalRecords",name:"UploadMedicalRecords",component:we,meta:{keepAlive:!0}},{path:"machineDiagnosis",name:"MachineDiagnosis",component:Ce,meta:{keepAlive:!0}},{path:"submitQuestions",name:"SubmitQuestions",component:Se}]},{path:"/QA",component:Ie,children:[{path:"",redirect:"questions"},{path:"questions",name:"Questions",component:Me,meta:{keepAlive:!0}},{path:"questionDetail/:id",name:"QuestionDetail",component:Le}]},{path:"/consult",name:"consult",component:Be,meta:{keepAlive:!0}},{path:"/my",name:"my",component:Qe,meta:{keepAlive:!0}},{path:"/devPage",name:"devPage",component:ye},{path:"/vqa",component:je,children:[{path:"",redirect:"dataset"},{path:"dataset",name:"dataset",component:et,meta:{keepAlive:!0}},{path:"label",name:"label",component:dt,meta:{keepAlive:!0}},{path:"modelEvaluation",name:"modelVqa",component:st},{path:"report",name:"report",component:lt},{path:"AI",name:"AI",component:Je}]}]}),pt=a("NYxO");s.default.use(pt.a);var ut=new pt.a.Store({state:{user:JSON.parse(sessionStorage.getItem("addsCurrentUserInfo"))||{},token:sessionStorage.getItem("addsCurrentUserToken")||"",sysData:JSON.parse(sessionStorage.getItem("addsSysData"))||{}},mutations:{saveUserInfo(e,t){e.user=t,sessionStorage.setItem("addsCurrentUserInfo",JSON.stringify(t))},saveToken(e,t){e.token=t,sessionStorage.setItem("addsCurrentUserToken",t)},saveSysData(e,t){e.sysData=t,sessionStorage.setItem("addsSysData",JSON.stringify(t))},clearUserInfo(e){e.user={},e.token="",e.sysData={},sessionStorage.removeItem("addsCurrentUserInfo"),sessionStorage.removeItem("addsCurrentUserToken"),sessionStorage.removeItem("addsSysData")}},actions:{saveUserInfo(e,t){e.commit("saveUserInfo",t)},saveToken(e,t){e.commit("saveToken",t)},saveSysData(e,t){e.commit("saveSysData",t)},loadData(e){}}}),mt=a("zL8q"),ht=a.n(mt),gt=(a("tvR6"),a("vO7p")),vt=a.n(gt),ft=a("XLwt"),bt=a.n(ft),yt=this;s.default.prototype.$echarts=bt.a,s.default.prototype.$axios=x.a,x.a.defaults.baseURL="/api",x.a.defaults.timeout=36e4,x.a.interceptors.request.use(e=>{ut.state.token;return e},e=>(console.log("[main.js -> axios] Error! "),Promise.reject(e))),x.a.interceptors.response.use(e=>e,e=>{if(e.response)switch(e.response.status){case 403:yt.$store.commit("clearUserInfo"),ct.replace({path:"/",query:{redirect:ct.currentRoute.fullPath}})}return Promise.reject(e.response.data)}),s.default.config.productionTip=!1,s.default.use(ht.a),s.default.use(vt.a),new s.default({el:"#app",router:ct,store:ut,components:{App:l},template:"<App/>"})},NYdC:function(e,t,a){e.exports=a.p+"static/img/23.9d702b9.png"},PvXa:function(e,t,a){var s={"./1.png":"A1tS","./11.png":"e9gy","./12.png":"SVKk","./13.png":"4utg","./2.png":"chPc","./21.png":"9QGR","./22.png":"yuYf","./23.png":"NYdC","./3.png":"ZK0V","./4.png":"q/uz","./GraphData":"fw/P","./GraphData.js":"fw/P","./adds.jpg":"jNPB","./doctor.png":"QLFm","./favicon.ico":"43FW","./logo.jpg":"4Uwr","./robot.jpg":"xkHn"};function o(e){return a(i(e))}function i(e){var t=s[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}o.keys=function(){return Object.keys(s)},o.resolve=i,e.exports=o,o.id="PvXa"},Q5AK:function(e,t){},QLFm:function(e,t,a){e.exports=a.p+"static/img/doctor.c57775f.png"},SBUn:function(e,t){},SVKk:function(e,t,a){e.exports=a.p+"static/img/12.fb48c2d.png"},TDYV:function(e,t){},TGbX:function(e,t){},"U+bg":function(e,t){},UKlj:function(e,t){},XTzr:function(e,t){},Y7BG:function(e,t){},Yp2s:function(e,t){},ZK0V:function(e,t,a){e.exports=a.p+"static/img/3.15d630d.png"},auiY:function(e,t){},bKI1:function(e,t){},bW9o:function(e,t){},bvRR:function(e,t){},chPc:function(e,t,a){e.exports=a.p+"static/img/2.f2e6b66.png"},d0mQ:function(e,t){},e9gy:function(e,t,a){e.exports=a.p+"static/img/11.8ea68a8.png"},eLQm:function(e,t){},"fw/P":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s={nodes:[{id:"another patient",group:1},{id:"a patient",group:1},{id:"male",group:6},{id:"female",group:6},{id:"Animal_bacterial_diseases",group:4},{id:"Clostridial_infections",group:4},{id:"100001",group:5},{id:"2007/9/11 11:46:00",group:7},{id:"1:29:00",group:7},{id:"100003",group:5},{id:"2010/4/17 15:34:00",group:7},{id:"9:30:00",group:7},{id:"100006",group:5},{id:"2008/4/6 15:49:00",group:7},{id:"4:59:00",group:7},{id:"100007",group:5},{id:"2015/3/31 5:33:00",group:7},{id:"7:07:00",group:7},{id:"Tetanus",group:2},{id:"Mth sus Stph aur els/NOS",group:2},{id:"Sec mal neo brain/spine",group:2},{id:"Second malig neo liver",group:2},{id:"Secondary malig neo bone",group:2},{id:"Listeriosis",group:2},{id:"Heparin",group:3},{id:"5000unit",group:0},{id:"Insulin",group:3},{id:"992",group:0},{id:"1.98%",group:0},{id:"Sodium Chloride 0.9%  Flush",group:3},{id:"3ml",group:0},{id:"Acetaminophen",group:3},{id:"650mg",group:0}],links:[{source:"Animal_bacterial_diseases",target:"Listeriosis",value:1},{source:"1.98%",target:"992",value:1},{source:"Insulin",target:"992",value:1},{source:"Insulin",target:"1.98%",value:1},{source:"Mth sus Stph aur els/NOS",target:"100001",value:1},{source:"Mth sus Stph aur els/NOS",target:"Insulin",value:1},{source:"Mth sus Stph aur els/NOS",target:"Heparin",value:1},{source:"5000unit",target:"Heparin",value:1},{source:"2015/3/31 5:33:00",target:"100007",value:1},{source:"100007",target:"7:07:00",value:1},{source:"100007",target:"Secondary malig neo bone",value:1},{source:"Heparin",target:"Secondary malig neo bone",value:1},{source:"Acetaminophen",target:"Secondary malig neo bone",value:1},{source:"Acetaminophen",target:"650mg",value:1},{source:"4:59:00",target:"100001",value:1},{source:"100003",target:"2010/4/17 15:34:00",value:1},{source:"100003",target:"9:30:00",value:1},{source:"a patient",target:"100001",value:1},{source:"a patient",target:"100003",value:1},{source:"a patient",target:"male",value:1},{source:"2007/9/11 11:46:00",target:"100001",value:1},{source:"100006",target:"another patient",value:1},{source:"100006",target:"Sec mal neo brain/spine",value:1},{source:"100006",target:"Tetanus",value:1},{source:"100006",target:"2008/4/6 15:49:00",value:1},{source:"100006",target:"1:29:00",value:1},{source:"Sec mal neo brain/spine",target:"100003",value:1},{source:"Sec mal neo brain/spine",target:"Heparin",value:1},{source:"Sec mal neo brain/spine",target:"Insulin",value:1},{source:"Sec mal neo brain/spine",target:"Sodium Chloride 0.9%  Flush",value:1},{source:"3ml",target:"Sodium Chloride 0.9%  Flush",value:1},{source:"another patient",target:"female",value:1},{source:"another patient",target:"100007",value:1},{source:"Tetanus",target:"100003",value:1},{source:"Tetanus",target:"Heparin",value:1},{source:"Tetanus",target:"Clostridial_infections",value:1},{source:"Tetanus",target:"Animal_bacterial_diseases",value:1},{source:"Second malig neo liver",target:"100003",value:1},{source:"Second malig neo liver",target:"Heparin",value:1},{source:"Second malig neo liver",target:"Sodium Chloride 0.9%  Flush",value:1}]};t.default={graph:function(){return s}}},fwwP:function(e,t){},jNPB:function(e,t,a){e.exports=a.p+"static/img/adds.310d577.jpg"},o74x:function(e,t){},oDKw:function(e,t){},"q/uz":function(e,t,a){e.exports=a.p+"static/img/4.4fa43f7.png"},sRQ2:function(e,t){},tvR6:function(e,t){},vQDT:function(e,t){},xkHn:function(e,t,a){e.exports=a.p+"static/img/robot.7f42349.jpg"},yuYf:function(e,t,a){e.exports=a.p+"static/img/22.b360581.png"}},["NHnr"]);